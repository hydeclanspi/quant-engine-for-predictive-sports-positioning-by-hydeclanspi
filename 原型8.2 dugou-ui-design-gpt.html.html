<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DUGOU Model Centre v6.1 - UI Prototype (Requested Iterations)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'DM Sans', sans-serif; }
    .font-display { font-family: 'Playfair Display', serif; }
    .glow-card { position: relative; background: white; border-radius: 1rem; transition: all 0.3s ease; }
    .glow-card:hover { box-shadow: 0 0 0 1px rgba(251, 191, 36, 0.3), 0 8px 30px -12px rgba(251, 191, 36, 0.2); }
    .glow-card::after { content: ''; position: absolute; inset: 0; border-radius: 1rem; opacity: 0; transition: opacity 0.3s ease; background: radial-gradient(600px circle at var(--mouse-x, 50%) var(--mouse-y, 50%), rgba(251, 191, 36, 0.06), transparent 40%); pointer-events: none; }
    .glow-card:hover::after { opacity: 1; }
    .lift-card { transition: transform 0.2s ease, box-shadow 0.2s ease; }
    .lift-card:hover { transform: translateY(-2px); box-shadow: 0 8px 30px -12px rgba(0, 0, 0, 0.12); }
    .btn-hover { transition: all 0.2s ease; }
    .btn-hover:hover { transform: scale(1.02); }
    .btn-hover:active { transform: scale(0.98); }
    .sidebar-item { transition: all 0.2s ease; }
    .sidebar-item:hover { transform: translateX(3px); }
    .input-glow:focus { box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.15); }
    input[type="range"] { -webkit-appearance: none; height: 6px; background: #e7e5e4; border-radius: 999px; }
    input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; background: linear-gradient(135deg, #fbbf24, #f97316); border-radius: 50%; cursor: pointer; box-shadow: 0 2px 8px rgba(251, 191, 36, 0.5); transition: transform 0.15s ease; }
    input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.15); }
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #d6d3d1; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #a8a29e; }
    .chart-bar { transition: all 0.2s ease; }
    .chart-bar:hover { transform: scaleY(1.05); filter: brightness(1.1); }
    .modal-overlay { animation: fadeIn 0.2s ease; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .modal-content { animation: slideUp 0.3s ease; }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    .animate-pulse { animation: pulse 2s infinite; }
    .stat-value { font-weight: 600; font-style: italic; }
  
  .line-clamp-1{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;}
</style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect } = React;

    const DugouDesign = () => {
      const [activePage, setActivePage] = useState('new');
      const [activeSubPage, setActiveSubPage] = useState(null);
      const [sidebarCollapsed, setSidebarCollapsed] = useState(false);
      const [modalData, setModalData] = useState(null);
      const [notePopup, setNotePopup] = useState(null);
      const [showDataMenu, setShowDataMenu] = useState(false);

      // Subtle value-color mapping (higher value => deeper tone, with exponential depth)
      const valueColor = (v, hue=210) => {
        const t = Math.max(0, Math.min(1, Number(v) || 0));
        const depth = Math.pow(t, 1.6);
        const light = 76 - depth * 26; // keep 0.8 from being too dark
        return `hsl(${hue}, 70%, ${light}%)`;
      };
      const confStyle = (c) => ({ color: valueColor(c, 210) });
      const ajrStyle = (a) => ({ color: valueColor(a, 145) });

      const openNotePopup = (title, text, evt) => {
        const pad = 16;
        const w = 440;
        const h = 220;
        const x0 = evt?.clientX ?? (window.innerWidth / 2);
        const y0 = evt?.clientY ?? (window.innerHeight / 2);
        const x = Math.max(pad, Math.min(window.innerWidth - w - pad, x0));
        const y = Math.max(pad, Math.min(window.innerHeight - h - pad, y0));
        setNotePopup({ title, text, x, y });
      };

      useEffect(() => {
        const handleMouseMove = (e) => {
          const cards = document.querySelectorAll('.glow-card');
          cards.forEach(card => {
            const rect = card.getBoundingClientRect();
            const x = ((e.clientX - rect.left) / rect.width) * 100;
            const y = ((e.clientY - rect.top) / rect.height) * 100;
            card.style.setProperty('--mouse-x', `${x}%`);
            card.style.setProperty('--mouse-y', `${y}%`);
          });
        };
        window.addEventListener('mousemove', handleMouseMove);
        return () => window.removeEventListener('mousemove', handleMouseMove);
      }, []);

      // Modal Component
      const Modal = ({ data, onClose }) => (
        <div className="modal-overlay fixed inset-0 bg-black/40 flex items-center justify-center z-50" onClick={onClose}>
          <div className="modal-content bg-white rounded-2xl p-6 max-w-3xl w-full mx-4 shadow-2xl max-h-[85vh] overflow-auto" onClick={e => e.stopPropagation()}>
            <div className="flex items-center justify-between mb-4">
              <h3 className="font-semibold text-stone-800">{data.title}</h3>
              <button onClick={onClose} className="text-stone-400 hover:text-stone-600 text-xl leading-none">Ã—</button>
            </div>
            {data.content}
          </div>
        </div>
      );

      // Floating Note Popup (for long pre/post notes in tables)
      const NotePopup = ({ data, onClose }) => (
        <div className="fixed inset-0 z-50" onClick={onClose}>
          <div
            className="absolute bg-white rounded-2xl border border-stone-200 shadow-2xl p-4 w-[440px] max-w-[92vw]"
            style={{ left: data.x, top: data.y }}
            onClick={(e) => e.stopPropagation()}
          >
            <div className="flex items-start justify-between gap-4 mb-2">
              <div className="font-medium text-stone-800 text-sm">{data.title}</div>
              <button onClick={onClose} className="text-stone-400 hover:text-stone-600 text-lg leading-none">Ã—</button>
            </div>
            <div className="text-sm text-stone-600 leading-relaxed whitespace-pre-wrap">
              {data.text || '-'}
            </div>
          </div>
        </div>
      );

      // Sidebar with nested items
      const Sidebar = () => (
        <div className={`h-screen bg-gradient-to-b from-stone-50 to-orange-50/30 border-r border-stone-200/60 flex flex-col transition-all duration-300 ${sidebarCollapsed ? 'w-16' : 'w-56'}`}>
          <div className="p-4 border-b border-stone-200/40">
            <div className="flex items-center gap-3">
              <div className="w-9 h-9 rounded-xl bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center shadow-lg shadow-orange-200/50 btn-hover cursor-pointer">
                <span className="text-white font-bold text-sm">DG</span>
              </div>
              {!sidebarCollapsed && (
                <div>
                  <h1 className="font-semibold text-stone-800 text-sm tracking-tight">DUGOU</h1>
                  <p className="text-[10px] text-stone-400">Model Centre v5.8</p>
                </div>
              )}
            </div>
          </div>

          <nav className="flex-1 p-3 space-y-1">
            {[
              { id: 'new', icon: 'â—ˆ', label: 'æ–°å»ºæŠ•èµ„', badge: null },
              { id: 'combo', icon: 'â–', label: 'æ™ºèƒ½ç»„åˆ', badge: null },
              { id: 'settle', icon: 'â—‰', label: 'å¾…ç»“ç®—', badge: '3', highlight: true },
              { id: 'dashboard', icon: 'â—', label: 'Dashboard', badge: null, children: [
                { id: 'analysis', icon: 'â—‡', label: 'æ·±åº¦åˆ†æ' },
                { id: 'metrics', icon: 'â—‘', label: 'æ•°æ®æ€»è§ˆ' }
              ]},
              { id: 'history', icon: 'â˜°', label: 'å†å²è®°å½•', badge: '93', children: [
                { id: 'teams', icon: 'âš‘', label: 'çƒé˜Ÿæ¡£æ¡ˆé¦†' }
              ]},
              { id: 'params', icon: 'âš™', label: 'å‚æ•°åå°', badge: null },
            ].map(item => (
              <div key={item.id}>
                <button
                  onClick={() => { setActivePage(item.id); setActiveSubPage(null); }}
                  className={`sidebar-item w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm transition-all duration-200 group
                    ${activePage === item.id && !activeSubPage ? 'bg-white shadow-sm shadow-stone-200/50 text-stone-800' : 'text-stone-500 hover:bg-white/60 hover:text-stone-700'}`}
                >
                  <span className={`text-base transition-colors ${activePage === item.id && !activeSubPage ? 'text-amber-500' : 'text-stone-400 group-hover:text-stone-500'}`}>{item.icon}</span>
                  {!sidebarCollapsed && (
                    <>
                      <span className="flex-1 text-left">{item.label}</span>
                      {item.badge && <span className={`text-xs ${item.highlight ? 'px-2 py-0.5 rounded-full bg-amber-100 text-amber-600 font-medium' : 'text-stone-400'}`}>{item.badge}</span>}
                    </>
                  )}
                </button>
                {item.children && !sidebarCollapsed && (
                  <div className="ml-6 mt-1 space-y-1">
                    {item.children.map(child => (
                      <button key={child.id} onClick={() => { setActivePage(item.id); setActiveSubPage(child.id); }}
                        className={`sidebar-item w-full flex items-center gap-2 px-3 py-2 rounded-lg text-xs transition-all duration-200 ${activeSubPage === child.id ? 'bg-amber-50 text-amber-700' : 'text-stone-400 hover:bg-white/60 hover:text-stone-600'}`}>
                        <span className="text-sm">{child.icon}</span>
                        <span>{child.label}</span>
                      </button>
                    ))}
                  </div>
                )}
              </div>
            ))}
          </nav>

          <div className="p-3 border-t border-stone-200/40 space-y-1">
            {!sidebarCollapsed && (
              <div className="relative">
                <button onClick={() => setShowDataMenu(!showDataMenu)} className="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 hover:text-stone-700 hover:bg-white/60 transition-all text-sm">
                  <span className="text-stone-400">â‡„</span><span>æ•°æ®ç®¡ç†</span><span className="ml-auto text-xs">{showDataMenu ? 'â–²' : 'â–¼'}</span>
                </button>
                {showDataMenu && (
                  <div className="mt-1 space-y-1">
                    <button className="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 hover:text-amber-600 hover:bg-amber-50 transition-all text-xs"><span>â†“</span> å¯¼å…¥ Excel</button>
                    <button className="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 hover:text-amber-600 hover:bg-amber-50 transition-all text-xs"><span>â†‘</span> å¯¼å‡ºå¤‡ä»½</button>
                  </div>
                )}
              </div>
            )}
            <button onClick={() => setSidebarCollapsed(!sidebarCollapsed)} className="w-full flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-stone-400 hover:text-stone-600 hover:bg-white/60 transition-all text-xs">
              {sidebarCollapsed ? 'â†’' : 'â† æ”¶èµ·'}
            </button>
          </div>
        </div>
      );

      // Dashboard with sub-tabs
      const DashboardPage = () => {
  const [timePeriod, setTimePeriod] = useState('2W');
  const [showTimePicker, setShowTimePicker] = useState(false);

  const periodLabels = {
    '2W': { label: 'è¿‘ä¸¤å‘¨', investments: 12, yoy: '+2.1%' },
    '1M': { label: 'æœ¬æœˆ', investments: 23, yoy: '+1.4%' },
    '3M': { label: 'è¿‘ä¸‰æœˆ', investments: 68, yoy: '+0.8%' },
    '1Y': { label: 'æœ¬å¹´åº¦', investments: 93, yoy: '+3.6%' },
  };

  const openMetricDetail = (type) => {
    const contents = {
      balance: {
        title: 'è“„æ°´æ± ä½™é¢ Â· å†å²æ˜ç»†',
        content: (
          <table className="w-full text-sm">
            <thead><tr className="border-b border-stone-200 text-left text-stone-500">
              <th className="py-2 font-medium">æ—¥æœŸ</th><th className="py-2 font-medium">æ¯”èµ›</th><th className="py-2 font-medium">æ“ä½œå‰</th><th className="py-2 font-medium">ç›ˆäº</th><th className="py-2 font-medium">æ“ä½œå</th>
            </tr></thead>
            <tbody>
              {[
                { date: '02-02', match: 'é˜¿æ£®çº³ vs åˆ‡å°”è¥¿', before: '2,667', change: '-', after: '2,667' },
                { date: '02-01', match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', before: '2,447', change: '+220', after: '2,667' },
                { date: '01-31', match: 'çƒ­åˆº vs æ›¼è”', before: '2,567', change: '-120', after: '2,447' },
              ].map((r,i)=>(
                <tr key={i} className="border-b border-stone-100">
                  <td className="py-2">{r.date}</td>
                  <td className="py-2">{r.match}</td>
                  <td className="py-2">{r.before} rmb</td>
                  <td className={`py-2 font-medium ${String(r.change).startsWith('+') ? 'text-emerald-600' : 'text-stone-500'}`}>{r.change === '-' ? '-' : `${r.change} rmb`}</td>
                  <td className="py-2 font-medium">{r.after} rmb</td>
                </tr>
              ))}
            </tbody>
          </table>
        )
      },
      roi: {
        title: 'ROI Â· è¯¦æƒ…',
        content: (
          <table className="w-full text-sm">
            <thead><tr className="border-b border-stone-200 text-left text-stone-500">
              <th className="py-2 font-medium">åŒºé—´</th><th className="py-2 font-medium">æŠ•å…¥</th><th className="py-2 font-medium">å›æ”¶</th><th className="py-2 font-medium">ROI</th>
            </tr></thead>
            <tbody>
              {[
                { range: 'è¿‘ä¸¤å‘¨', inpt: 1120, out: 1290, roi: 0.152 },
                { range: 'è¿‘å››å‘¨', inpt: 1920, out: 2030, roi: 0.057 },
                { range: 'è¿‘ä¸‰æœˆ', inpt: 4880, out: 5120, roi: 0.049 },
              ].map((r,i)=>(
                <tr key={i} className="border-b border-stone-100">
                  <td className="py-2">{r.range}</td>
                  <td className="py-2">{r.inpt} rmb</td>
                  <td className="py-2">{r.out} rmb</td>
                  <td className={`py-2 font-medium ${r.roi >= 0 ? 'text-emerald-600' : 'text-rose-500'}`}>{(r.roi*100).toFixed(1)}%</td>
                </tr>
              ))}
            </tbody>
          </table>
        )
      },
      hitrate: {
        title: 'å‘½ä¸­ç‡ Â· è¯¦æƒ…',
        content: (
          <table className="w-full text-sm">
            <thead><tr className="border-b border-stone-200 text-left text-stone-500">
              <th className="py-2 font-medium">æ—¥æœŸ</th><th className="py-2 font-medium">æ¯”èµ›</th><th className="py-2 font-medium">ç»“æœ</th><th className="py-2 font-medium">Conf</th><th className="py-2 font-medium">æŠ•å…¥</th>
            </tr></thead>
            <tbody>
              {[
                { date: '02-01', match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', r: 'å·²ä¸­', conf: 0.72, inpt: 200 },
                { date: '01-31', match: 'çƒ­åˆº vs æ›¼è”', r: 'æœªä¸­', conf: 0.42, inpt: 120 },
                { date: '01-30', match: 'çº½å¡ vs ç»´æ‹‰', r: 'å·²ä¸­', conf: 0.55, inpt: 150 },
              ].map((r,i)=>(
                <tr key={i} className="border-b border-stone-100">
                  <td className="py-2">{r.date}</td>
                  <td className="py-2">{r.match}</td>
                  <td className={`py-2 font-medium ${r.r === 'å·²ä¸­' ? 'text-emerald-600' : 'text-rose-500'}`}>{r.r}</td>
                  <td className="py-2" style={confStyle(r.conf)}>{r.conf.toFixed(2)}</td>
                  <td className="py-2">{r.inpt} rmb</td>
                </tr>
              ))}
            </tbody>
          </table>
        )
      },
      rating: {
        title: 'Conf vs AJR Â· æ˜ç»†',
        content: (
          <table className="w-full text-sm">
            <thead><tr className="border-b border-stone-200 text-left text-stone-500">
              <th className="py-2 font-medium">æ—¥æœŸ</th><th className="py-2 font-medium">æ¯”èµ›</th><th className="py-2 font-medium">Conf</th><th className="py-2 font-medium">AJR</th><th className="py-2 font-medium">å·®å€¼</th>
            </tr></thead>
            <tbody>
              {[
                { date: '02-01', match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', conf: 0.72, ajr: 0.75 },
                { date: '01-31', match: 'çƒ­åˆº vs æ›¼è”', conf: 0.42, ajr: 0.38 },
                { date: '01-30', match: 'çº½å¡ vs ç»´æ‹‰', conf: 0.55, ajr: 0.62 },
              ].map((r,i)=>(
                <tr key={i} className="border-b border-stone-100">
                  <td className="py-2">{r.date}</td>
                  <td className="py-2">{r.match}</td>
                  <td className="py-2 font-medium" style={confStyle(r.conf)}>{r.conf.toFixed(2)}</td>
                  <td className="py-2 font-medium" style={ajrStyle(r.ajr)}>{r.ajr.toFixed(2)}</td>
                  <td className="py-2 text-stone-600">{(r.ajr - r.conf).toFixed(2)}</td>
                </tr>
              ))}
            </tbody>
          </table>
        )
      },
      noise: {
        title: 'REP (å™ªéŸ³è¿‡æ»¤) Â· è¯´æ˜',
        content: (
          <div className="text-sm text-stone-700 leading-relaxed space-y-3">
            <p><span className="font-medium">REPï¼ˆRandom Events Parameterï¼‰</span>ç”¨äºä¼°è®¡â€œéšæœºäº‹ä»¶/å¶ç„¶æ€§â€å¯¹å•åœºç»“æœçš„æ‰°åŠ¨å¼ºåº¦ã€‚å®ƒæ˜¯ç”¨äºé£é™©è°ƒæ•´ä¸ç¨³å¥æ€§çš„æŠ€æœ¯å‚æ•°ã€‚</p>
            <ul className="list-disc pl-5 space-y-1 text-stone-600">
              <li>ç»„åˆä¼˜åŒ–æ—¶ï¼šREP è¶Šé«˜çš„æ¯”èµ›ä¼šè¢«é™ä½æƒé‡ï¼Œä»¥å‡å°‘å°¾éƒ¨é£é™©ã€‚</li>
              <li>ç»Ÿè®¡å½’å› æ—¶ï¼šREP ç”¨äºæŠŠâ€œè¿æ°”/å™ªéŸ³â€ä»åˆ¤æ–­è´¨é‡ä¸­åˆ†ç¦»å‡ºæ¥ã€‚</li>
              <li>åŠ¨æ€æ ¡å‡†æ—¶ï¼šREP ä¼šå½±å“ Confâ†’AJR æ˜ å°„æ–œç‡ï¼ˆé«˜ REP åŒºé—´æ›´ä¿å®ˆï¼‰ã€‚</li>
            </ul>
            <p className="text-stone-500">ç›´è§‚ç†è§£ï¼šREP = â€œéšæœºæ€§å¼ºåº¦â€çš„é‡åŒ–åˆ»åº¦ã€‚</p>
          </div>
        )
      },
      conf: {
        title: 'Conf æ ¡å‡†æ›²çº¿ Â· è¯´æ˜',
        content: (
          <div className="text-sm text-stone-700 leading-relaxed space-y-3">
            <p>Conf æ ¡å‡†æ›²çº¿å¯¹æ¯” <span className="font-medium">ä½ ä¸»è§‚ç»™å‡ºçš„ Conf</span> ä¸ <span className="font-medium">èµ›å AJR</span> çš„ä¸€è‡´æ€§ï¼Œåæ˜ ä½ åˆ¤æ–­çš„â€œæ ¡å‡†ç¨‹åº¦â€ã€‚</p>
            <p className="text-stone-500">Dashboard å±•ç¤º Conf vs AJRï¼›è€Œâ€œExpected vs Actual Judgmental Ratingï¼ˆæ¨¡å‹æ‹Ÿåˆï¼‰â€å·²ç§»åŠ¨åˆ°å‚æ•°åå°ã€‚</p>
          </div>
        )
      },
      recent: {
        title: 'è¿‘æœŸæŠ•èµ„ Â· æ˜ç»†',
        content: (
          <table className="w-full text-sm">
            <thead><tr className="border-b border-stone-200 text-left text-stone-500">
              <th className="py-2 font-medium">æ—¥æœŸ</th><th className="py-2 font-medium">ç±»å‹</th><th className="py-2 font-medium">æ¯”èµ›æ•°</th><th className="py-2 font-medium">æŠ•å…¥</th><th className="py-2 font-medium">å¤‡æ³¨</th>
            </tr></thead>
            <tbody>
              {[
                { date: '02-02', type: '2 Matches Combo', m: 2, inpt: 300, note: 'åç¨³å¥' },
                { date: '02-01', type: 'Single Match', m: 1, inpt: 200, note: 'é«˜ä¿¡å¿ƒ' },
                { date: '01-31', type: 'Single Match', m: 1, inpt: 120, note: 'è¯•æ¢æ€§' },
              ].map((r,i)=>(
                <tr key={i} className="border-b border-stone-100">
                  <td className="py-2">{r.date}</td>
                  <td className="py-2">{r.type}</td>
                  <td className="py-2">{r.m}</td>
                  <td className="py-2">{r.inpt} rmb</td>
                  <td className="py-2 text-stone-500">{r.note}</td>
                </tr>
              ))}
            </tbody>
          </table>
        )
      },
    };
    setModalData(contents[type]);
  };

  const totalInvest = periodLabels[timePeriod].investments;
  const totalMatches = 18;

  return (
    <div className="p-8 max-w-6xl">
      <div className="mb-6">
        <div className="flex items-center justify-between">
          <div>
            <h2 className="text-2xl font-semibold text-stone-800 font-display">Dashboard</h2>
            <div className="flex items-center gap-2 mt-1">
              <div className="relative">
                <button onClick={() => setShowTimePicker(!showTimePicker)} className="text-stone-500 text-sm hover:text-amber-600 flex items-center gap-1">
                  {periodLabels[timePeriod].label} <span className="text-xs">â–¼</span>
                </button>
                {showTimePicker && (
                  <div className="absolute top-full left-0 mt-1 bg-white rounded-lg shadow-lg border border-stone-200 py-1 z-50">
                    {Object.entries(periodLabels).map(([key, val]) => (
                      <button key={key} onClick={() => { setTimePeriod(key); setShowTimePicker(false); }}
                        className={`block w-full px-4 py-1.5 text-left text-sm ${timePeriod === key ? 'bg-amber-50 text-amber-700' : 'text-stone-600 hover:bg-stone-50'}`}>
                        {val.label}
                      </button>
                    ))}
                  </div>
                )}
              </div>
              <span className="text-stone-300">Â·</span>
              <span className="text-sm text-stone-400">{totalInvest} ä»½æŠ•èµ„ / {totalMatches} åœºæ¯”èµ›</span>
            </div>
          </div>

          <button onClick={() => setActiveSubPage('metrics')} className="px-4 py-2 rounded-xl border border-stone-200 text-sm text-stone-600 hover:bg-stone-50 btn-hover">
            æ‰“å¼€ æ•°æ®æ€»è§ˆ
          </button>
        </div>
      </div>

      {/* Top Row */}
      <div className="grid grid-cols-4 gap-4 mb-4">
        <div onClick={() => openMetricDetail('balance')} className="glow-card bg-white rounded-2xl border border-stone-100 p-5 cursor-pointer lift-card">
          <div className="relative z-10">
            <div className="flex items-center justify-between">
              <span className="text-xs text-stone-500">è“„æ°´æ± ä½™é¢</span>
              <span className="text-amber-400">â—ˆ</span>
            </div>
            <div className="text-xl font-semibold text-stone-800 mt-2">2,667 rmb</div>
            <div className="text-xs text-stone-400 mt-1">vs ä¸ŠæœŸ <span className="text-emerald-600">+220 rmb</span></div>
          </div>
        </div>

        <div onClick={() => openMetricDetail('roi')} className="glow-card bg-white rounded-2xl border border-stone-100 p-5 cursor-pointer lift-card">
          <div className="relative z-10">
            <div className="flex items-center justify-between">
              <span className="text-xs text-stone-500">ROI</span>
              <span className="text-amber-400">â–</span>
            </div>
            <div className="text-xl font-semibold text-stone-800 mt-2">+15.2%</div>
            <div className="text-xs text-stone-400 mt-1">vs ä¸ŠæœŸ <span className="text-emerald-600">+5.7%</span></div>
          </div>
        </div>

        <div onClick={() => openMetricDetail('hitrate')} className="glow-card bg-white rounded-2xl border border-stone-100 p-5 cursor-pointer lift-card">
          <div className="relative z-10">
            <div className="flex items-center justify-between">
              <span className="text-xs text-stone-500">å‘½ä¸­ç‡</span>
              <span className="text-amber-400">â—‰</span>
            </div>
            <div className="text-xl font-semibold text-stone-800 mt-2">67.3%</div>
            <div className="text-xs text-stone-400 mt-1">vs ä¸ŠæœŸ <span className="text-emerald-600">{periodLabels[timePeriod].yoy}</span></div>
          </div>
        </div>

        <div onClick={() => openMetricDetail('rating')} className="glow-card bg-white rounded-2xl border border-stone-100 p-5 cursor-pointer lift-card">
          <div className="relative z-10">
            <div className="flex items-center justify-between">
              <span className="text-xs text-stone-500">Conf vs AJR</span>
              <span className="text-amber-400">â—</span>
            </div>
            <div className="text-xl font-semibold text-stone-800 mt-2">0.71</div>
            <div className="text-xs text-stone-400 mt-1">ç›¸å…³ç³»æ•°ï¼ˆæ ¡å‡†ï¼‰</div>
          </div>
        </div>
      </div>

      {/* Second Row */}
      <div className="grid grid-cols-3 gap-4 mb-4">
        <div onClick={() => openMetricDetail('noise')} className="glow-card bg-white rounded-2xl border border-stone-100 p-5 cursor-pointer lift-card">
          <div className="relative z-10">
            <div className="flex items-center justify-between mb-2">
              <div>
                <div className="text-sm font-medium text-stone-800">REP (å™ªéŸ³è¿‡æ»¤)</div>
                <div className="text-xs text-stone-400">Random Events Parameter</div>
              </div>
              <span className="text-amber-400">â—</span>
            </div>

            <div className="grid grid-cols-3 gap-2 mb-3">
              <div className="p-2 rounded-xl bg-emerald-50/70 border border-emerald-100">
                <div className="text-xs text-stone-500">ä½å™ªéŸ³</div>
                <div className="text-sm font-semibold text-emerald-700">7</div>
              </div>
              <div className="p-2 rounded-xl bg-stone-50 border border-stone-100">
                <div className="text-xs text-stone-500">ä¸­ç­‰</div>
                <div className="text-sm font-semibold text-stone-700">9</div>
              </div>
              <div className="p-2 rounded-xl bg-rose-50/70 border border-rose-100">
                <div className="text-xs text-stone-500">é«˜å™ªéŸ³</div>
                <div className="text-sm font-semibold text-rose-600">2</div>
              </div>
            </div>

            <div className="text-xs text-stone-500 leading-relaxed">
              é€šè¿‡ REP å¯¹â€œéšæœºäº‹ä»¶æ‰°åŠ¨â€åšåŠ æƒï¼šé™ä½é«˜å™ªéŸ³æ¯”èµ›åœ¨ç»„åˆä¸­çš„æƒé‡ï¼Œå¹¶ç”¨äºæŠŠè¿æ°”å› ç´ ä» AJR æ ¡å‡†ä¸­å‰¥ç¦»ã€‚
            </div>
          </div>
        </div>

        <div onClick={() => openMetricDetail('recent')} className="glow-card bg-white rounded-2xl border border-stone-100 p-5 cursor-pointer lift-card">
          <div className="relative z-10">
            <div className="flex items-center justify-between mb-2">
              <div>
                <div className="text-sm font-medium text-stone-800">è¿‘æœŸæŠ•èµ„</div>
                <div className="text-xs text-stone-400">æœ€è¿‘ 7 å¤©</div>
              </div>
              <span className="text-amber-400">â˜°</span>
            </div>
            <div className="space-y-2 text-xs">
              {[
                { t: '2 Matches Combo', inpt: 300, d: '02-02' },
                { t: 'Single Match', inpt: 200, d: '02-01' },
                { t: 'Single Match', inpt: 120, d: '01-31' },
              ].map((r,i)=>(
                <div key={i} className="flex items-center justify-between p-2 rounded-xl bg-stone-50 border border-stone-100">
                  <span className="text-stone-600">{r.d} Â· {r.t}</span>
                  <span className="font-medium text-stone-800">{r.inpt} rmb</span>
                </div>
              ))}
            </div>
          </div>
        </div>

        <div onClick={() => openMetricDetail('conf')} className="glow-card bg-white rounded-2xl border border-stone-100 p-5 cursor-pointer lift-card">
          <div className="relative z-10">
            <div className="flex items-center justify-between mb-2">
              <div>
                <div className="text-sm font-medium text-stone-800">Conf æ ¡å‡†æ›²çº¿</div>
                <div className="text-xs text-stone-400">conf. ä¸»è§‚ç½®ä¿¡åº¦ â†” AJR</div>
              </div>
              <span className="text-amber-400">â—‡</span>
            </div>

            <div className="h-28 flex items-center">
              <svg viewBox="0 0 120 60" className="w-full h-full">
                <line x1="10" y1="50" x2="110" y2="10" stroke="#e7e5e4" strokeWidth="2" />
                <polyline fill="none" stroke="#f59e0b" strokeWidth="2" points="10,48 30,42 50,35 70,26 90,18 110,14" />
                <circle cx="90" cy="18" r="2.5" fill="#f59e0b" />
                <text x="10" y="58" fontSize="6" fill="#a8a29e">low</text>
                <text x="102" y="12" fontSize="6" fill="#a8a29e">high</text>
              </svg>
            </div>

            <div className="text-xs text-stone-500">æ•´ä½“ç•¥ä¿å®ˆï¼ˆé«˜ Conf åŒºé—´æ›´æ¥è¿‘å¯¹è§’çº¿ï¼‰</div>
          </div>
        </div>
      </div>

      {/* Third Row: funds line chart */}
      <div className="grid grid-cols-3 gap-4">
        <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6 col-span-2">
          <div className="relative z-10">
            <div className="flex items-center justify-between mb-3">
              <h3 className="font-medium text-stone-700">èµ„é‡‘èµ°åŠ¿</h3>
              <span className="text-xs text-stone-400">{periodLabels[timePeriod].label}</span>
            </div>
            <div className="h-36 flex items-center">
              <svg viewBox="0 0 300 120" className="w-full h-full">
                <polyline fill="none" stroke="#f59e0b" strokeWidth="3" points="5,95 25,88 45,92 65,78 85,82 105,68 125,74 145,60 165,66 185,52 205,58 225,44 245,50 265,38 285,42" />
                <line x1="0" y1="100" x2="300" y2="100" stroke="#e7e5e4" strokeWidth="2" />
              </svg>
            </div>
            <div className="text-xs text-stone-400 mt-2">çº¿å›¾ç”¨äºæ›´ç¨³å®šåœ°è§‚å¯Ÿè¶‹åŠ¿ï¼›ç»†èŠ‚å¯åœ¨ â€œæ•°æ®æ€»è§ˆâ€ æŸ¥çœ‹ã€‚</div>
          </div>
        </div>

        <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
          <div className="relative z-10">
            <h3 className="font-medium text-stone-700 mb-3">Exposure / Inputs</h3>
            <div className="space-y-3">
              {[
                { k: 'Single Match', v: 520 },
                { k: '2 Matches Combo', v: 300 },
                { k: '3+ Matches', v: 180 },
              ].map((r,i)=>(
                <div key={i} className="flex items-center justify-between p-3 rounded-xl bg-stone-50 border border-stone-100">
                  <span className="text-xs text-stone-500">{r.k}</span>
                  <span className="text-sm font-semibold text-stone-800">{r.v} rmb</span>
                </div>
              ))}
            </div>
            <button onClick={() => setActiveSubPage('metrics')} className="mt-4 w-full py-2.5 rounded-xl border border-stone-200 text-sm text-stone-600 hover:bg-stone-50 btn-hover">
              æ‰“å¼€æ›´å¤šæŒ‡æ ‡
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};// Dashboard - Metrics sub page (high density tables)
const MetricsPage = () => {
  const metrics = {
    roiByMode: [
      { mode: 'å¸¸è§„', samples: 42, roi: 0.128, sharpe: 1.41, kDen: 4 },
      { mode: 'å¸¸è§„-ç¨³', samples: 18, roi: 0.082, sharpe: 1.08, kDen: 5 },
      { mode: 'å¸¸è§„-æ æ†', samples: 11, roi: -0.034, sharpe: 0.62, kDen: 6 },
      { mode: 'ä¿é™©äº§å“', samples: 9, roi: 0.041, sharpe: 0.89, kDen: 8 },
      { mode: 'èµŒä¸€æŠŠ', samples: 6, roi: -0.12, sharpe: 0.35, kDen: 12 },
    ],
    inputsByMode: [
      { mode: 'å¸¸è§„', inputs: 1600, avg: 38 },
      { mode: 'å¸¸è§„-ç¨³', inputs: 720, avg: 40 },
      { mode: 'å¸¸è§„-æ æ†', inputs: 540, avg: 49 },
      { mode: 'ä¿é™©äº§å“', inputs: 420, avg: 47 },
      { mode: 'èµŒä¸€æŠŠ', inputs: 260, avg: 43 },
    ],
    confBuckets: [
      { bucket: '0.00â€“0.20', samples: 7, hit: 2, roi: -0.18 },
      { bucket: '0.20â€“0.40', samples: 19, hit: 9, roi: -0.03 },
      { bucket: '0.40â€“0.60', samples: 28, hit: 18, roi: 0.06 },
      { bucket: '0.60â€“0.80', samples: 31, hit: 23, roi: 0.13 },
      { bucket: '0.80â€“1.00', samples: 8, hit: 7, roi: 0.21 },
    ],
    correlations: [
      { a: 'Conf', b: 'AJR', r: 0.71 },
      { a: 'Conf', b: 'ROI', r: 0.22 },
      { a: 'REP', b: 'ROI', r: -0.18 },
      { a: 'Odds', b: 'ROI', r: -0.09 },
    ],
  };

  const open = (title, content) => setModalData({ title, content });

  return (
    <div className="p-8 max-w-6xl">
      <div className="flex items-start justify-between mb-6">
        <div>
          <h2 className="text-2xl font-semibold text-stone-800 font-display">Dashboard Â· æ•°æ®æ€»è§ˆ</h2>
          <p className="text-stone-400 text-sm mt-1">ROI / Inputs / Conf buckets / ç›¸å…³æ€§ï¼ˆä¿¡æ¯å¯†åº¦æ›´é«˜çš„ä¸€è§ˆè¡¨ï¼‰</p>
        </div>
        <button onClick={() => { setActivePage('dashboard'); setActiveSubPage(null); }} className="px-4 py-2 rounded-xl border border-stone-200 text-sm text-stone-600 hover:bg-stone-50 btn-hover">
          è¿”å› Dashboard
        </button>
      </div>

      <div className="grid grid-cols-3 gap-4 mb-6">
        <div onClick={() => open('ROI by Mode Â· è¯¦æƒ…', (
          <table className="w-full text-sm">
            <thead><tr className="border-b border-stone-200 text-left text-stone-500">
              <th className="py-2 font-medium">Mode</th><th className="py-2 font-medium">Samples</th><th className="py-2 font-medium">ROI</th><th className="py-2 font-medium">Sharpe</th><th className="py-2 font-medium">Kelly åˆ†æ¯</th>
            </tr></thead>
            <tbody>
              {metrics.roiByMode.map((r,i)=>(
                <tr key={i} className="border-b border-stone-100">
                  <td className="py-2">{r.mode}</td>
                  <td className="py-2">{r.samples}</td>
                  <td className={`py-2 font-medium ${r.roi>=0?'text-emerald-600':'text-rose-500'}`}>{(r.roi*100).toFixed(1)}%</td>
                  <td className="py-2">{r.sharpe.toFixed(2)}</td>
                  <td className="py-2">{r.kDen}</td>
                </tr>
              ))}
            </tbody>
          </table>
        ))} className="glow-card bg-white rounded-2xl border border-stone-100 p-5 cursor-pointer lift-card">
          <div className="relative z-10">
            <div className="text-xs text-stone-400 mb-1">ROI of different modes</div>
            <div className="text-sm font-medium text-stone-800">ROI by Mode</div>
            <div className="mt-3 space-y-2">
              {metrics.roiByMode.slice(0,4).map((r,i)=>(
                <div key={i} className="flex items-center justify-between text-xs">
                  <span className="text-stone-500">{r.mode}</span>
                  <span className="font-medium text-stone-800">{(r.roi*100).toFixed(1)}%</span>
                </div>
              ))}
            </div>
          </div>
        </div>

        <div onClick={() => open('Inputs by Mode Â· è¯¦æƒ…', (
          <table className="w-full text-sm">
            <thead><tr className="border-b border-stone-200 text-left text-stone-500">
              <th className="py-2 font-medium">Mode</th><th className="py-2 font-medium">Total Inputs</th><th className="py-2 font-medium">Avg/entry</th>
            </tr></thead>
            <tbody>
              {metrics.inputsByMode.map((r,i)=>(
                <tr key={i} className="border-b border-stone-100">
                  <td className="py-2">{r.mode}</td>
                  <td className="py-2 font-medium">{r.inputs} rmb</td>
                  <td className="py-2">{r.avg} rmb</td>
                </tr>
              ))}
            </tbody>
          </table>
        ))} className="glow-card bg-white rounded-2xl border border-stone-100 p-5 cursor-pointer lift-card">
          <div className="relative z-10">
            <div className="text-xs text-stone-400 mb-1">total input of each mode</div>
            <div className="text-sm font-medium text-stone-800">Inputs by Mode</div>
            <div className="mt-3 space-y-2 text-xs">
              {metrics.inputsByMode.map((r,i)=>(
                <div key={i} className="flex items-center justify-between">
                  <span className="text-stone-500">{r.mode}</span>
                  <span className="font-medium text-stone-800">{r.inputs}</span>
                </div>
              ))}
            </div>
          </div>
        </div>

        <div onClick={() => open('Correlations Â· è¯¦æƒ…', (
          <table className="w-full text-sm">
            <thead><tr className="border-b border-stone-200 text-left text-stone-500">
              <th className="py-2 font-medium">A</th><th className="py-2 font-medium">B</th><th className="py-2 font-medium">r</th>
            </tr></thead>
            <tbody>
              {metrics.correlations.map((r,i)=>(
                <tr key={i} className="border-b border-stone-100">
                  <td className="py-2">{r.a}</td><td className="py-2">{r.b}</td><td className="py-2 font-medium">{r.r.toFixed(2)}</td>
                </tr>
              ))}
            </tbody>
          </table>
        ))} className="glow-card bg-white rounded-2xl border border-stone-100 p-5 cursor-pointer lift-card">
          <div className="relative z-10">
            <div className="text-xs text-stone-400 mb-1">correlations / coefficients</div>
            <div className="text-sm font-medium text-stone-800">Correlations</div>
            <div className="mt-3 space-y-2 text-xs">
              {metrics.correlations.map((r,i)=>(
                <div key={i} className="flex items-center justify-between">
                  <span className="text-stone-500">{r.a} â†” {r.b}</span>
                  <span className="font-medium text-stone-800">{r.r.toFixed(2)}</span>
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>

      <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
        <div className="relative z-10">
          <div className="flex items-center justify-between mb-4">
            <h3 className="font-medium text-stone-700">Conf buckets</h3>
            <button onClick={() => open('Conf buckets Â· è¯¦æƒ…', (
              <table className="w-full text-sm">
                <thead><tr className="border-b border-stone-200 text-left text-stone-500">
                  <th className="py-2 font-medium">Bucket</th><th className="py-2 font-medium">Samples</th><th className="py-2 font-medium">Hit</th><th className="py-2 font-medium">ROI</th>
                </tr></thead>
                <tbody>
                  {metrics.confBuckets.map((r,i)=>(
                    <tr key={i} className="border-b border-stone-100">
                      <td className="py-2">{r.bucket}</td>
                      <td className="py-2">{r.samples}</td>
                      <td className="py-2">{r.hit}/{r.samples}</td>
                      <td className={`py-2 font-medium ${r.roi>=0?'text-emerald-600':'text-rose-500'}`}>{(r.roi*100).toFixed(1)}%</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            ))} className="text-xs text-amber-600 hover:text-amber-700">å±•å¼€è¯¦æƒ…</button>
          </div>

          <table className="w-full text-sm">
            <thead><tr className="border-b border-stone-200 text-left text-stone-500">
              <th className="py-2 font-medium">Bucket</th><th className="py-2 font-medium">Samples</th><th className="py-2 font-medium">Hit</th><th className="py-2 font-medium">ROI</th>
            </tr></thead>
            <tbody>
              {metrics.confBuckets.map((r,i)=>(
                <tr key={i} className="border-b border-stone-100">
                  <td className="py-2">{r.bucket}</td>
                  <td className="py-2">{r.samples}</td>
                  <td className="py-2">{r.hit}/{r.samples}</td>
                  <td className={`py-2 font-medium ${r.roi>=0?'text-emerald-600':'text-rose-500'}`}>{(r.roi*100).toFixed(1)}%</td>
                </tr>
              ))}
            </tbody>
          </table>

          <p className="text-xs text-stone-400 mt-4">æç¤ºï¼šConf bucket çš„ ROI åªæ˜¯â€œåŸºç¡€ç‰ˆç»Ÿè®¡â€ï¼Œæ›´ç»†èŠ‚çš„ç¨³å¥æ€§éœ€è¦ç»“åˆ REP ä¸èµ”ç‡åŒºé—´åˆ†å±‚ã€‚</p>
        </div>
      </div>
    </div>
  );
};

      // Deep Analysis Page
      const AnalysisPage = () => {
        const [analysisTab, setAnalysisTab] = useState('parlay');
        
        return (
          <div className="p-8">
            <div className="mb-6">
              <h2 className="text-2xl font-semibold text-stone-800 font-display">æ·±åº¦åˆ†æ</h2>
              <p className="text-stone-400 text-sm mt-1">å¤šç»´åº¦å†å²è¡¨ç°åˆ†æä¸ç­–ç•¥ä¼˜åŒ–</p>
            </div>

            <div className="flex gap-2 mb-6">
              {[
                { id: 'parlay', label: 'ä¸²å…³ç»„åˆåˆ†æ' },
                { id: 'mode', label: 'Mode è¡¨ç°åˆ†æ' },
                { id: 'conf', label: 'Conf åŒºé—´åˆ†æ' },
                { id: 'time', label: 'æ—¶é—´è¿‘å› æƒé‡' },
              ].map(tab => (
                <button key={tab.id} onClick={() => setAnalysisTab(tab.id)}
                  className={`px-4 py-2 rounded-xl text-sm transition-all btn-hover ${analysisTab === tab.id ? 'bg-amber-100 text-amber-700 font-medium' : 'bg-stone-100 text-stone-500 hover:bg-stone-200'}`}>
                  {tab.label}
                </button>
              ))}
            </div>

            {analysisTab === 'parlay' && (
              <div className="grid grid-cols-2 gap-6">
                <div className="glow-card bg-white rounded-2xl p-6 border border-stone-100">
                  <div className="relative z-10">
                    <h3 className="font-medium text-stone-700 mb-4">ä¸åŒå…³æ•°ç»„åˆè¡¨ç°</h3>
                    <div className="space-y-3">
                      {[
                        { parlay: 'å•å…³', samples: 52, roi: '+15.2%', hitrate: '71%', partial: null, best: true },
                        { parlay: '2å…³ç»„åˆ', samples: 28, roi: '+8.4%', hitrate: '54%', partial: '2å¯¹1: 18/28', best: false },
                        { parlay: '3å…³ç»„åˆ', samples: 10, roi: '-12.3%', hitrate: '30%', partial: '3å¯¹2: 6/10', best: false },
                        { parlay: '4å…³ç»„åˆ', samples: 3, roi: '-45.0%', hitrate: '0%', partial: '4å¯¹3: 2/3', best: false },
                      ].map((item, i) => (
                        <div key={i} className={`p-4 rounded-xl border ${item.best ? 'border-emerald-200 bg-emerald-50/50' : 'border-stone-100 bg-stone-50'}`}>
                          <div className="flex items-center justify-between">
                            <div className="flex items-center gap-3">
                              <span className="font-medium text-stone-700">{item.parlay}</span>
                              {item.best && <span className="text-[10px] px-2 py-0.5 bg-emerald-200 text-emerald-700 rounded-full">æœ€ä¼˜</span>}
                              {item.partial && <span className="text-[10px] text-stone-400 bg-stone-100 px-2 py-0.5 rounded">{item.partial}</span>}
                            </div>
                            <span className={`font-semibold ${item.roi.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{item.roi}</span>
                          </div>
                          <div className="flex gap-4 mt-2 text-xs text-stone-500">
                            <span>{item.samples} æ ·æœ¬</span>
                            <span>å‘½ä¸­ç‡ {item.hitrate}</span>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
                <div className="glow-card bg-white rounded-2xl p-6 border border-stone-100">
                  <div className="relative z-10">
                    <h3 className="font-medium text-stone-700 mb-4">æœ€ä¼˜ç»„åˆå‘ç°</h3>
                    <div className="space-y-3">
                      {[
                        { combo: 'å•å…³ + å¸¸è§„æ¨¡å¼ + Conf 0.6+', roi: '+28.4%', samples: 24 },
                        { combo: 'å•å…³ + ä¿é™©äº§å“ + Conf 0.7+', roi: '+22.1%', samples: 12 },
                        { combo: '2å…³ç»„åˆ + å¸¸è§„-ç¨³ + Conf 0.5+', roi: '+12.8%', samples: 15 },
                      ].map((item, i) => (
                        <div key={i} className="p-4 rounded-xl bg-stone-50 hover:bg-amber-50 transition-all cursor-pointer lift-card">
                          <div className="flex items-center justify-between mb-1">
                            <span className="text-sm font-medium text-stone-700">{item.combo}</span>
                            <span className="font-semibold text-emerald-600">{item.roi}</span>
                          </div>
                          <span className="text-xs text-stone-400">{item.samples} æ ·æœ¬</span>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            )}

            {analysisTab === 'mode' && (
              <div className="glow-card bg-white rounded-2xl p-6 border border-stone-100">
                <div className="relative z-10">
                  <h3 className="font-medium text-stone-700 mb-4">å„ Mode å†å²è¡¨ç°</h3>
                  <table className="w-full text-sm">
                    <thead><tr className="border-b border-stone-200 text-left text-stone-500">
                      <th className="py-2 font-medium">Mode</th>
                      <th className="py-2 font-medium">æ ·æœ¬æ•°</th>
                      <th className="py-2 font-medium">ROI</th>
                      <th className="py-2 font-medium">å‘½ä¸­ç‡</th>
                      <th className="py-2 font-medium">Avg (Act-Conf)</th>
                      <th className="py-2 font-medium">å¹³å‡ Odds</th>
                      <th className="py-2 font-medium">å»ºè®® Kelly</th>
                    </tr></thead>
                    <tbody>
                      {[
                        { mode: 'å¸¸è§„', samples: 45, roi: '+12.4%', hit: '68%', ratingDiff: '+0.03', odds: '2.1', kelly: '4.0' },
                        { mode: 'å¸¸è§„-ç¨³', samples: 18, roi: '+8.2%', hit: '75%', ratingDiff: '+0.05', odds: '1.7', kelly: '3.5' },
                        { mode: 'ä¿é™©äº§å“', samples: 15, roi: '+18.5%', hit: '82%', ratingDiff: '+0.08', odds: '1.5', kelly: '3.0' },
                        { mode: 'åŠå½©ç¥¨åŠä¿é™©', samples: 10, roi: '-5.2%', hit: '45%', ratingDiff: '-0.12', odds: '2.8', kelly: '5.0' },
                        { mode: 'èµŒä¸€æŠŠ', samples: 5, roi: '-32.0%', hit: '20%', ratingDiff: '-0.25', odds: '4.2', kelly: '6.0' },
                      ].map((r, i) => (
                        <tr key={i} className="border-b border-stone-100">
                          <td className="py-3 font-medium text-stone-700">{r.mode}</td>
                          <td className="py-3 text-stone-600">{r.samples}</td>
                          <td className={`py-3 font-medium ${r.roi.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.roi}</td>
                          <td className="py-3 text-stone-600">{r.hit}</td>
                          <td className={`py-3 font-medium ${r.ratingDiff.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.ratingDiff}</td>
                          <td className="py-3 text-stone-600">{r.odds}</td>
                          <td className="py-3 text-amber-600 font-medium">{r.kelly}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                  <p className="text-xs text-stone-400 mt-4">ğŸ’¡ æ­¤è¡¨ Kelly å»ºè®®å·²åŒæ­¥è‡³å‚æ•°åå°</p>
                </div>
              </div>
            )}

            {analysisTab === 'conf' && (
              <div className="glow-card bg-white rounded-2xl p-6 border border-stone-100">
                <div className="relative z-10">
                  <h3 className="font-medium text-stone-700 mb-4">Conf åŒºé—´åˆ†æ</h3>
                  <div className="grid grid-cols-5 gap-4">
                    {[
                      { range: '0.8+', expected: '0.80', actual: '0.76', diff: '-0.04', samples: 8 },
                      { range: '0.7~0.8', expected: '0.75', actual: '0.72', diff: '-0.03', samples: 15 },
                      { range: '0.6~0.7', expected: '0.65', actual: '0.67', diff: '+0.02', samples: 22 },
                      { range: '0.5~0.6', expected: '0.55', actual: '0.52', diff: '-0.03', samples: 28 },
                      { range: '0.4~0.5', expected: '0.45', actual: '0.48', diff: '+0.03', samples: 15 },
                    ].map((item, i) => (
                      <div key={i} className="p-4 rounded-xl bg-stone-50 text-center">
                        <span className="text-lg font-semibold text-stone-700">{item.range}</span>
                        <div className="mt-3 space-y-1 text-sm">
                          <div className="flex justify-between"><span className="text-stone-400">é¢„æœŸ</span><span>{item.expected}</span></div>
                          <div className="flex justify-between"><span className="text-stone-400">å®é™…</span><span>{item.actual}</span></div>
                          <div className="flex justify-between"><span className="text-stone-400">åå·®</span><span className={item.diff.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}>{item.diff}</span></div>
                        </div>
                        <p className="text-xs text-stone-400 mt-2">{item.samples} æ ·æœ¬</p>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            )}

            {analysisTab === 'time' && (
              <div className="glow-card bg-white rounded-2xl p-6 border border-stone-100">
                <div className="relative z-10">
                  <div className="flex items-center gap-2 mb-4">
                    <h3 className="font-medium text-stone-700">æ—¶é—´è¿‘å› æœºåˆ¶</h3>
                    <span className="text-[10px] px-2 py-0.5 bg-stone-100 text-stone-500 rounded">S10</span>
                  </div>
                  <p className="text-sm text-stone-500 mb-6">Confã€FSE ç­‰å‚æ•°åº”ç”¨æ—¶é—´è¡°å‡æƒé‡ï¼Œè¿‘æœŸè¡¨ç°å½±å“æ›´å¤§</p>
                  <div className="grid grid-cols-3 gap-6">
                    {[
                      { period: 'æœ€è¿‘ 6 åœº', weight: '1.4Ã—', color: 'amber' },
                      { period: 'ç¬¬ 7~11 åœº', weight: '1.15Ã—', color: 'stone' },
                      { period: 'ç¬¬ 12+ åœº', weight: '1.0Ã—', color: 'stone' },
                    ].map((item, i) => (
                      <div key={i} className={`p-6 rounded-xl text-center ${item.color === 'amber' ? 'bg-amber-50 border border-amber-200' : 'bg-stone-50'}`}>
                        <span className={`text-3xl font-bold ${item.color === 'amber' ? 'text-amber-600' : 'text-stone-400'}`}>{item.weight}</span>
                        <p className="text-sm text-stone-600 mt-2">{item.period}</p>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      };

      // New Investment - Updated with multi-entry support (v6.1 step2)
      const NewInvestmentPage = () => {
        const [parlaySize, setParlaySize] = useState(1);
        const [openModeIdx, setOpenModeIdx] = useState(null);

        // Minimal team meta for UI prototype (supports cn / abbr / en)
        const TEAM_META = [
          { name: 'é˜¿æ£®çº³', abbr: ['ARS', 'Arsenal'], samples: 128, rep: 0.62 },
          { name: 'åˆ‡å°”è¥¿', abbr: ['CHE', 'Chelsea'], samples: 115, rep: 0.48 },
          { name: 'åˆ©ç‰©æµ¦', abbr: ['LIV', 'Liverpool'], samples: 132, rep: 0.59 },
          { name: 'æ›¼åŸ', abbr: ['MCI', 'Man City', 'Manchester City'], samples: 141, rep: 0.46 },
          { name: 'å·´å¡ç½—é‚£', abbr: ['BAR', 'FCB', 'Barcelona'], samples: 96, rep: 0.41 },
          { name: 'çš‡å®¶é©¬å¾·é‡Œ', abbr: ['RMA', 'RM', 'Real Madrid'], samples: 102, rep: 0.44 },
          { name: 'çƒ­åˆº', abbr: ['TOT', 'Spurs', 'Tottenham'], samples: 88, rep: 0.51 },
          { name: 'æ›¼è”', abbr: ['MUN', 'MU', 'Man United', 'Manchester United'], samples: 110, rep: 0.49 },
        ];

        const lookupTeam = (q) => {
          const s = (q || '').trim();
          if (!s) return null;
          const lower = s.toLowerCase();
          for (const t of TEAM_META) {
            if (t.name.toLowerCase().includes(lower) || lower.includes(t.name.toLowerCase())) return t;
            if ((t.abbr || []).some(a => a.toLowerCase() === lower || a.toLowerCase().includes(lower) || lower.includes(a.toLowerCase()))) return t;
          }
          return null;
        };

        const MODES = ['å¸¸è§„', 'å¸¸è§„-ç¨³', 'å¸¸è§„-æ æ†', 'åŠå½©ç¥¨åŠä¿é™©', 'ä¿é™©äº§å“', 'èµŒä¸€æŠŠ'];

        const [matches, setMatches] = useState([{
          homeTeam: '', awayTeam: '',
          entries: [{ name: '', odds: '' }],
          conf: 65, mode: 'å¸¸è§„',
          tys_home: 'M', tys_away: 'L', fid: '0.4',
          fse_home: 70, fse_away: 55,
          note: ''
        }]);

        const handleParlayChange = (size) => {
          setParlaySize(size);
          const newMatches = [...matches];
          while (newMatches.length < size) {
            newMatches.push({
              homeTeam: '', awayTeam: '',
              entries: [{ name: '', odds: '' }],
              conf: 50, mode: 'å¸¸è§„',
              tys_home: 'M', tys_away: 'M', fid: '0.4',
              fse_home: 50, fse_away: 50,
              note: ''
            });
          }
          newMatches.splice(size);
          setMatches(newMatches);
          setOpenModeIdx(null);
        };

        const updateMatch = (idx, field, value) => {
          const newMatches = [...matches];
          newMatches[idx][field] = value;
          setMatches(newMatches);
        };

        const addEntry = (matchIdx) => {
          const newMatches = [...matches];
          newMatches[matchIdx].entries.push({ name: '', odds: '' });
          setMatches(newMatches);
        };

        const updateEntry = (matchIdx, entryIdx, field, value) => {
          const newMatches = [...matches];
          newMatches[matchIdx].entries[entryIdx][field] = value;
          setMatches(newMatches);
        };

        const removeEntry = (matchIdx, entryIdx) => {
          const newMatches = [...matches];
          if (newMatches[matchIdx].entries.length > 1) {
            newMatches[matchIdx].entries.splice(entryIdx, 1);
            setMatches(newMatches);
          }
        };

        const calcHarmonicMean = (entries) => {
          const validOdds = entries.filter(e => e.odds && parseFloat(e.odds) > 0).map(e => parseFloat(e.odds));
          if (validOdds.length === 0) return null;
          if (validOdds.length === 1) return validOdds[0].toFixed(2);
          const sum = validOdds.reduce((acc, o) => acc + (1 / o), 0);
          return (validOdds.length / sum).toFixed(2);
        };

        const quickVals = [0.2, 0.4, 0.6, 0.8];
        const setConfQuick = (idx, v) => updateMatch(idx, 'conf', Math.round(v * 100));
        const setFseQuick = (idx, side, v) => updateMatch(idx, side === 'home' ? 'fse_home' : 'fse_away', Math.round(v * 100));

        return (
          <div className="p-8 max-w-5xl" onClick={() => setOpenModeIdx(null)}>
            <div className="mb-6">
              <h2 className="text-2xl font-semibold text-stone-800 font-display">æ–°å»ºæŠ•èµ„</h2>
              <p className="text-stone-400 text-sm mt-1">å½•å…¥æ¯”èµ›ä¿¡æ¯ä¸é¢„æµ‹å‚æ•°</p>
            </div>

            <div className="glow-card bg-white rounded-2xl border border-stone-100 shadow-sm overflow-hidden">
              <div className="relative z-10">
                {/* Parlay Selector */}
                <div className="px-6 py-4 border-b border-stone-100 bg-stone-50/50">
                  <div className="flex items-center gap-4">
                    <span className="text-sm text-stone-600">ä¸²å…³æ•°</span>
                    <div className="flex gap-2">
                      {[1, 2, 3, 4, 5].map(n => (
                        <button key={n} onClick={(e) => { e.stopPropagation(); handleParlayChange(n); }}
                          className={`w-10 h-10 rounded-xl text-sm font-medium transition-all btn-hover ${n === parlaySize ? 'bg-gradient-to-br from-amber-400 to-orange-400 text-white shadow-lg shadow-orange-200/40' : 'bg-white border border-stone-200 text-stone-500 hover:border-amber-300'}`}>{n}</button>
                      ))}
                    </div>
                    <span className="text-xs text-stone-400">ï¼ˆ{parlaySize === 1 ? 'å•å…³' : `${parlaySize}å…³ç»„åˆ`}ï¼‰</span>
                  </div>
                </div>

                {/* Match Cards */}
                <div className="p-6 space-y-6">
                  {matches.map((match, idx) => {
                    const homeInfo = lookupTeam(match.homeTeam);
                    const awayInfo = lookupTeam(match.awayTeam);

                    return (
                      <div key={idx} className={`${idx > 0 ? 'pt-6 border-t border-stone-200' : ''}`} onClick={(e) => e.stopPropagation()}>
                        {/* Match Header */}
                        <div className="flex items-center gap-3 mb-4">
                          <div className="w-6 h-6 rounded-lg bg-amber-100 flex items-center justify-center">
                            <span className="text-amber-600 text-xs font-bold">{idx + 1}</span>
                          </div>
                          <span className="text-sm font-medium text-stone-700">{parlaySize > 1 ? `ç¬¬ ${idx + 1} å…³` : 'æ¯”èµ›ä¿¡æ¯'}</span>
                        </div>

                        {/* Teams */}
                        <div className="grid grid-cols-11 gap-3 items-center mb-4">
                          <div className="col-span-5">
                            <label className="text-xs text-stone-400 mb-1.5 block">ä¸»é˜Ÿ</label>
                            <input type="text" placeholder="è¾“å…¥çƒé˜Ÿåæˆ–ç¼©å†™..." value={match.homeTeam} onChange={(e) => updateMatch(idx, 'homeTeam', e.target.value)}
                              className="input-glow w-full px-4 py-3 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400" />
                            {homeInfo && (
                              <div className="mt-1 flex items-center gap-2 text-[11px] text-stone-500">
                                <span className="px-2 py-0.5 bg-stone-100 rounded-full">{homeInfo.samples} æ ·æœ¬</span>
                                <span className="text-stone-300">Â·</span>
                                <span className="px-2 py-0.5 bg-stone-100 rounded-full">REP <span className="font-medium text-stone-700">{homeInfo.rep.toFixed(2)}</span></span>
                              </div>
                            )}
                          </div>
                          <div className="col-span-1 text-center text-stone-300 text-lg">vs</div>
                          <div className="col-span-5">
                            <label className="text-xs text-stone-400 mb-1.5 block">å®¢é˜Ÿ</label>
                            <input type="text" placeholder="è¾“å…¥çƒé˜Ÿåæˆ–ç¼©å†™..." value={match.awayTeam} onChange={(e) => updateMatch(idx, 'awayTeam', e.target.value)}
                              className="input-glow w-full px-4 py-3 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400" />
                            {awayInfo && (
                              <div className="mt-1 flex items-center gap-2 text-[11px] text-stone-500">
                                <span className="px-2 py-0.5 bg-stone-100 rounded-full">{awayInfo.samples} æ ·æœ¬</span>
                                <span className="text-stone-300">Â·</span>
                                <span className="px-2 py-0.5 bg-stone-100 rounded-full">REP <span className="font-medium text-stone-700">{awayInfo.rep.toFixed(2)}</span></span>
                              </div>
                            )}
                          </div>
                        </div>

                        {/* Entries - Multi support (shorter width, left-shifted) */}
                        <div className="mb-4">
                          <div className="flex items-center justify-between mb-2">
                            <label className="text-xs text-stone-400">Entries é¢„æµ‹ç»“æœ</label>
                            <button onClick={() => addEntry(idx)} className="text-xs text-amber-500 hover:text-amber-600 flex items-center gap-1">+ æ·»åŠ  Entry</button>
                          </div>
                          <div className="space-y-2">
                            {match.entries.map((entry, eIdx) => (
                              <div key={eIdx} className="flex items-center gap-3 max-w-3xl">
                                <div className="flex-1">
                                  <input type="text" placeholder="ä¸»èƒœ / å¹³ / å¤§2.5..." value={entry.name} onChange={(e) => updateEntry(idx, eIdx, 'name', e.target.value)}
                                    className="input-glow w-full px-4 py-2.5 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400" />
                                </div>
                                <div className="w-24">
                                  <input type="number" step="0.01" placeholder="Odds" value={entry.odds} onChange={(e) => updateEntry(idx, eIdx, 'odds', e.target.value)}
                                    className="input-glow w-full px-3 py-2.5 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400" />
                                </div>
                                {match.entries.length > 1 && (
                                  <button onClick={() => removeEntry(idx, eIdx)} className="text-stone-400 hover:text-rose-500 text-sm">Ã—</button>
                                )}
                              </div>
                            ))}
                          </div>
                          {match.entries.length > 1 && (
                            <div className="mt-2 flex items-center gap-2 text-sm">
                              <span className="text-stone-400">Overall Oddsï¼ˆè°ƒå’Œå¹³å‡ï¼‰:</span>
                              <span className="font-semibold text-amber-600">{calcHarmonicMean(match.entries) || '-'}</span>
                            </div>
                          )}
                        </div>

                        {/* Conf + Mode Row */}
                        <div className="grid grid-cols-3 gap-4 mb-4">
                          <div>
                            <label className="text-xs text-stone-400 mb-1.5 block">Mode æ¨¡å¼</label>
                            <div className="relative" onClick={(e) => e.stopPropagation()}>
                              <button
                                onClick={() => setOpenModeIdx(openModeIdx === idx ? null : idx)}
                                className="input-glow w-full px-3 py-3 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400 bg-white cursor-pointer flex items-center justify-between"
                              >
                                <span className="text-stone-700">{match.mode}</span>
                                <span className="text-stone-400 text-xs">â–¼</span>
                              </button>
                              {openModeIdx === idx && (
                                <div className="absolute top-full left-0 mt-1 bg-white rounded-xl shadow-lg border border-stone-200 py-1 z-50 w-full">
                                  {MODES.map((m) => (
                                    <button
                                      key={m}
                                      onClick={() => { updateMatch(idx, 'mode', m); setOpenModeIdx(null); }}
                                      className={`block w-full px-3 py-2 text-left text-sm ${m === match.mode ? 'bg-amber-50 text-amber-700' : 'text-stone-600 hover:bg-stone-50'}`}
                                    >
                                      {m}
                                    </button>
                                  ))}
                                </div>
                              )}
                            </div>
                          </div>
                          <div className="col-span-2">
                            <label className="text-xs text-stone-400 mb-1.5 block">Conf. ä¸»è§‚ç½®ä¿¡åº¦</label>
                            <div className="flex items-center gap-3">
                              <input type="range" min="0" max="100" value={match.conf} onChange={(e) => updateMatch(idx, 'conf', Number(e.target.value))} className="flex-1" />
                              <span className="text-sm font-medium text-amber-600 w-10">{(Number(match.conf) / 100).toFixed(2)}</span>
                            </div>
                            <div className="mt-2 flex items-center justify-between text-[11px] text-stone-500">
                              {quickVals.map((v) => (
                                <button
                                  key={v}
                                  onClick={() => setConfQuick(idx, v)}
                                  className={`px-2 py-1 rounded-lg border btn-hover ${Math.round(Number(match.conf)) === Math.round(v * 100) ? 'bg-amber-50 border-amber-200 text-amber-700' : 'bg-white border-stone-200 hover:border-amber-200 hover:bg-amber-50/50'}`}
                                >
                                  {v.toFixed(1)}
                                </button>
                              ))}
                            </div>
                          </div>
                        </div>

                        {/* Calibration Params - Default Open */}
                        <details className="group" open>
                          <summary className="flex items-center gap-2 cursor-pointer text-sm text-stone-500 hover:text-stone-700 mb-3">
                            <span className="text-xs group-open:rotate-90 transition-transform">â–¶</span>
                            <span>æ ¡å‡†å‚æ•°ï¼ˆTYS / FID / FSEï¼‰</span>
                          </summary>
                          <div className="pl-4 border-l-2 border-amber-100">
                            <div className="grid grid-cols-4 gap-4 mb-3">
                              <div>
                                <label className="text-xs text-stone-400 mb-1.5 block">TYS-base (ä¸»)</label>
                                <div className="flex gap-1">
                                  {['S', 'M', 'L', 'H'].map(v => (
                                    <button key={v} onClick={() => updateMatch(idx, 'tys_home', v)}
                                      className={`flex-1 py-2 rounded-lg text-xs font-medium btn-hover ${v === match.tys_home ? 'bg-amber-100 text-amber-700 border border-amber-200' : 'bg-stone-50 text-stone-500 border border-stone-100'}`}>{v}</button>
                                  ))}
                                </div>
                              </div>
                              <div>
                                <label className="text-xs text-stone-400 mb-1.5 block">TYS-base (å®¢)</label>
                                <div className="flex gap-1">
                                  {['S', 'M', 'L', 'H'].map(v => (
                                    <button key={v} onClick={() => updateMatch(idx, 'tys_away', v)}
                                      className={`flex-1 py-2 rounded-lg text-xs font-medium btn-hover ${v === match.tys_away ? 'bg-amber-100 text-amber-700 border border-amber-200' : 'bg-stone-50 text-stone-500 border border-stone-100'}`}>{v}</button>
                                  ))}
                                </div>
                              </div>
                              <div className="col-span-2">
                                <label className="text-xs text-stone-400 mb-1.5 block">FID ä¿¡æ¯æ·±åº¦</label>
                                <div className="flex gap-1">
                                  {['0', '0.25', '0.4', '0.6', '0.75'].map(v => (
                                    <button key={v} onClick={() => updateMatch(idx, 'fid', v)}
                                      className={`flex-1 py-2 rounded-lg text-xs font-medium btn-hover ${v === match.fid ? 'bg-amber-100 text-amber-700 border border-amber-200' : 'bg-stone-50 text-stone-500 border border-stone-100'}`}>{v}</button>
                                  ))}
                                </div>
                              </div>
                            </div>
                            <div className="grid grid-cols-2 gap-4">
                              <div>
                                <label className="text-xs text-stone-400 mb-1.5 block">FSE (ä¸») Feature Sensor Beta</label>
                                <div className="flex items-center gap-3">
                                  <input type="range" min="0" max="100" value={match.fse_home} onChange={(e) => updateMatch(idx, 'fse_home', Number(e.target.value))} className="flex-1" />
                                  <span className="text-sm font-medium text-stone-600 w-10">{(Number(match.fse_home) / 100).toFixed(2)}</span>
                                </div>
                                <div className="mt-2 flex items-center justify-between text-[11px] text-stone-500">
                                  {quickVals.map((v) => (
                                    <button key={v} onClick={() => setFseQuick(idx, 'home', v)}
                                      className={`px-2 py-1 rounded-lg border btn-hover ${Math.round(Number(match.fse_home)) === Math.round(v * 100) ? 'bg-amber-50 border-amber-200 text-amber-700' : 'bg-white border-stone-200 hover:border-amber-200 hover:bg-amber-50/50'}`}>
                                      {v.toFixed(1)}
                                    </button>
                                  ))}
                                </div>
                              </div>
                              <div>
                                <label className="text-xs text-stone-400 mb-1.5 block">FSE (å®¢) Feature Sensor Beta</label>
                                <div className="flex items-center gap-3">
                                  <input type="range" min="0" max="100" value={match.fse_away} onChange={(e) => updateMatch(idx, 'fse_away', Number(e.target.value))} className="flex-1" />
                                  <span className="text-sm font-medium text-stone-600 w-10">{(Number(match.fse_away) / 100).toFixed(2)}</span>
                                </div>
                                <div className="mt-2 flex items-center justify-between text-[11px] text-stone-500">
                                  {quickVals.map((v) => (
                                    <button key={v} onClick={() => setFseQuick(idx, 'away', v)}
                                      className={`px-2 py-1 rounded-lg border btn-hover ${Math.round(Number(match.fse_away)) === Math.round(v * 100) ? 'bg-amber-50 border-amber-200 text-amber-700' : 'bg-white border-stone-200 hover:border-amber-200 hover:bg-amber-50/50'}`}>
                                      {v.toFixed(1)}
                                    </button>
                                  ))}
                                </div>
                              </div>
                            </div>
                          </div>
                        </details>

                        {/* Pre-match Note */}
                        <div className="mt-4">
                          <label className="text-xs text-stone-400 mb-1.5 block">èµ›å‰å¤‡æ³¨</label>
                          <input type="text" placeholder="é€‰å¡«ï¼Œè®°å½•é¢„åˆ¤ä¾æ®æˆ–å…³æ³¨ç‚¹..." value={match.note} onChange={(e) => updateMatch(idx, 'note', e.target.value)}
                            className="input-glow w-full px-4 py-2.5 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400" />
                        </div>
                      </div>
                    );
                  })}
                </div>

                {/* Result Panel */}
                <div className="px-6 py-5 bg-gradient-to-r from-stone-50 to-orange-50/30 border-t border-stone-100">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center gap-6">
                      <div>
                        <span className="text-xs text-stone-400 block">ç»¼åˆ Odds</span>
                        <span className="text-xl font-semibold text-stone-800">{parlaySize > 1 ? '4.32' : '2.15'}</span>
                      </div>
                      <div className="w-px h-10 bg-stone-200" />
                      <div>
                        <span className="text-xs text-stone-400 block">Expected Rating</span>
                        <span className="text-xl font-semibold text-stone-800">0.62</span>
                      </div>
                      <div className="w-px h-10 bg-stone-200" />
                      <div>
                        <span className="text-xs text-stone-400 block">Recom. Invest</span>
                        <span className="text-xl font-semibold text-amber-600">Â¥ {parlaySize > 1 ? '85' : '185'}</span>
                      </div>
                      <div className="w-px h-10 bg-stone-200" />
                      <div>
                        <span className="text-xs text-stone-400 block">é£æ§ä¸Šé™</span>
                        <span className="text-sm text-stone-500">Â¥ 341 (12%)</span>
                      </div>
                    </div>
                    <div className="flex items-center gap-3">
                      <div>
                        <label className="text-xs text-stone-400 mb-1 block">Inputs å®é™…æŠ•èµ„</label>
                        <input type="number" defaultValue={parlaySize > 1 ? 80 : 180}
                          className="input-glow w-28 px-3 py-2 rounded-xl border border-stone-200 text-sm font-medium focus:outline-none focus:border-amber-400" />
                      </div>
                      <div className="flex flex-col gap-2">
                        <button className="px-5 py-2.5 bg-gradient-to-r from-amber-400 to-orange-400 text-white rounded-xl text-sm font-medium shadow-lg shadow-orange-200/40 btn-hover">ç¡®è®¤æŠ•èµ„</button>
                        <button onClick={() => setActivePage('combo')}
                          className="px-5 py-2 border border-stone-300 text-stone-600 rounded-xl text-xs font-medium hover:bg-stone-50 hover:border-amber-300 hover:text-amber-600 transition-all btn-hover">+ åŠ å…¥ä»Šæ—¥å¤‡é€‰</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      };

      // History with pre/post notes

      const HistoryPage = () => (
        <div className="p-8">
          <div className="flex items-center justify-between mb-6">
            <div>
              <h2 className="text-2xl font-semibold text-stone-800 font-display">å†å²è®°å½•</h2>
              <p className="text-stone-400 text-sm mt-1">å…± 93 æ¡æŠ•èµ„è®°å½•</p>
            </div>
            <div className="flex items-center gap-3">
              <input type="text" placeholder="æœç´¢çƒé˜Ÿã€æ—¥æœŸ..." className="input-glow px-4 py-2 rounded-xl border border-stone-200 text-sm w-64 focus:outline-none focus:border-amber-400" />
              <button className="px-4 py-2 rounded-xl border border-stone-200 text-sm text-stone-600 hover:bg-stone-50 btn-hover">ç­›é€‰</button>
            </div>
          </div>

          <div className="flex gap-2 mb-4">
            {['å…¨éƒ¨', 'å¾…ç»“ç®—', 'å·²ä¸­', 'æœªä¸­', 'å•å…³', 'ä¸²å…³'].map((tag, i) => (
              <button key={tag} className={`px-4 py-1.5 rounded-full text-sm transition-all btn-hover ${i === 0 ? 'bg-amber-100 text-amber-700' : 'bg-stone-100 text-stone-500 hover:bg-stone-200'}`}>{tag}</button>
            ))}
          </div>

          <div className="glow-card bg-white rounded-2xl border border-stone-100 overflow-hidden">
            <div className="relative z-10">
              <table className="w-full">
                <thead>
                  <tr className="bg-stone-50 text-xs text-stone-500">
                    <th className="px-4 py-3 text-left font-medium">æ—¥æœŸ</th>
                    <th className="px-4 py-3 text-left font-medium">æ¯”èµ›</th>
                    <th className="px-4 py-3 text-left font-medium">Entries</th>
                    <th className="px-4 py-3 text-left font-medium">Odds</th>
                    <th className="px-4 py-3 text-left font-medium">Conf</th>
                    <th className="px-4 py-3 text-left font-medium">Inputs</th>
                    <th className="px-4 py-3 text-left font-medium">çŠ¶æ€</th>
                    <th className="px-4 py-3 text-left font-medium">ç›ˆäº</th>
                    <th className="px-4 py-3 text-left font-medium">å¤‡æ³¨</th>
                  </tr>
                </thead>
                <tbody>
                  {[
                    { date: '02-02', match: 'é˜¿æ£®çº³ vs åˆ‡å°”è¥¿', entries: 'ä¸»èƒœ', odds: 2.15, conf: 0.65, inputs: 180, status: 'pending', profit: '-', preNote: 'ä¸»åœºå¼ºåŠ¿', postNote: '-' },
                    { date: '02-01', match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', entries: 'å¤§2.5', odds: 1.85, conf: 0.72, inputs: 200, status: 'win', profit: '+170', preNote: 'åŒæ–¹è¿›æ”»ç«åŠ›å¼º', postNote: 'é¢„åˆ¤å‡†ç¡®' },
                    { date: '01-31', match: 'çƒ­åˆº vs æ›¼è”', entries: 'å¹³å±€', odds: 3.40, conf: 0.42, inputs: 120, status: 'lose', profit: '-120', preNote: 'çŠ¶æ€éƒ½ä¸€èˆ¬', postNote: 'çƒ­åˆºæ„å¤–çˆ†å‘' },
                  ].map((row, i) => (
                    <tr key={i} className="border-t border-stone-100 hover:bg-amber-50/30 cursor-pointer transition-colors">
                      <td className="px-4 py-3 text-sm text-stone-500">{row.date}</td>
                      <td className="px-4 py-3 text-sm font-medium text-stone-700">{row.match}</td>
                      <td className="px-4 py-3 text-sm text-stone-600">{row.entries}</td>
                      <td className="px-4 py-3 text-sm text-stone-600">{row.odds}</td>
                      <td className="px-4 py-3 text-sm text-stone-600">{row.conf}</td>
                      <td className="px-4 py-3 text-sm text-stone-600">Â¥{row.inputs}</td>
                      <td className="px-4 py-3">
                        <span className={`px-2 py-1 rounded-full text-xs ${row.status === 'pending' ? 'bg-amber-100 text-amber-700' : row.status === 'win' ? 'bg-emerald-100 text-emerald-700' : 'bg-rose-100 text-rose-700'}`}>
                          {row.status === 'pending' ? 'å¾…ç»“ç®—' : row.status === 'win' ? 'å·²ä¸­' : 'æœªä¸­'}
                        </span>
                      </td>
                      <td className={`px-4 py-3 text-sm font-medium ${row.profit === '-' ? 'text-stone-400' : row.profit.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{row.profit}</td>
                      <td className="px-4 py-3 text-xs text-stone-400 max-w-32 truncate" title={`èµ›å‰: ${row.preNote} | èµ›å: ${row.postNote}`}>
                        {row.preNote}
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      );

      // Teams
      const TeamsPage = () => {
        const [selectedTeam, setSelectedTeam] = useState(null);
        const [searchQuery, setSearchQuery] = useState('');
        const [filterLeague, setFilterLeague] = useState('all');
        
        const teams = [
          { name: 'é˜¿æ£®çº³', abbr: 'ARS', league: 'è‹±è¶…', samples: 18, roi: '+12.4%', avgRep: 0.42, ratingDiff: '+0.03' },
          { name: 'åˆ‡å°”è¥¿', abbr: 'CHE', league: 'è‹±è¶…', samples: 15, roi: '+8.2%', avgRep: 0.38, ratingDiff: '-0.02' },
          { name: 'åˆ©ç‰©æµ¦', abbr: 'LIV', league: 'è‹±è¶…', samples: 22, roi: '+18.7%', avgRep: 0.45, ratingDiff: '+0.05' },
          { name: 'æ›¼åŸ', abbr: 'MCI', league: 'è‹±è¶…', samples: 20, roi: '-3.2%', avgRep: 0.52, ratingDiff: '-0.08' },
          { name: 'å·´å¡ç½—é‚£', abbr: 'BAR', league: 'è¥¿ç”²', samples: 8, roi: '+15.2%', avgRep: 0.35, ratingDiff: '+0.08' },
          { name: 'çš‡å®¶é©¬å¾·é‡Œ', abbr: 'RMA', league: 'è¥¿ç”²', samples: 10, roi: '+6.8%', avgRep: 0.40, ratingDiff: '-0.03' },
        ];

        const filteredTeams = teams.filter(team => {
          const matchSearch = team.name.toLowerCase().includes(searchQuery.toLowerCase()) || team.abbr.toLowerCase().includes(searchQuery.toLowerCase());
          const matchLeague = filterLeague === 'all' || team.league === filterLeague;
          return matchSearch && matchLeague;
        });

        return (
          <div className="p-8">
            <div className="mb-6">
              <h2 className="text-2xl font-semibold text-stone-800 font-display">çƒé˜Ÿæ¡£æ¡ˆé¦†</h2>
              <p className="text-stone-400 text-sm mt-1">æ¯æ”¯çƒé˜Ÿçš„å†å²è¡¨ç°è¿½è¸ªä¸åˆ†æ</p>
            </div>

            <div className="glow-card bg-white rounded-2xl p-4 border border-stone-100 mb-6">
              <div className="relative z-10 flex items-center gap-4">
                <div className="flex-1 relative">
                  <span className="absolute left-3 top-1/2 -translate-y-1/2 text-stone-400">ğŸ”</span>
                  <input type="text" placeholder="æœç´¢çƒé˜Ÿåç§°æˆ–ç¼©å†™..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}
                    className="input-glow w-full pl-10 pr-4 py-2.5 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400" />
                </div>
                <div className="flex items-center gap-2">
                  <span className="text-sm text-stone-500">è”èµ›:</span>
                  <div className="flex gap-1">
                    {['all', 'è‹±è¶…', 'è¥¿ç”²', 'å¾·ç”²'].map(league => (
                      <button key={league} onClick={() => setFilterLeague(league)}
                        className={`px-3 py-1.5 rounded-lg text-xs font-medium btn-hover ${filterLeague === league ? 'bg-amber-100 text-amber-700' : 'bg-stone-100 text-stone-500 hover:bg-stone-200'}`}>
                        {league === 'all' ? 'å…¨éƒ¨' : league}
                      </button>
                    ))}
                  </div>
                </div>
                <div className="text-sm text-stone-400">å…± {filteredTeams.length} æ”¯çƒé˜Ÿ</div>
              </div>
            </div>

            <div className="grid grid-cols-3 gap-4 mb-6">
              {filteredTeams.map((team, i) => (
                <div key={i} onClick={() => setSelectedTeam(team)}
                  className={`glow-card bg-white rounded-2xl p-5 border cursor-pointer transition-all ${selectedTeam?.name === team.name ? 'border-amber-300 bg-amber-50/30' : 'border-stone-100'}`}>
                  <div className="relative z-10">
                    <div className="flex items-center justify-between mb-3">
                      <div>
                        <span className="font-medium text-stone-800">{team.name}</span>
                        <span className="text-xs text-stone-400 ml-2">{team.abbr}</span>
                      </div>
                      <div className="flex items-center gap-2">
                        <span className="text-[10px] px-2 py-0.5 bg-stone-100 text-stone-500 rounded-full">{team.league}</span>
                        <span className="text-xs text-stone-400">{team.samples} åœº</span>
                      </div>
                    </div>
                    <div className="grid grid-cols-3 gap-2 text-center">
                      <div>
                        <span className="text-xs text-stone-400 block">ROI</span>
                        <span className={`text-sm font-medium ${team.roi.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{team.roi}</span>
                      </div>
                      <div>
                        <span className="text-xs text-stone-400 block">Avg REP</span>
                        <span className="text-sm font-medium text-stone-700">{team.avgRep}</span>
                      </div>
                      <div>
                        <span className="text-xs text-stone-400 block">Rating Î”</span>
                        <span className={`text-sm font-medium ${team.ratingDiff.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{team.ratingDiff}</span>
                      </div>
                    </div>
                  </div>
                </div>
              ))}
            </div>

            {selectedTeam && (
              <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
                <div className="relative z-10">
                  <div className="flex items-center justify-between mb-6">
                    <div className="flex items-center gap-3">
                      <h3 className="font-medium text-stone-800">{selectedTeam.name} Â· è¯¦ç»†æ¡£æ¡ˆ</h3>
                      <span className="text-xs px-2 py-0.5 bg-stone-100 text-stone-500 rounded-full">{selectedTeam.league}</span>
                    </div>
                    <button onClick={() => setSelectedTeam(null)} className="text-stone-400 hover:text-stone-600">Ã—</button>
                  </div>
                  <div className="grid grid-cols-2 gap-6">
                    <div>
                      <h4 className="text-sm font-medium text-stone-600 mb-3">ROI èµ°åŠ¿</h4>
                      <div className="h-32 flex items-end gap-1">
                        {[5, 8, 3, 12, 7, 15, 10, 18].map((h, i) => (
                          <div key={i} className="flex-1 bg-gradient-to-t from-amber-400 to-orange-300 rounded-t-sm chart-bar" style={{ height: `${h * 5}%` }} />
                        ))}
                      </div>
                    </div>
                    <div>
                      <h4 className="text-sm font-medium text-stone-600 mb-3">(Act. - Exp.) Rating èµ°åŠ¿</h4>
                      <div className="h-32 flex items-center">
                        <svg viewBox="0 0 100 50" className="w-full h-full">
                          <line x1="0" y1="25" x2="100" y2="25" stroke="#e7e5e4" strokeWidth="0.5" strokeDasharray="2" />
                          <polyline fill="none" stroke="url(#lg)" strokeWidth="2" points="5,30 20,22 35,28 50,18 65,24 80,15 95,20" />
                          <defs><linearGradient id="lg" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stopColor="#fbbf24" /><stop offset="100%" stopColor="#f97316" /></linearGradient></defs>
                        </svg>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      };

      // Settle - Portfolio as minimum unit (v6.1 step2)
      const SettlePage = () => {
        const [openComboIds, setOpenComboIds] = useState([]); // default all collapsed
        const [combos, setCombos] = useState([
          {
            id: 'p1',
            type: '2 Matches Combo',
            date: '02-02',
            revenue: 0,
            legs: [
              { id: 'p1-1', match: 'é˜¿æ£®çº³ vs åˆ‡å°”è¥¿', entry: 'ä¸»èƒœ', odds: 2.15, inputs: 180, conf: 0.65, preNote: 'ä¸»åœºå¼ºåŠ¿', results: '', hit: null, ajr: '', rep: '' , postNote: ''},
              { id: 'p1-2', match: 'å·´å¡ç½—é‚£ vs çš‡å®¶é©¬å¾·é‡Œ', entry: 'å¤§2.5', odds: 1.95, inputs: 150, conf: 0.58, preNote: 'å›½å®¶å¾·æ¯”è¿›çƒå¤š', results: '', hit: null, ajr: '', rep: '' , postNote: ''},
            ]
          },
          {
            id: 'p2',
            type: 'Single Match',
            date: '02-02',
            revenue: 0,
            legs: [
              { id: 'p2-1', match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', entry: 'å¤§2.5', odds: 1.85, inputs: 200, conf: 0.72, preNote: 'ç«åŠ›å¯¹è½°', results: '', hit: null, ajr: '', rep: '' , postNote: ''},
            ]
          },
          {
            id: 'p3',
            type: '3 Matches Combo',
            date: '02-01',
            revenue: 0,
            legs: [
              { id: 'p3-1', match: 'çƒ­åˆº vs æ›¼è”', entry: 'å¹³å±€', odds: 3.40, inputs: 80, conf: 0.42, preNote: 'çŠ¶æ€éƒ½ä¸€èˆ¬', results: '', hit: null, ajr: '', rep: '' , postNote: ''},
              { id: 'p3-2', match: 'æ‹œä» vs å¤šç‰¹', entry: 'ä¸»èƒœ', odds: 1.62, inputs: 80, conf: 0.61, preNote: 'å¼ºé˜Ÿä¸»åœº', results: '', hit: null, ajr: '', rep: '' , postNote: ''},
              { id: 'p3-3', match: 'å·´é» vs é‡Œæ˜‚', entry: 'è®©èƒœ', odds: 1.75, inputs: 80, conf: 0.55, preNote: 'é˜µå®¹å®Œæ•´', results: '', hit: null, ajr: '', rep: '' , postNote: ''},
            ]
          }
        ]);

        const toggleOpen = (id) => {
          setOpenComboIds(prev => prev.includes(id) ? prev.filter(x => x !== id) : [...prev, id]);
        };

        const updateCombo = (id, field, value) => {
          setCombos(prev => prev.map(c => c.id === id ? { ...c, [field]: value } : c));
        };

        const updateLeg = (comboId, legId, field, value) => {
          setCombos(prev => prev.map(c => {
            if (c.id !== comboId) return c;
            return {
              ...c,
              legs: c.legs.map(l => l.id === legId ? { ...l, [field]: value } : l)
            };
          }));
        };

        const totalCombos = combos.length;
        const totalLegs = combos.reduce((s, c) => s + c.legs.length, 0);

        const comboCombinedOdds = (legs) => {
          const v = legs.reduce((acc, l) => acc * (Number(l.odds) || 1), 1);
          return v.toFixed(2);
        };

        const comboTotalInputs = (legs) => legs.reduce((acc, l) => acc + (Number(l.inputs) || 0), 0);

        const allocateRevenue = (combo) => {
          const sumOdds = combo.legs.reduce((acc, l) => acc + (Number(l.odds) || 0), 0);
          const rev = Number(combo.revenue) || 0;
          if (!sumOdds || !rev) return combo.legs.map(() => 0);
          return combo.legs.map(l => (rev * (Number(l.odds) || 0) / sumOdds));
        };

        return (
          <div className="p-8">
            <div className="mb-6">
              <h2 className="text-2xl font-semibold text-stone-800 font-display">å¾…ç»“ç®—</h2>
              <p className="text-stone-400 text-sm mt-1">{totalCombos} ä»½æŠ•èµ„å¾…å½•å…¥ç»“æœï¼Œå…± {totalLegs} åœºæ¯”èµ›</p>
            </div>

            <div className="space-y-4">
              {combos.map((combo) => {
                const isOpen = openComboIds.includes(combo.id);
                const combinedOdds = comboCombinedOdds(combo.legs);
                const totalInputs = comboTotalInputs(combo.legs);
                const allocations = allocateRevenue(combo);

                return (
                  <div key={combo.id} className="glow-card bg-white rounded-2xl border border-stone-100 overflow-hidden">
                    <div className="relative z-10">
                      {/* Header */}
                      <button
                        onClick={() => toggleOpen(combo.id)}
                        className="w-full px-6 py-5 flex items-center justify-between text-left hover:bg-amber-50/30 transition-colors"
                      >
                        <div>
                          <div className="flex items-center gap-3">
                            <p className="font-semibold text-stone-800 text-lg">{combo.type}</p>
                            <span className="text-xs text-stone-400">{combo.date}</span>
                            <span className="px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-xs font-medium">å¾…ç»“ç®—</span>
                          </div>
                          <div className="mt-1 text-sm text-stone-500 flex items-center gap-2">
                            <span>ç»¼åˆ Odds <span className="font-semibold text-stone-800">{combinedOdds}</span></span>
                            <span className="text-stone-300">Â·</span>
                            <span>æŠ•å…¥ <span className="font-semibold text-stone-800">{totalInputs} rmb</span></span>
                            <span className="text-stone-300">Â·</span>
                            <span>{combo.legs.length} åœºæ¯”èµ›</span>
                          </div>
                        </div>
                        <div className="flex items-center gap-3">
                          <div className="hidden md:block text-right">
                            <div className="text-xs text-stone-400 mb-1">Revenueï¼ˆç»„åˆæ”¶ç›Šï¼‰</div>
                            <input
                              type="number"
                              value={combo.revenue}
                              onClick={(e) => e.stopPropagation()}
                              onChange={(e) => updateCombo(combo.id, 'revenue', e.target.value)}
                              className="input-glow w-28 px-3 py-2 rounded-xl border border-stone-200 text-sm font-medium focus:outline-none focus:border-amber-400 text-right"
                              placeholder="0"
                            />
                          </div>
                          <span className={`text-stone-400 transition-transform ${isOpen ? 'rotate-90' : ''}`}>â€º</span>
                        </div>
                      </button>

                      {/* Body */}
                      {isOpen && (
                        <div className="px-6 pb-6">
                          <div className="mt-3 p-4 rounded-xl bg-stone-50 border border-stone-100">
                            <div className="flex items-start justify-between gap-4">
                              <div>
                                <div className="text-sm font-medium text-stone-700 mb-1">ç»“ç®—é€»è¾‘</div>
                                <p className="text-sm text-stone-500 leading-relaxed">
                                  æœ¬é¡µæœ€å°ä½œæˆ˜å•å…ƒä¸ºâ€œæ¯ä»½ç»„åˆæŠ•èµ„â€ã€‚å½“ä½ ä¸ºç»„åˆå½•å…¥ Revenueï¼ˆé»˜è®¤ 0ï¼‰æ—¶ï¼Œç³»ç»Ÿå°†æŒ‰æ¯åœºæ¯”èµ›çš„ <span className="font-medium">èµ”ç‡æ¯”ä¾‹</span> åˆ†æ‘Šæ”¶ç›Šåˆ°å„åœºæ¯”èµ›ï¼Œç”¨äºåç»­å†å²è®°å½•ä¸ç»Ÿè®¡ã€‚
                                </p>
                              </div>
                              <div className="md:hidden">
                                <div className="text-xs text-stone-400 mb-1 text-right">Revenue</div>
                                <input
                                  type="number"
                                  value={combo.revenue}
                                  onChange={(e) => updateCombo(combo.id, 'revenue', e.target.value)}
                                  className="input-glow w-24 px-3 py-2 rounded-xl border border-stone-200 text-sm font-medium focus:outline-none focus:border-amber-400 text-right"
                                  placeholder="0"
                                />
                              </div>
                            </div>
                          </div>

                          <div className="mt-4 space-y-3">
                            {combo.legs.map((leg, i) => (
                              <div key={leg.id} className="p-4 rounded-xl border border-stone-100 bg-white hover:bg-amber-50/20 transition-colors">
                                <div className="flex items-start justify-between gap-4">
                                  <div>
                                    <p className="font-medium text-stone-800">{leg.match}</p>
                                    <p className="text-xs text-stone-400 mt-1">
                                      é¢„æµ‹ <span className="text-stone-700 font-medium">{leg.entry}</span>
                                      <span className="text-stone-300"> Â· </span>
                                      Odds <span className="font-medium italic text-stone-700">{Number(leg.odds).toFixed(2)}</span>
                                      <span className="text-stone-300"> Â· </span>
                                      æŠ•å…¥ <span className="font-semibold text-stone-800">{leg.inputs} rmb</span>
                                      <span className="text-stone-300"> Â· </span>
                                      Conf <span style={confStyle(leg.conf)} className="font-medium">{Number(leg.conf).toFixed(2)}</span>
                                    </p>
                                    {leg.preNote && (
                                      <p className="text-xs text-stone-400 mt-1">èµ›å‰å¤‡æ³¨ï¼š{leg.preNote}</p>
                                    )}
                                  </div>

                                  {(Number(combo.revenue) || 0) > 0 && (
                                    <div className="text-right">
                                      <div className="text-[11px] text-stone-400">åˆ†æ‘Šæ”¶ç›Š</div>
                                      <div className="text-sm font-semibold text-amber-600">{allocations[i].toFixed(1)} rmb</div>
                                    </div>
                                  )}
                                </div>

                                <div className="grid grid-cols-12 gap-3 mt-4">
                                  <div className="col-span-4">
                                    <label className="text-xs text-stone-400 mb-1.5 block">Results å®é™…ç»“æœ</label>
                                    <input
                                      type="text"
                                      value={leg.results}
                                      onChange={(e) => updateLeg(combo.id, leg.id, 'results', e.target.value)}
                                      placeholder="æ¯”åˆ†æˆ–ç»“æœ..."
                                      className="input-glow w-full px-3 py-2.5 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400"
                                    />
                                  </div>

                                  <div className="col-span-3">
                                    <label className="text-xs text-stone-400 mb-1.5 block">æ˜¯å¦å‘½ä¸­</label>
                                    <div className="flex gap-2">
                                      <button
                                        onClick={() => updateLeg(combo.id, leg.id, 'hit', true)}
                                        className={`flex-1 py-2.5 rounded-lg text-xs font-medium border btn-hover ${leg.hit === true ? 'bg-emerald-100 text-emerald-700 border-emerald-200' : 'bg-white text-stone-500 border-stone-200 hover:border-emerald-200 hover:bg-emerald-50'}`}
                                      >âœ“ ä¸­</button>
                                      <button
                                        onClick={() => updateLeg(combo.id, leg.id, 'hit', false)}
                                        className={`flex-1 py-2.5 rounded-lg text-xs font-medium border btn-hover ${leg.hit === false ? 'bg-rose-100 text-rose-700 border-rose-200' : 'bg-white text-stone-500 border-stone-200 hover:border-rose-200 hover:bg-rose-50'}`}
                                      >âœ— æœªä¸­</button>
                                    </div>
                                  </div>

                                  <div className="col-span-2">
                                    <label className="text-xs text-stone-400 mb-1.5 block">AJR</label>
                                    <input
                                      type="number"
                                      step="0.01"
                                      value={leg.ajr}
                                      onChange={(e) => updateLeg(combo.id, leg.id, 'ajr', e.target.value)}
                                      placeholder="0~1"
                                      className="input-glow w-full px-3 py-2.5 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400"
                                    />
                                  </div>

                                  <div className="col-span-3">
                                    <label className="text-xs text-stone-400 mb-1.5 block">REP éšæœºäº‹ä»¶</label>
                                    <input
                                      type="number"
                                      step="0.1"
                                      value={leg.rep}
                                      onChange={(e) => updateLeg(combo.id, leg.id, 'rep', e.target.value)}
                                      placeholder="0~1.8"
                                      className="input-glow w-full px-3 py-2.5 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400"
                                    />
                                  </div>
                                </div>

                                <div className="mt-3">
                                  <label className="text-xs text-stone-400 mb-1.5 block">èµ›åå¤‡æ³¨ï¼ˆå¤ç›˜å¿ƒå¾—ï¼‰</label>
                                  <input
                                    type="text"
                                    value={leg.postNote}
                                    onChange={(e) => updateLeg(combo.id, leg.id, 'postNote', e.target.value)}
                                    placeholder="é€‰å¡«..."
                                    className="input-glow w-full px-3 py-2.5 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400"
                                  />
                                </div>
                              </div>
                            ))}
                          </div>

                          <div className="flex items-center justify-end mt-4">
                            <button className="px-6 py-2.5 bg-gradient-to-r from-amber-400 to-orange-400 text-white rounded-xl text-sm font-medium shadow-lg shadow-orange-200/40 btn-hover">
                              ç¡®è®¤ç»“ç®—
                            </button>
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        );
      };

      // Combo - Refined visuals + explanation (v6.1 step2)
      const ComboPage = () => {
        const [selectedIdx, setSelectedIdx] = useState([0, 1]);
        const [risk, setRisk] = useState(48);

        const toggle = (i) => {
          setSelectedIdx(prev => prev.includes(i) ? prev.filter(x => x !== i) : [...prev, i]);
        };

        const candidates = [
          { match: 'é˜¿æ£®çº³ vs åˆ‡å°”è¥¿', conf: 0.65, odds: 2.15, ev: 0.082 },
          { match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', conf: 0.58, odds: 1.95, ev: 0.051 },
          { match: 'å·´å¡ç½—é‚£ vs çš‡é©¬', conf: 0.45, odds: 2.80, ev: 0.036 },
        ];

        const recos = [
          { tier: 'T1 ä¸»æ¨', combo: 'é˜¿æ£®çº³ä¸»èƒœ Ã— åˆ©ç‰©æµ¦å¤§2.5', allocation: 280, ev: 0.124, winRate: 0.58, sharpe: 1.82 },
          { tier: 'T2 æ¬¡æ¨', combo: 'é˜¿æ£®çº³ä¸»èƒœ Â· å•å…³', allocation: 180, ev: 0.082, winRate: 0.65, sharpe: 1.45 },
          { tier: 'T3 åšå†·', combo: '3 Matches Combo', allocation: 60, ev: 0.187, winRate: 0.22, sharpe: 0.92 },
        ];

        const totalAlloc = recos.reduce((s, r) => s + r.allocation, 0);

        return (
          <div className="p-8">
            <div className="mb-6">
              <h2 className="text-2xl font-semibold text-stone-800 font-display">æ™ºèƒ½ç»„åˆå»ºè®®</h2>
              <p className="text-stone-400 text-sm mt-1">åŸºäº Portfolio Optimization çš„æœ€ä¼˜ä¸‹æ³¨æ–¹æ¡ˆ</p>
            </div>

            <div className="grid grid-cols-2 gap-6">
              <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
                <div className="relative z-10">
                  <div className="flex items-center justify-between mb-4">
                    <h3 className="font-medium text-stone-700">ä»Šæ—¥å¤‡é€‰æ¯”èµ›</h3>
                    <button onClick={() => setActivePage('new')} className="text-xs text-amber-500 hover:text-amber-600">+ æ·»åŠ æ¯”èµ›</button>
                  </div>

                  <div className="space-y-3">
                    {candidates.map((item, i) => {
                      const selected = selectedIdx.includes(i);
                      return (
                        <div key={i} className="flex items-center justify-between p-4 rounded-xl bg-stone-50 border border-stone-100 hover:border-amber-200 hover:bg-amber-50/40 transition-all cursor-pointer lift-card"
                          onClick={() => toggle(i)}
                        >
                          <div className="flex items-center gap-3">
                            <div className={`w-5 h-5 rounded-md border flex items-center justify-center transition-all ${selected ? 'border-amber-300 bg-amber-50' : 'border-stone-200 bg-white/70'}`}>
                              {selected ? (
                                <svg width="14" height="14" viewBox="0 0 20 20" className="text-amber-600">
                                  <path d="M4 10.5l3.2 3.2L16 4.9" fill="none" stroke="currentColor" strokeWidth="2.2" strokeLinecap="round" strokeLinejoin="round" />
                                </svg>
                              ) : (
                                <span className="w-2 h-2 rounded-sm bg-stone-200/60" />
                              )}
                            </div>
                            <div>
                              <p className="text-sm font-medium text-stone-700">{item.match}</p>
                              <p className="text-xs text-stone-400">
                                Conf <span style={confStyle(item.conf)} className="font-medium">{item.conf.toFixed(2)}</span>
                                <span className="text-stone-300"> Â· </span>
                                Odds <span className="font-medium italic text-stone-600">{item.odds.toFixed(2)}</span>
                              </p>
                            </div>
                          </div>

                          <div className="text-right">
                            <div className="text-xs text-stone-500">é¢„æœŸæ”¶ç›Š</div>
                            <div className="text-sm font-semibold text-stone-800">+{(item.ev * 100).toFixed(1)}%</div>
                          </div>
                        </div>
                      );
                    })}
                  </div>

                  <div className="mt-6 pt-6 border-t border-stone-100">
                    <div className="flex items-center justify-between mb-3">
                      <label className="text-sm text-stone-600">Risk Preference</label>
                      <span className="text-sm font-medium text-stone-700">{risk}</span>
                    </div>
                    <div className="flex items-center gap-4">
                      <span className="text-xs text-stone-400">ä¿å®ˆ</span>
                      <input type="range" min="0" max="100" value={risk} onChange={(e) => setRisk(Number(e.target.value))} className="flex-1" />
                      <span className="text-xs text-stone-400">æ¿€è¿›</span>
                    </div>
                  </div>

                  <div className="flex gap-3 mt-6">
                    <button className="flex-1 py-3 bg-gradient-to-r from-amber-400 to-orange-400 text-white rounded-xl text-sm font-medium shadow-lg shadow-orange-200/40 btn-hover">
                      ç”Ÿæˆæœ€ä¼˜ç»„åˆ
                    </button>
                    <button className="flex-1 py-3 border border-amber-300 text-amber-600 rounded-xl text-sm font-medium hover:bg-amber-50 btn-hover">
                      ç¡®è®¤æŠ•èµ„å·²å‹¾é€‰
                    </button>
                  </div>
                </div>
              </div>

              <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
                <div className="relative z-10">
                  <h3 className="font-medium text-stone-700 mb-4">æ¨èæ–¹æ¡ˆ</h3>

                  <div className="space-y-3">
                    {recos.map((item, i) => (
                      <div key={i} className={`p-4 rounded-xl border transition-all cursor-pointer lift-card ${i === 0 ? 'border-amber-200 bg-amber-50/40' : 'border-stone-100 bg-stone-50'}`}>
                        <div className="flex items-center justify-between mb-2">
                          <span className={`text-xs font-medium ${i === 0 ? 'text-amber-600' : 'text-stone-500'}`}>{item.tier}</span>
                          <span className="text-sm font-semibold text-stone-800">{item.allocation} rmb</span>
                        </div>
                        <p className="text-sm text-stone-700 mb-2">{item.combo}</p>
                        <div className="flex gap-4 text-xs text-stone-500">
                          <span>é¢„æœŸæ”¶ç›Š: <span className="font-medium text-stone-800">+{(item.ev * 100).toFixed(1)}%</span></span>
                          <span>Win Rate: <span className="font-medium text-stone-700">{(item.winRate * 100).toFixed(0)}%</span></span>
                          <span>Sharpe: <span className="font-medium text-stone-700">{item.sharpe.toFixed(2)}</span></span>
                        </div>
                      </div>
                    ))}
                  </div>

                  <div className="mt-4 p-4 rounded-xl bg-stone-50 border border-stone-100">
                    <div className="flex justify-between text-sm">
                      <span className="text-stone-500">æ€»æŠ•èµ„</span>
                      <span className="font-semibold text-stone-800">{totalAlloc} rmb</span>
                    </div>
                    <div className="flex justify-between text-sm mt-2">
                      <span className="text-stone-500">ç»„åˆé¢„æœŸæ”¶ç›Š</span>
                      <span className="font-medium text-stone-800">+11.2%</span>
                    </div>
                  </div>

                  <button className="w-full mt-4 py-3 border border-amber-300 text-amber-600 rounded-xl text-sm font-medium hover:bg-amber-50 btn-hover">
                    ä¸€é”®é‡‡çº³æ–¹æ¡ˆ
                  </button>
                </div>
              </div>
            </div>

            {/* Explanation below both cards */}
            <div className="mt-6 glow-card bg-white rounded-2xl border border-stone-100 p-6">
              <div className="relative z-10">
                <div className="flex items-center gap-2 mb-3">
                  <h3 className="font-medium text-stone-700">Portfolio Optimization Â· è®¡ç®—é€»è¾‘è¯´æ˜</h3>
                  <span className="text-[10px] px-2 py-0.5 bg-stone-100 text-stone-500 rounded">æ‘˜è¦</span>
                </div>
                <div className="text-sm text-stone-600 leading-relaxed space-y-2">
                  <p>è¿™é‡ŒæŠŠã€Œæ¯åœºæ¯”èµ›ã€è§†ä¸ºå¯æŠ•èµ„çš„èµ„äº§ï¼ŒæŠŠä½ çš„ <span className="font-medium">Conf</span>ã€èµ”ç‡ã€ä»¥åŠæ ¡å‡†ç³»æ•°è½¬æˆæ¯ä¸ªèµ„äº§çš„ <span className="font-medium">æœŸæœ›æ”¶ç›Šï¼ˆedgeï¼‰</span> ä¸ä¸ç¡®å®šæ€§ã€‚</p>
                  <ul className="list-disc pl-5 space-y-1 text-stone-600">
                    <li><span className="font-medium">æœŸæœ›æ”¶ç›Š</span>ï¼šç”± Confï¼ˆä¸»è§‚èƒœç‡ï¼‰Ã— Oddsï¼ˆèµ”ç‡ï¼‰æ¨å¾—åŸºç¡€ edgeï¼Œå¹¶ç”¨å†å²æ ¡å‡†ç³»æ•°ï¼ˆå¦‚ AJR æ ¡å‡† / REPï¼‰åšä¿®æ­£ã€‚</li>
                    <li><span className="font-medium">é£é™©åˆ»ç”»</span>ï¼šæŠŠ REPï¼ˆéšæœºäº‹ä»¶ï¼‰ä¸æ ·æœ¬é‡ç­‰ä¿¡æ¯æŠ˜ç®—ä¸ºæ–¹å·®æƒ©ç½šï¼›Risk Preference è¶Šæ¿€è¿›ï¼Œé£é™©æƒ©ç½šç³»æ•°è¶Šä½ã€‚</li>
                    <li><span className="font-medium">ç»„åˆçº¦æŸ</span>ï¼šåŒ…å«å•åœº/æ€»ä»“ä½ä¸Šé™ã€æœ€å°åˆ†é…ç²’åº¦ã€ä»¥åŠå¯¹æç«¯èµ”ç‡/æç«¯ Conf çš„è½¯é™åˆ¶ï¼Œé¿å…è¢«å¼‚å¸¸ç‚¹å¸¦åã€‚</li>
                    <li><span className="font-medium">è¾“å‡º</span>ï¼šç»™å‡ºå¤šæ¡£æ–¹æ¡ˆï¼ˆT1/T2/T3ï¼‰ï¼Œåœ¨ã€ŒæœŸæœ›æ”¶ç›Šã€ä¸ã€Œèƒœç‡ç¨³å®šæ€§ã€ä¹‹é—´åšä¸åŒå–èˆã€‚</li>
                  </ul>
                  <p className="text-xs text-stone-400 mt-2">æ³¨ï¼šæ­¤å¤„ä¸º UI åŸå‹è¯´æ˜æ–‡æœ¬ï¼Œåç»­å¯åœ¨å‚æ•°åå°ä¸­å¯¹å…¬å¼ç»†èŠ‚ä¸ç³»æ•°æ¥æºè¿›ä¸€æ­¥å±•å¼€ã€‚</p>
                </div>
              </div>
            </div>
          </div>
        );
      };

      // Params - Redesigned

      const ParamsPage = () => {
        const [showKellyModal, setShowKellyModal] = useState(false);
        
        const kellyModalContent = (
          <div>
            <p className="text-sm text-stone-500 mb-4">åŸºäºæ·±åº¦åˆ†æä¸­å„ Mode çš„å†å²è¡¨ç°ï¼ŒåŠ¨æ€è®¡ç®—å»ºè®® Kelly åˆ†æ¯</p>
            <table className="w-full text-sm">
              <thead><tr className="border-b border-stone-200 text-left text-stone-500">
                <th className="py-2 font-medium">Mode</th><th className="py-2 font-medium">æ ·æœ¬</th><th className="py-2 font-medium">ROI</th><th className="py-2 font-medium">å»ºè®® Kelly</th>
              </tr></thead>
              <tbody>
                {[
                  { mode: 'å¸¸è§„', samples: 45, roi: '+12.4%', kelly: '4.0' },
                  { mode: 'å¸¸è§„-ç¨³', samples: 18, roi: '+8.2%', kelly: '3.5' },
                  { mode: 'ä¿é™©äº§å“', samples: 15, roi: '+18.5%', kelly: '3.0' },
                  { mode: 'åŠå½©ç¥¨åŠä¿é™©', samples: 10, roi: '-5.2%', kelly: '5.0' },
                  { mode: 'èµŒä¸€æŠŠ', samples: 5, roi: '-32.0%', kelly: '6.0' },
                ].map((r, i) => (
                  <tr key={i} className="border-b border-stone-100">
                    <td className="py-2 font-medium text-stone-700">{r.mode}</td>
                    <td className="py-2 text-stone-500">{r.samples}</td>
                    <td className={`py-2 ${r.roi.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.roi}</td>
                    <td className="py-2 font-semibold text-amber-600">{r.kelly}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        );

        return (
          <div className="p-8 max-w-4xl">
            <div className="mb-6">
              <h2 className="text-2xl font-semibold text-stone-800 font-display">å‚æ•°åå°</h2>
              <p className="text-stone-400 text-sm mt-1">ç³»ç»Ÿæ ¸å¿ƒå‚æ•°ä¸æ ¡å‡†ç³»æ•°é…ç½®</p>
            </div>

            {/* Core Indicator - Hero Card */}
            <div className="glow-card bg-gradient-to-br from-amber-50 via-orange-50 to-rose-50 rounded-2xl p-6 border border-amber-200 mb-6">
              <div className="relative z-10">
                <div className="flex items-start justify-between">
                  <div>
                    <div className="flex items-center gap-2 mb-2">
                      <span className="text-amber-600 text-lg">â–</span>
                      <span className="text-xs text-amber-600 font-medium uppercase tracking-wide">Core Metric</span>
                    </div>
                    <h3 className="text-xl font-semibold text-stone-800">Expected vs Actual Judgmental Rating</h3>
                    <p className="text-sm text-stone-500 mt-1">è¡¡é‡é¢„æµ‹ç½®ä¿¡åº¦ä¸å®é™…ç»“æœçš„å»åˆç¨‹åº¦</p>
                  </div>
                  <div className="text-right">
                    <div className="text-4xl font-bold text-amber-600">0.92</div>
                    <p className="text-sm text-emerald-600 mt-1">â†‘ æ ¡å‡†è‰¯å¥½ Â· åå·® -8%</p>
                  </div>
                </div>
              </div>
            </div>

            {/* Two Column Layout */}
            <div className="grid grid-cols-2 gap-6 mb-6">
              {/* Left - Capital & Risk */}
              <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
                <div className="relative z-10">
                  <h3 className="font-medium text-stone-700 mb-4 flex items-center gap-2">
                    <span className="text-amber-500">â—</span> èµ„é‡‘ä¸é£æ§
                  </h3>
                  <div className="space-y-4">
                    <div className="flex items-center justify-between p-3 bg-stone-50 rounded-xl">
                      <div>
                        <span className="text-sm text-stone-700">åˆå§‹æœ¬é‡‘</span>
                        <p className="text-xs text-stone-400">åŸºå‡†èµ„é‡‘æ± </p>
                      </div>
                      <div className="flex items-center gap-2">
                        <span className="text-stone-400">Â¥</span>
                        <input type="number" defaultValue="600" className="input-glow w-20 px-2 py-1.5 text-right text-sm font-medium rounded-lg border border-stone-200 focus:outline-none focus:border-amber-400" />
                      </div>
                    </div>
                    <div className="flex items-center justify-between p-3 bg-stone-50 rounded-xl">
                      <div>
                        <span className="text-sm text-stone-700">é£æ§æ¯”ä¾‹ä¸Šé™</span>
                        <p className="text-xs text-stone-400">å•ç¬”æœ€å¤§æŠ•èµ„å æ¯”</p>
                      </div>
                      <div className="flex items-center gap-1">
                        <input type="number" defaultValue="12" className="input-glow w-16 px-2 py-1.5 text-right text-sm font-medium rounded-lg border border-stone-200 focus:outline-none focus:border-amber-400" />
                        <span className="text-stone-400">%</span>
                      </div>
                    </div>
                    <div className="flex items-center justify-between p-3 bg-stone-50 rounded-xl">
                      <div>
                        <span className="text-sm text-stone-700">é»˜è®¤èµ”ç‡</span>
                        <p className="text-xs text-stone-400">æœªå¡«å†™æ—¶çš„å‡è®¾å€¼</p>
                      </div>
                      <input type="number" step="0.1" defaultValue="2.5" className="input-glow w-20 px-2 py-1.5 text-right text-sm font-medium rounded-lg border border-stone-200 focus:outline-none focus:border-amber-400" />
                    </div>
                  </div>
                </div>
              </div>

              {/* Right - Kelly Settings */}
              <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
                <div className="relative z-10">
                  <h3 className="font-medium text-stone-700 mb-4 flex items-center gap-2">
                    <span className="text-amber-500">â—ˆ</span> Kelly å‚æ•°
                  </h3>
                  <div onClick={() => setShowKellyModal(true)} className="p-4 bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl border border-amber-200 cursor-pointer hover:shadow-md transition-all">
                    <div className="flex items-center justify-between mb-2">
                      <span className="text-sm text-stone-700">å¹³å‡ Kelly åˆ†æ¯</span>
                      <span className="text-2xl font-bold text-amber-600">3.8</span>
                    </div>
                    <p className="text-xs text-stone-500">åŸºäºå„ Mode å†å²è¡¨ç°åŠ æƒè®¡ç®—</p>
                    <p className="text-xs text-amber-600 mt-2">ç‚¹å‡»æŸ¥çœ‹å„ Mode å»ºè®® â†’</p>
                  </div>
                  <div className="mt-4 p-3 bg-stone-50 rounded-xl">
                    <div className="flex items-center justify-between">
                      <div>
                        <span className="text-sm text-stone-700">æ‰‹åŠ¨è¦†ç›–</span>
                        <p className="text-xs text-stone-400">å¼ºåˆ¶ä½¿ç”¨å›ºå®šåˆ†æ¯</p>
                      </div>
                      <div className="flex items-center gap-2">
                        <input type="checkbox" className="accent-amber-500" />
                        <input type="number" step="0.5" defaultValue="4" className="input-glow w-16 px-2 py-1.5 text-right text-sm rounded-lg border border-stone-200 focus:outline-none focus:border-amber-400" />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            {/* Calibration Factors */}
            <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
              <div className="relative z-10">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="font-medium text-stone-700 flex items-center gap-2">
                    <span className="text-amber-500">â—‡</span> åŠ¨æ€æ ¡å‡†ç³»æ•°
                  </h3>
                  <span className="text-xs text-stone-400 px-2 py-1 bg-stone-100 rounded">å›å½’åˆ†æè‡ªåŠ¨æ›´æ–° Â· åªè¯»</span>
                </div>
                <div className="grid grid-cols-6 gap-3">
                  {[
                    { label: 'Conf', value: '1.08', trend: 'â†‘' },
                    { label: 'Mode', value: '0.95', trend: 'â†’' },
                    { label: 'TYS', value: '1.02', trend: 'â†‘' },
                    { label: 'FID', value: '1.12', trend: 'â†‘' },
                    { label: 'Odds', value: '0.98', trend: 'â†“' },
                    { label: 'FSE', value: '1.05', trend: 'â†’' },
                  ].map((item, i) => (
                    <div key={i} className="p-3 bg-stone-50 rounded-xl text-center hover:bg-amber-50 transition-colors">
                      <span className="text-xs text-stone-400 block">{item.label}</span>
                      <span className="text-lg font-semibold text-stone-700">{item.value}</span>
                      <span className={`text-xs block ${item.trend === 'â†‘' ? 'text-emerald-500' : item.trend === 'â†“' ? 'text-rose-500' : 'text-stone-400'}`}>{item.trend}</span>
                    </div>
                  ))}
                </div>
                <p className="text-xs text-stone-400 mt-4 text-center">ç³»æ•°åŸºäºå†å²æ•°æ®æ¯å‘¨è‡ªåŠ¨å›å½’æ›´æ–°ï¼Œæ•°å€¼ &gt;1 è¡¨ç¤ºè¯¥å› å­æ­£å‘å½±å“é¢„æµ‹å‡†ç¡®åº¦</p>
              </div>
            </div>

            {showKellyModal && <Modal data={{ title: 'Kelly åˆ†æ¯ Â· å„ Mode å»ºè®®', content: kellyModalContent }} onClose={() => setShowKellyModal(false)} />}
          </div>
        );
      };

      const renderPage = () => {
        if (activeSubPage === 'analysis') return <AnalysisPage />;
        if (activeSubPage === 'metrics') return <MetricsPage />;
        if (activeSubPage === 'teams') return <TeamsPage />;
        switch(activePage) {
          case 'dashboard': return <DashboardPage />;
          case 'new': return <NewInvestmentPage />;
          case 'history': return <HistoryPage />;
          case 'settle': return <SettlePage />;
          case 'combo': return <ComboPage />;
          case 'params': return <ParamsPage />;
          default: return <NewInvestmentPage />;
        }
      };

      return (
        <div className="flex h-screen bg-stone-100/50">
          <Sidebar />
          <main className="flex-1 overflow-auto">{renderPage()}</main>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<DugouDesign />);
  </script>
</body>
</html>
