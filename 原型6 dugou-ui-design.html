<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DUGOU Model Centre v5.9 - Complete UI Design</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'DM Sans', sans-serif; }
    .font-display { font-family: 'Playfair Display', serif; }
    .glow-card { position: relative; background: white; border-radius: 1rem; transition: all 0.3s ease; }
    .glow-card:hover { box-shadow: 0 0 0 1px rgba(251, 191, 36, 0.3), 0 8px 30px -12px rgba(251, 191, 36, 0.2); }
    .lift-card { transition: transform 0.2s ease, box-shadow 0.2s ease; }
    .lift-card:hover { transform: translateY(-2px); box-shadow: 0 8px 30px -12px rgba(0, 0, 0, 0.12); }
    .btn-hover { transition: all 0.2s ease; }
    .btn-hover:hover { transform: scale(1.02); }
    .sidebar-item { transition: all 0.2s ease; }
    .sidebar-item:hover { transform: translateX(3px); }
    .input-glow:focus { box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.15); }
    input[type="range"] { -webkit-appearance: none; height: 6px; background: #e7e5e4; border-radius: 999px; }
    input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; background: linear-gradient(135deg, #fbbf24, #f97316); border-radius: 50%; cursor: pointer; box-shadow: 0 2px 8px rgba(251, 191, 36, 0.5); }
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #d6d3d1; border-radius: 4px; }
    .modal-overlay { animation: fadeIn 0.2s ease; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .modal-content { animation: slideUp 0.3s ease; }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    .animate-pulse { animation: pulse 2s infinite; }
    .stat-value { font-weight: 600; font-style: italic; }
    /* Updated checkbox - lighter, more transparent */
    .custom-checkbox { width: 18px; height: 18px; border: 1.5px solid #d6d3d1; border-radius: 6px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; background: white; }
    .custom-checkbox:hover { border-color: #fbbf24; }
    .custom-checkbox.checked { background: linear-gradient(135deg, rgba(254,243,199,0.6), rgba(254,215,170,0.6)); border-color: #fbbf24; box-shadow: 0 0 8px rgba(251, 191, 36, 0.2); }
    .custom-checkbox.checked::after { content: 'âœ“'; color: #d97706; font-size: 11px; font-weight: 600; }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect } = React;

    // Conf color based on value - exponential depth increase
    const getConfColor = (conf) => {
      const c = parseFloat(conf);
      // Exponential: higher conf = deeper color
      if (c >= 0.8) return 'text-blue-700';
      if (c >= 0.7) return 'text-blue-600';
      if (c >= 0.6) return 'text-blue-500';
      if (c >= 0.5) return 'text-sky-500';
      if (c >= 0.4) return 'text-sky-400';
      if (c >= 0.3) return 'text-sky-300';
      return 'text-sky-200';
    };

    const DugouDesign = () => {
      const [activePage, setActivePage] = useState('dashboard');
      const [activeSubPage, setActiveSubPage] = useState(null);
      const [sidebarCollapsed, setSidebarCollapsed] = useState(false);
      const [modalData, setModalData] = useState(null);
      const [showDataMenu, setShowDataMenu] = useState(false);

      // Modal Component
      const Modal = ({ data, onClose }) => (
        <div className="modal-overlay fixed inset-0 bg-black/40 flex items-center justify-center z-50" onClick={onClose}>
          <div className="modal-content bg-white rounded-2xl p-6 max-w-3xl w-full mx-4 shadow-2xl max-h-[85vh] overflow-auto" onClick={e => e.stopPropagation()}>
            <div className="flex items-center justify-between mb-4">
              <h3 className="font-semibold text-stone-800">{data.title}</h3>
              <button onClick={onClose} className="text-stone-400 hover:text-stone-600 text-xl leading-none">Ã—</button>
            </div>
            {data.content}
          </div>
        </div>
      );

      // Sidebar
      const Sidebar = () => (
        <div className={`h-screen bg-gradient-to-b from-stone-50 to-orange-50/30 border-r border-stone-200/60 flex flex-col transition-all duration-300 ${sidebarCollapsed ? 'w-16' : 'w-56'}`}>
          <div className="p-4 border-b border-stone-200/40">
            <div className="flex items-center gap-3">
              <div className="w-9 h-9 rounded-xl bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center shadow-lg shadow-orange-200/50">
                <span className="text-white font-bold text-sm">DG</span>
              </div>
              {!sidebarCollapsed && <div><h1 className="font-semibold text-stone-800 text-sm">DUGOU</h1><p className="text-[10px] text-stone-400">Model Centre v5.9</p></div>}
            </div>
          </div>
          <nav className="flex-1 p-3 space-y-1">
            {[
              { id: 'new', icon: 'â—ˆ', label: 'æ–°å»ºæŠ•èµ„' },
              { id: 'combo', icon: 'â–', label: 'æ™ºèƒ½ç»„åˆ' },
              { id: 'settle', icon: 'â—‰', label: 'å¾…ç»“ç®—', badge: '3', highlight: true },
              { id: 'dashboard', icon: 'â—', label: 'Dashboard', children: [
                { id: 'analysis', icon: 'â—‡', label: 'æ·±åº¦åˆ†æ' },
                { id: 'metrics', icon: 'â–¤', label: 'æ•°æ®æ€»è§ˆ' }
              ]},
              { id: 'history', icon: 'â˜°', label: 'å†å²è®°å½•', badge: '93', children: [
                { id: 'teams', icon: 'âš‘', label: 'çƒé˜Ÿæ¡£æ¡ˆé¦†' }
              ]},
              { id: 'params', icon: 'âš™', label: 'å‚æ•°åå°' },
            ].map(item => (
              <div key={item.id}>
                <button onClick={() => { setActivePage(item.id); setActiveSubPage(null); }}
                  className={`sidebar-item w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm transition-all ${activePage === item.id && !activeSubPage ? 'bg-white shadow-sm text-stone-800' : 'text-stone-500 hover:bg-white/60'}`}>
                  <span className={`text-base ${activePage === item.id && !activeSubPage ? 'text-amber-500' : 'text-stone-400'}`}>{item.icon}</span>
                  {!sidebarCollapsed && <><span className="flex-1 text-left">{item.label}</span>{item.badge && <span className={`text-xs ${item.highlight ? 'px-2 py-0.5 rounded-full bg-amber-100 text-amber-600 font-medium' : 'text-stone-400'}`}>{item.badge}</span>}</>}
                </button>
                {item.children && !sidebarCollapsed && (
                  <div className="ml-6 mt-1 space-y-1">
                    {item.children.map(child => (
                      <button key={child.id} onClick={() => { setActivePage(item.id); setActiveSubPage(child.id); }}
                        className={`sidebar-item w-full flex items-center gap-2 px-3 py-2 rounded-lg text-xs ${activeSubPage === child.id ? 'bg-amber-50 text-amber-700' : 'text-stone-400 hover:bg-white/60'}`}>
                        <span className="text-sm">{child.icon}</span><span>{child.label}</span>
                      </button>
                    ))}
                  </div>
                )}
              </div>
            ))}
          </nav>
          <div className="p-3 border-t border-stone-200/40">
            {!sidebarCollapsed && (
              <div className="mb-2">
                <button onClick={() => setShowDataMenu(!showDataMenu)} className="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 hover:bg-white/60 text-sm">
                  <span>â‡„</span><span>æ•°æ®ç®¡ç†</span><span className="ml-auto text-xs">{showDataMenu ? 'â–²' : 'â–¼'}</span>
                </button>
                {showDataMenu && (
                  <div className="mt-1 space-y-1">
                    <button className="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 hover:text-amber-600 hover:bg-amber-50 text-xs"><span>â†“</span> å¯¼å…¥ Excel</button>
                    <button className="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 hover:text-amber-600 hover:bg-amber-50 text-xs"><span>â†‘</span> å¯¼å‡ºå¤‡ä»½</button>
                  </div>
                )}
              </div>
            )}
            <button onClick={() => setSidebarCollapsed(!sidebarCollapsed)} className="w-full flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-stone-400 hover:text-stone-600 text-xs">
              {sidebarCollapsed ? 'â†’' : 'â† æ”¶èµ·'}
            </button>
          </div>
        </div>
      );

      // ========== DASHBOARD ==========
      const DashboardPage = () => {
        const [chartType, setChartType] = useState('funds');
        const [showChartMenu, setShowChartMenu] = useState(false);
        const [timePeriod, setTimePeriod] = useState('2W');
        const [showTimePicker, setShowTimePicker] = useState(false);
        const chartLabels = { funds: 'èµ„é‡‘èµ°åŠ¿', conf: 'Conf ç›¸å…³æ€§', rating: 'Conf vs AJR' };
        const periodLabels = { 
          '2W': { label: 'è¿‘ä¸¤å‘¨', investments: 12, compare: '+3.1%', hitCompare: '+2.8%' }, 
          '1M': { label: 'æœ¬æœˆ', investments: 23, compare: '+5.2%', hitCompare: '+1.5%' }, 
          '3M': { label: 'è¿‘ä¸‰æœˆ', investments: 68, compare: '+8.4%', hitCompare: '+3.2%' }, 
          '1Y': { label: 'æœ¬å¹´åº¦', investments: 93, compare: '+12.1%', hitCompare: '+4.5%' } 
        };

        const openMetricDetail = (type) => {
          const contents = {
            balance: { title: 'è“„æ°´æ± ä½™é¢ Â· å†å²æ˜ç»†', content: (
              <div>
                <table className="w-full text-sm mb-4">
                  <thead><tr className="border-b border-stone-200 text-left text-stone-500"><th className="py-2">æ—¥æœŸ</th><th className="py-2">æ¯”èµ›</th><th className="py-2">æ“ä½œå‰</th><th className="py-2">ç›ˆäº</th><th className="py-2">æ“ä½œå</th></tr></thead>
                  <tbody>
                    {[{ date: '02-02', match: 'é˜¿æ£®çº³ vs åˆ‡å°”è¥¿', before: 'Â¥2,667', change: '-', after: 'Â¥2,667' },{ date: '02-01', match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', before: 'Â¥2,447', change: '+Â¥220', after: 'Â¥2,667' },{ date: '01-31', match: 'çƒ­åˆº vs æ›¼è”', before: 'Â¥2,597', change: '-Â¥150', after: 'Â¥2,447' }].map((r, i) => (
                      <tr key={i} className="border-b border-stone-100"><td className="py-2 text-stone-600">{r.date}</td><td className="py-2 text-stone-700">{r.match}</td><td className="py-2">{r.before}</td><td className={`py-2 font-medium ${r.change.includes('+') ? 'text-emerald-600' : r.change === '-' ? 'text-stone-400' : 'text-rose-500'}`}>{r.change}</td><td className="py-2 font-medium">{r.after}</td></tr>
                    ))}
                  </tbody>
                </table>
                <div className="flex justify-center gap-2"><button className="px-3 py-1 text-xs bg-amber-100 text-amber-700 rounded">1</button><button className="px-3 py-1 text-xs text-stone-400 hover:bg-stone-100 rounded">2</button><button className="px-3 py-1 text-xs text-stone-400 hover:bg-stone-100 rounded">3</button><span className="text-stone-300">...</span><button className="px-3 py-1 text-xs text-stone-400 hover:bg-stone-100 rounded">12</button></div>
              </div>
            )},
            roi: { title: 'è¿‘æœŸ ROI Â· è¯¦ç»†åˆ†è§£', content: (
              <div className="space-y-4">
                <div className="grid grid-cols-3 gap-4 text-center">
                  <div className="p-3 bg-stone-50 rounded-xl"><span className="text-xs text-stone-400 block">æ€»æŠ•èµ„</span><span className="text-lg font-semibold">Â¥1,850</span></div>
                  <div className="p-3 bg-emerald-50 rounded-xl"><span className="text-xs text-stone-400 block">æ€»æ”¶ç›Š</span><span className="text-lg font-semibold text-emerald-600">Â¥2,080</span></div>
                  <div className="p-3 bg-amber-50 rounded-xl"><span className="text-xs text-stone-400 block">ROI</span><span className="text-lg font-semibold text-amber-600">+12.4%</span></div>
                </div>
                <div className="border-t pt-4"><h4 className="text-sm font-medium text-stone-700 mb-3">è¿‘æœŸæŠ•èµ„æ˜ç»†</h4>
                  <div className="space-y-2">{[{ match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', entry: 'å¤§2.5', result: 'âœ“', roi: '+85%' },{ match: 'çƒ­åˆº vs æ›¼è”', entry: 'å¹³å±€', result: 'âœ—', roi: '-100%' }].map((r, i) => (
                    <div key={i} className="flex items-center justify-between p-2 bg-stone-50 rounded-lg">
                      <div className="flex items-center gap-3"><span className={`w-5 h-5 rounded-full flex items-center justify-center text-xs ${r.result === 'âœ“' ? 'bg-emerald-100 text-emerald-600' : 'bg-rose-100 text-rose-500'}`}>{r.result}</span><div><p className="text-sm">{r.match}</p><p className="text-xs text-stone-400">{r.entry}</p></div></div>
                      <span className={`text-sm font-medium ${r.roi.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.roi}</span>
                    </div>
                  ))}</div>
                </div>
              </div>
            )},
            confRating: { title: 'Conf. vs Actual Judgmental Rating Â· å†å²è®°å½•', content: (
              <table className="w-full text-sm">
                <thead><tr className="border-b border-stone-200 text-left text-stone-500"><th className="py-2">æ—¥æœŸ</th><th className="py-2">æ¯”èµ›</th><th className="py-2">Conf.</th><th className="py-2">AJR</th><th className="py-2">åå·®</th></tr></thead>
                <tbody>
                  {[{ date: '02-01', match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', conf: '0.72', ajr: '0.75', diff: '+0.03' },{ date: '01-31', match: 'çƒ­åˆº vs æ›¼è”', conf: '0.42', ajr: '0.38', diff: '-0.04' },{ date: '01-30', match: 'çº½å¡ vs ç»´æ‹‰', conf: '0.55', ajr: '0.58', diff: '+0.03' }].map((r, i) => (
                    <tr key={i} className="border-b border-stone-100"><td className="py-2 text-stone-600">{r.date}</td><td className="py-2">{r.match}</td><td className="py-2">{r.conf}</td><td className="py-2">{r.ajr}</td><td className={`py-2 font-medium ${r.diff.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.diff}</td></tr>
                  ))}
                </tbody>
              </table>
            )},
            hitrate: { title: 'å‘½ä¸­ç‡ Â· åˆ†ç»´åº¦ç»Ÿè®¡', content: (
              <div className="space-y-3">{[{ label: 'æ€»ä½“', value: '67.3%', samples: 93 },{ label: 'Single Match', value: '71.2%', samples: 52 },{ label: 'Conf â‰¥ 0.4', value: '72.8%', samples: 68 },{ label: 'Conf â‰¥ 0.6', value: '78.4%', samples: 38 }].map((r, i) => (
                <div key={i} className="flex items-center justify-between p-3 bg-stone-50 rounded-xl"><span>{r.label}</span><div className="flex items-center gap-4"><span className="text-xs text-stone-400">{r.samples} samples</span><span className="font-semibold">{r.value}</span></div></div>
              ))}</div>
            )},
            noise: { title: 'å™ªéŸ³è¿‡æ»¤ Beta Â· è¯¦ç»†åˆ†æ', content: (
              <div className="space-y-4">
                <p className="text-sm text-stone-500">é€šè¿‡ REP æ–¹å‘æ€§åŠ æƒï¼Œè¿‡æ»¤è¿æ°”æˆåˆ†ï¼Œè¿˜åŸçœŸå®åˆ¤æ–­èƒ½åŠ›</p>
                <div className="grid grid-cols-3 gap-4 text-center">
                  <div className="p-4 bg-stone-50 rounded-xl"><span className="text-xs text-stone-400 block">åŸå§‹ ROI</span><span className="text-xl font-semibold">+12.4%</span></div>
                  <div className="p-4 bg-emerald-50 rounded-xl"><span className="text-xs text-stone-400 block">è¿‡æ»¤å ROI</span><span className="text-xl font-semibold text-emerald-600">+15.8%</span></div>
                  <div className="p-4 bg-rose-50 rounded-xl"><span className="text-xs text-stone-400 block">è¿æ°”æˆåˆ†</span><span className="text-xl font-semibold text-rose-500">-3.4%</span></div>
                </div>
                <div className="p-4 bg-amber-50 rounded-xl border border-amber-200"><p className="text-sm text-amber-700">âœ“ ä½ çš„å®é™…åˆ¤æ–­èƒ½åŠ›ä¼˜äºè´¦é¢è¡¨ç°ï¼Œè¿‘æœŸè¿æ°”ç•¥å·®ä½†åŸºæœ¬åŠŸæ‰å®</p></div>
                <div className="border-t pt-4"><h4 className="text-sm font-medium mb-3">è¿æ°”æˆåˆ†æ‹†è§£</h4>
                  <div className="space-y-2 text-sm">
                    <div className="flex justify-between"><span className="text-stone-500">æ­£ç¡®é¢„æµ‹ä½†æœªä¸­ï¼ˆREPé«˜ï¼‰</span><span className="text-rose-500">-5.2%</span></div>
                    <div className="flex justify-between"><span className="text-stone-500">é”™è¯¯é¢„æµ‹ä½†å‘½ä¸­ï¼ˆREPä½ï¼‰</span><span className="text-emerald-600">+1.8%</span></div>
                  </div>
                </div>
              </div>
            )},
            conf: { title: 'Conf æ ¡å‡†æ›²çº¿ Â· è¯¦ç»†æ•°æ®', content: (
              <table className="w-full text-sm">
                <thead><tr className="border-b border-stone-200 text-left text-stone-500"><th className="py-2">Conf åŒºé—´</th><th className="py-2">é¢„æœŸ</th><th className="py-2">å®é™…</th><th className="py-2">åå·®</th><th className="py-2">æ ·æœ¬</th></tr></thead>
                <tbody>
                  {[{ conf: '0.8+', exp: '0.80', act: '0.76', diff: '-0.04', samples: 8 },{ conf: '0.7~0.8', exp: '0.75', act: '0.72', diff: '-0.03', samples: 15 },{ conf: '0.6~0.7', exp: '0.65', act: '0.67', diff: '+0.02', samples: 22 },{ conf: '0.5~0.6', exp: '0.55', act: '0.52', diff: '-0.03', samples: 28 },{ conf: '0.4~0.5', exp: '0.45', act: '0.48', diff: '+0.03', samples: 15 },{ conf: '<0.4', exp: '0.30', act: '0.34', diff: '+0.04', samples: 5 }].map((r, i) => (
                    <tr key={i} className="border-b border-stone-100"><td className="py-2 font-medium">{r.conf}</td><td className="py-2">{r.exp}</td><td className="py-2">{r.act}</td><td className={`py-2 font-medium ${r.diff.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.diff}</td><td className="py-2 text-stone-400">{r.samples}</td></tr>
                  ))}
                </tbody>
              </table>
            )},
            advantage: { title: 'ä¼˜åŠ¿é¢†åŸŸè¯†åˆ« Â· å†å²è¡¨ç°', content: (
              <div className="space-y-4">
                {[{ combo: 'Conf 0.6+ Ã— å¸¸è§„æ¨¡å¼ Ã— è‹±è¶…', roi: '+23.4%', matches: [{ match: 'é˜¿æ£®çº³ vs åˆ‡å°”è¥¿', result: 'âœ“', pnl: '+Â¥185' },{ match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', result: 'âœ“', pnl: '+Â¥220' }]},{ combo: 'TYS-M Ã— FID 0.5+ Ã— Single', roi: '+18.7%', matches: [{ match: 'çƒ­åˆº vs å¸ƒè±é¡¿', result: 'âœ“', pnl: '+Â¥150' }]}].map((item, i) => (
                  <div key={i} className="p-4 bg-stone-50 rounded-xl">
                    <div className="flex items-center justify-between mb-3"><span className="font-medium">{item.combo}</span><span className="text-emerald-600 font-semibold">{item.roi}</span></div>
                    <div className="space-y-1">{item.matches.map((m, j) => (<div key={j} className="flex items-center justify-between text-sm p-2 bg-white rounded"><div className="flex items-center gap-2"><span className={`text-xs ${m.result === 'âœ“' ? 'text-emerald-600' : 'text-rose-500'}`}>{m.result}</span><span>{m.match}</span></div><span className={m.pnl.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}>{m.pnl}</span></div>))}</div>
                  </div>
                ))}
              </div>
            )}
          };
          setModalData(contents[type]);
        };

        return (
          <div className="p-8 space-y-5">
            {/* Compact Alert */}
            <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl px-4 py-2 border border-amber-200 flex items-center gap-3">
              <div className="w-6 h-6 rounded-lg bg-amber-100 flex items-center justify-center flex-shrink-0"><span className="text-amber-600 text-xs">âš¡</span></div>
              <div className="flex-1 flex items-center gap-2 text-xs">
                <span className="font-medium text-stone-700">æ™ºèƒ½æé†’</span>
                <span className="px-1.5 py-0.5 bg-amber-200 text-amber-700 rounded text-[10px]">è¿ç»­æ€§è¯†åˆ«</span>
                <span className="text-stone-600">è¿‘5åœº<span className="text-emerald-600 font-medium">è¿ç»­å‘½ä¸­</span>ï¼Œå»ºè®®é€‚åº¦å¢åŠ ä»“ä½</span>
              </div>
              <button className="text-[10px] text-stone-400 hover:text-stone-600">å¿½ç•¥</button>
            </div>

            {/* Header with Fixed Time Picker */}
            <div className="flex items-center justify-between">
              <div>
                <h2 className="text-2xl font-semibold text-stone-800 font-display">Dashboard</h2>
                <div className="flex items-center gap-2 mt-1">
                  <div className="relative z-30">
                    <button onClick={() => setShowTimePicker(!showTimePicker)} className="text-stone-500 text-sm hover:text-amber-600 flex items-center gap-1 bg-white px-3 py-1.5 rounded-lg border border-stone-200 shadow-sm">
                      {periodLabels[timePeriod].label} <span className="text-xs ml-1">â–¼</span>
                    </button>
                    {showTimePicker && (
                      <div className="absolute top-full left-0 mt-1 bg-white rounded-lg shadow-xl border border-stone-200 py-1 z-50 min-w-28">
                        {Object.entries(periodLabels).map(([key, val]) => (
                          <button key={key} onClick={() => { setTimePeriod(key); setShowTimePicker(false); }}
                            className={`block w-full px-4 py-2 text-left text-sm ${timePeriod === key ? 'bg-amber-50 text-amber-700' : 'text-stone-600 hover:bg-stone-50'}`}>
                            {val.label}
                          </button>
                        ))}
                      </div>
                    )}
                  </div>
                  <span className="text-stone-400 text-sm">Â· æŠ•èµ„ {periodLabels[timePeriod].investments} ç¬”</span>
                </div>
              </div>
              <div className="flex items-center gap-3">
                <button className="px-4 py-2 text-sm text-stone-600 hover:text-stone-800 btn-hover">å¯¼å‡ºæŠ¥å‘Š</button>
                <button onClick={() => setActivePage('new')} className="px-5 py-2.5 bg-gradient-to-r from-amber-400 to-orange-400 text-white rounded-xl text-sm font-medium shadow-lg shadow-orange-200/40 btn-hover">+ æ–°å»ºæŠ•èµ„</button>
              </div>
            </div>

            {/* Metrics Row - 5 cards */}
            <div className="grid grid-cols-5 gap-4">
              {/* Momentum */}
              <div className="glow-card bg-gradient-to-br from-emerald-50 to-teal-50 rounded-2xl p-4 border border-emerald-200">
                <div className="flex items-center justify-between mb-1"><span className="text-emerald-600 text-xs font-medium">åŠ¨é‡çŠ¶æ€</span><div className="w-2 h-2 rounded-full bg-emerald-400 animate-pulse"></div></div>
                <div className="text-xl font-bold text-emerald-600">â†‘ ä¸Šå‡æœŸ</div>
                <p className="text-[10px] text-stone-500">è¿‘6åœºROI +18%</p>
                <p className="text-[10px] text-emerald-600 mt-1">å»ºè®®ä»“ä½ Ã—1.15</p>
              </div>
              {/* Balance */}
              <div onClick={() => openMetricDetail('balance')} className="glow-card bg-white rounded-2xl p-4 border border-stone-100 cursor-pointer">
                <div className="flex items-center justify-between mb-2"><span className="text-stone-400 text-xs">è“„æ°´æ± ä½™é¢</span><span className="text-amber-400">â—</span></div>
                <div className="text-xl font-semibold text-stone-800">Â¥2,847</div>
                <div className="text-xs text-emerald-500">+18.2%</div>
              </div>
              {/* ROI */}
              <div onClick={() => openMetricDetail('roi')} className="glow-card bg-white rounded-2xl p-4 border border-stone-100 cursor-pointer">
                <div className="flex items-center justify-between mb-2"><span className="text-stone-400 text-xs">{periodLabels[timePeriod].label} ROI</span><span className="text-amber-400">â—ˆ</span></div>
                <div className="text-xl font-semibold text-stone-800">+12.4%</div>
                <div className="text-xs text-emerald-500">åŒæ¯” {periodLabels[timePeriod].compare}</div>
              </div>
              {/* Hit Rate - Fixed spacing */}
              <div onClick={() => openMetricDetail('hitrate')} className="glow-card bg-white rounded-2xl p-4 border border-stone-100 cursor-pointer">
                <div className="flex items-center justify-between mb-2"><span className="text-stone-400 text-xs">å‘½ä¸­ç‡</span><span className="text-amber-400">â—‰</span></div>
                <div className="text-xl font-semibold text-stone-800">67.3%</div>
                <div className="flex items-center justify-between">
                  <span className="text-xs text-emerald-500">åŒæ¯” {periodLabels[timePeriod].hitCompare}</span>
                  <span className="text-[10px] text-stone-400">Confâ‰¥0.4: 52/68</span>
                </div>
              </div>
              {/* Conf vs AJR - Changed from Expected vs Actual */}
              <div onClick={() => openMetricDetail('confRating')} className="glow-card bg-white rounded-2xl p-4 border border-stone-100 cursor-pointer">
                <div className="flex items-center justify-between mb-2"><span className="text-stone-400 text-xs">Conf. vs AJR</span><span className="text-amber-400">â–</span></div>
                <div className="text-xl font-semibold text-stone-800">0.95</div>
                <div className="text-xs text-emerald-500">æ ¡å‡†è‰¯å¥½</div>
              </div>
            </div>

            {/* Charts Row */}
            <div className="grid grid-cols-3 gap-4">
              {/* Main Chart */}
              <div className="col-span-2 glow-card bg-white rounded-2xl p-6 border border-stone-100">
                <div className="flex items-center justify-between mb-6">
                  <div className="relative">
                    <button onClick={() => setShowChartMenu(!showChartMenu)} className="font-medium text-stone-700 flex items-center gap-2 hover:text-amber-600">
                      {chartLabels[chartType]} <span className="text-xs text-stone-400">â–¼</span>
                    </button>
                    {showChartMenu && (
                      <div className="absolute top-full left-0 mt-1 bg-white rounded-lg shadow-lg border border-stone-200 py-1 z-20 min-w-32">
                        {Object.entries(chartLabels).map(([key, label]) => (
                          <button key={key} onClick={() => { setChartType(key); setShowChartMenu(false); }}
                            className={`block w-full px-3 py-2 text-left text-sm ${chartType === key ? 'bg-amber-50 text-amber-700' : 'text-stone-600 hover:bg-stone-50'}`}>{label}</button>
                        ))}
                      </div>
                    )}
                  </div>
                  <div className="flex gap-2">
                    {['7D', '1M', '3M', 'ALL'].map(period => (
                      <button key={period} className={`px-3 py-1 text-xs rounded-lg transition-all ${period === '1M' ? 'bg-amber-100 text-amber-700' : 'text-stone-400 hover:bg-stone-50'}`}>{period}</button>
                    ))}
                  </div>
                </div>
                {chartType === 'funds' ? (
                  <div className="h-48 flex items-end gap-1 px-4">
                    {[40, 45, 42, 55, 48, 62, 58, 70, 65, 75, 72, 85, 80, 88, 92].map((h, i) => (
                      <div key={i} className="flex-1 rounded-t-sm bg-gradient-to-t from-amber-400 to-orange-300 opacity-80 hover:opacity-100 transition-opacity cursor-pointer chart-bar" style={{ height: `${h}%` }} />
                    ))}
                  </div>
                ) : (
                  <div className="h-48 relative">
                    <svg className="w-full h-full" viewBox="0 0 400 150">
                      <polyline fill="none" stroke="url(#lineGradient)" strokeWidth="2" points="20,120 60,100 100,110 140,80 180,90 220,60 260,70 300,40 340,50 380,30" />
                      {[20, 60, 100, 140, 180, 220, 260, 300, 340, 380].map((x, i) => (
                        <circle key={i} cx={x} cy={[120, 100, 110, 80, 90, 60, 70, 40, 50, 30][i]} r="4" fill="#f59e0b" />
                      ))}
                      <defs><linearGradient id="lineGradient" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stopColor="#fbbf24" /><stop offset="100%" stopColor="#f97316" /></linearGradient></defs>
                    </svg>
                  </div>
                )}
                <div className="flex justify-between mt-4 px-4 text-xs text-stone-400"><span>1æœˆ18æ—¥</span><span>1æœˆ25æ—¥</span><span>2æœˆ1æ—¥</span></div>
              </div>

              {/* Conf Calibration Curve - Clickable */}
              <div onClick={() => openMetricDetail('conf')} className="glow-card bg-white rounded-2xl p-6 border border-stone-100 cursor-pointer">
                <h3 className="font-medium text-stone-700 mb-4">Conf æ ¡å‡†æ›²çº¿ <span className="text-xs text-stone-400 font-normal">ç‚¹å‡»è¯¦æƒ…</span></h3>
                <div className="space-y-2">
                  {[{ conf: '0.8+', expected: '80%', actual: '76%' },{ conf: '0.7~0.8', expected: '75%', actual: '72%' },{ conf: '0.6~0.7', expected: '65%', actual: '67%' },{ conf: '0.5~0.6', expected: '55%', actual: '52%' },{ conf: '0.4~0.5', expected: '45%', actual: '48%' },{ conf: '<0.4', expected: '30%', actual: '34%' }].map((row, i) => (
                    <div key={i} className="flex items-center gap-2">
                      <span className="text-[10px] text-stone-500 w-12">{row.conf}</span>
                      <div className="flex-1 h-1.5 bg-stone-100 rounded-full overflow-hidden">
                        <div className="h-full bg-gradient-to-r from-amber-300 to-orange-400 rounded-full" style={{ width: row.actual }} />
                      </div>
                      <span className="text-[10px] text-stone-600 w-8">{row.actual}</span>
                    </div>
                  ))}
                </div>
                <p className="text-xs text-stone-400 mt-3 text-center">æ•´ä½“æ ¡å‡†åå·®: -2.3%</p>
              </div>
            </div>

            {/* Bottom Row */}
            <div className="grid grid-cols-3 gap-4">
              {/* Noise Filter - Restored content */}
              <div onClick={() => openMetricDetail('noise')} className="glow-card bg-white rounded-2xl p-5 border border-stone-100 cursor-pointer">
                <div className="flex items-center justify-between mb-3">
                  <h3 className="font-medium text-stone-700">å™ªéŸ³è¿‡æ»¤</h3>
                  <span className="text-[10px] px-2 py-0.5 bg-violet-100 text-violet-600 rounded-full font-medium">Beta</span>
                </div>
                <div className="grid grid-cols-3 gap-2 text-center text-sm">
                  <div className="p-2 bg-stone-50 rounded-lg"><span className="text-[10px] text-stone-400 block">åŸå§‹</span><span className="font-semibold">+12.4%</span></div>
                  <div className="p-2 bg-emerald-50 rounded-lg"><span className="text-[10px] text-stone-400 block">è¿‡æ»¤å</span><span className="font-semibold text-emerald-600">+15.8%</span></div>
                  <div className="p-2 bg-rose-50 rounded-lg"><span className="text-[10px] text-stone-400 block">è¿æ°”</span><span className="font-semibold text-rose-500">-3.4%</span></div>
                </div>
                <p className="text-xs text-stone-400 mt-3">é€šè¿‡ REP åŠ æƒè¿‡æ»¤éšæœºå› ç´ </p>
              </div>

              {/* Advantage Domain - Clickable */}
              <div onClick={() => openMetricDetail('advantage')} className="glow-card bg-white rounded-2xl p-5 border border-stone-100 cursor-pointer">
                <h3 className="font-medium text-stone-700 mb-3">ä¼˜åŠ¿é¢†åŸŸè¯†åˆ« <span className="text-xs text-stone-400 font-normal">ç‚¹å‡»è¯¦æƒ…</span></h3>
                <div className="space-y-2">
                  {[{ combo: 'Conf 0.6+ Ã— å¸¸è§„ Ã— è‹±è¶…', roi: '+23.4%' },{ combo: 'TYS-M Ã— FID 0.5+ Ã— Single', roi: '+18.7%' }].map((item, i) => (
                    <div key={i} className="flex items-center justify-between p-2 rounded-lg bg-stone-50">
                      <span className="text-xs text-stone-600">{item.combo}</span>
                      <span className="text-xs font-semibold text-emerald-600">{item.roi}</span>
                    </div>
                  ))}
                </div>
              </div>

              {/* Recent Investments */}
              <div className="glow-card bg-white rounded-2xl p-5 border border-stone-100">
                <div className="flex items-center justify-between mb-3">
                  <h3 className="font-medium text-stone-700">è¿‘æœŸæŠ•èµ„</h3>
                  <button onClick={() => setActivePage('history')} className="text-xs text-amber-500 hover:text-amber-600">æŸ¥çœ‹å…¨éƒ¨ â†’</button>
                </div>
                <div className="space-y-2">
                  {[{ match: 'é˜¿æ£®çº³ vs åˆ‡å°”è¥¿', entries: 'ä¸»èƒœ', status: 'pending', amount: '180 rmb' },{ match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', entries: 'å¤§2.5', status: 'win', amount: '+220 rmb' },{ match: 'çƒ­åˆº vs æ›¼è”', entries: 'å¹³å±€', status: 'lose', amount: '-150 rmb' }].map((item, i) => (
                    <div key={i} className="flex items-center justify-between p-2 rounded-lg hover:bg-stone-50 cursor-pointer">
                      <div className="flex items-center gap-2">
                        <div className={`w-2 h-2 rounded-full ${item.status === 'pending' ? 'bg-amber-400' : item.status === 'win' ? 'bg-emerald-400' : 'bg-rose-400'}`} />
                        <div><p className="text-sm text-stone-700">{item.match}</p><p className="text-xs text-stone-400">{item.entries}</p></div>
                      </div>
                      <span className={`text-sm font-medium ${item.status === 'win' ? 'text-emerald-600' : item.status === 'lose' ? 'text-rose-500' : 'text-stone-600'}`}>{item.amount}</span>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {modalData && <Modal data={modalData} onClose={() => setModalData(null)} />}
          </div>
        );
      };

      // ========== METRICS SUB-TAB ==========
      const MetricsPage = () => (
        <div className="p-8">
          <div className="mb-6">
            <h2 className="text-2xl font-semibold text-stone-800 font-display">æ•°æ®æ€»è§ˆ</h2>
            <p className="text-stone-400 text-sm mt-1">å„ç»´åº¦å‚æ•°çš„ç»Ÿè®¡æ±‡æ€»ä¸ç›¸å…³æ€§åˆ†æ</p>
          </div>
          
          <div className="grid grid-cols-2 gap-6">
            {/* ROI by Mode */}
            <div className="glow-card bg-white rounded-2xl p-5 border border-stone-100">
              <h3 className="font-medium text-stone-700 mb-3">ROI by Mode</h3>
              <table className="w-full text-xs">
                <thead><tr className="border-b border-stone-200 text-left text-stone-500"><th className="py-2">Mode</th><th className="py-2">æ ·æœ¬</th><th className="py-2">æ€»æŠ•å…¥</th><th className="py-2">ROI</th><th className="py-2">å‘½ä¸­ç‡</th><th className="py-2">Avg AJR-Conf</th></tr></thead>
                <tbody>
                  {[{ mode: 'å¸¸è§„', samples: 45, input: 'Â¥4,520', roi: '+12.4%', hit: '68%', diff: '+0.03' },{ mode: 'å¸¸è§„-ç¨³', samples: 18, input: 'Â¥1,980', roi: '+8.2%', hit: '75%', diff: '+0.05' },{ mode: 'ä¿é™©äº§å“', samples: 15, input: 'Â¥1,650', roi: '+18.5%', hit: '82%', diff: '+0.08' },{ mode: 'åŠå½©ç¥¨åŠä¿é™©', samples: 10, input: 'Â¥880', roi: '-5.2%', hit: '45%', diff: '-0.12' },{ mode: 'èµŒä¸€æŠŠ', samples: 5, input: 'Â¥320', roi: '-32.0%', hit: '20%', diff: '-0.25' }].map((r, i) => (
                    <tr key={i} className="border-b border-stone-100"><td className="py-1.5 font-medium">{r.mode}</td><td className="py-1.5">{r.samples}</td><td className="py-1.5">{r.input}</td><td className={`py-1.5 font-medium ${r.roi.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.roi}</td><td className="py-1.5">{r.hit}</td><td className={`py-1.5 ${r.diff.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.diff}</td></tr>
                  ))}
                </tbody>
              </table>
            </div>

            {/* ROI by Conf */}
            <div className="glow-card bg-white rounded-2xl p-5 border border-stone-100">
              <h3 className="font-medium text-stone-700 mb-3">ROI by Conf Range</h3>
              <table className="w-full text-xs">
                <thead><tr className="border-b border-stone-200 text-left text-stone-500"><th className="py-2">Conf</th><th className="py-2">æ ·æœ¬</th><th className="py-2">æ€»æŠ•å…¥</th><th className="py-2">ROI</th><th className="py-2">Avg AJR-Conf</th></tr></thead>
                <tbody>
                  {[{ conf: '0.8+', samples: 8, input: 'Â¥960', roi: '+28.4%', diff: '-0.04' },{ conf: '0.7~0.8', samples: 15, input: 'Â¥1,650', roi: '+18.2%', diff: '-0.03' },{ conf: '0.6~0.7', samples: 22, input: 'Â¥2,420', roi: '+12.1%', diff: '+0.02' },{ conf: '0.5~0.6', samples: 28, input: 'Â¥2,800', roi: '+5.8%', diff: '-0.03' },{ conf: '0.4~0.5', samples: 15, input: 'Â¥1,200', roi: '-8.2%', diff: '+0.03' }].map((r, i) => (
                    <tr key={i} className="border-b border-stone-100"><td className="py-1.5 font-medium">{r.conf}</td><td className="py-1.5">{r.samples}</td><td className="py-1.5">{r.input}</td><td className={`py-1.5 font-medium ${r.roi.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.roi}</td><td className={`py-1.5 ${r.diff.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.diff}</td></tr>
                  ))}
                </tbody>
              </table>
            </div>

            {/* Correlation Coefficients */}
            <div className="glow-card bg-white rounded-2xl p-5 border border-stone-100">
              <h3 className="font-medium text-stone-700 mb-3">å‚æ•°ç›¸å…³æ€§ç³»æ•°</h3>
              <table className="w-full text-xs">
                <thead><tr className="border-b border-stone-200 text-left text-stone-500"><th className="py-2">å‚æ•°å¯¹</th><th className="py-2">Pearson r</th><th className="py-2">æ˜¾è‘—æ€§</th><th className="py-2">å…³ç³»</th></tr></thead>
                <tbody>
                  {[{ pair: 'Conf â†” Hit Rate', r: '0.72', sig: 'p<0.01 **', rel: 'å¼ºæ­£ç›¸å…³' },{ pair: 'FID â†” AJR-Conf', r: '0.45', sig: 'p<0.05 *', rel: 'ä¸­ç­‰æ­£ç›¸å…³' },{ pair: 'FSE â†” ROI', r: '0.38', sig: 'p<0.05 *', rel: 'ä¸­ç­‰æ­£ç›¸å…³' },{ pair: 'Odds â†” Hit Rate', r: '-0.61', sig: 'p<0.01 **', rel: 'å¼ºè´Ÿç›¸å…³' },{ pair: 'TYS â†” ROI', r: '0.22', sig: 'n.s.', rel: 'å¼±ç›¸å…³' }].map((r, i) => (
                    <tr key={i} className="border-b border-stone-100"><td className="py-1.5">{r.pair}</td><td className="py-1.5 font-medium">{r.r}</td><td className="py-1.5 text-stone-400">{r.sig}</td><td className="py-1.5 text-stone-500">{r.rel}</td></tr>
                  ))}
                </tbody>
              </table>
            </div>

            {/* Summary Stats */}
            <div className="glow-card bg-white rounded-2xl p-5 border border-stone-100">
              <h3 className="font-medium text-stone-700 mb-3">æ±‡æ€»ç»Ÿè®¡</h3>
              <div className="grid grid-cols-2 gap-2 text-xs">
                {[{ label: 'æ€»æ ·æœ¬é‡', value: '93' },{ label: 'æ€»æŠ•å…¥', value: 'Â¥9,350' },{ label: 'æ€»æ”¶ç›Š', value: 'Â¥10,512' },{ label: 'å‡€åˆ©æ¶¦', value: '+Â¥1,162' },{ label: 'å¹³å‡ Odds', value: '2.34' },{ label: 'å¹³å‡ Conf', value: '0.58' },{ label: 'æœ€å¤§è¿èƒœ', value: '7' },{ label: 'æœ€å¤§è¿è´¥', value: '4' },{ label: 'Single Match å æ¯”', value: '56%' },{ label: 'Combo å æ¯”', value: '44%' }].map((item, i) => (
                  <div key={i} className="flex justify-between p-2 bg-stone-50 rounded-lg"><span className="text-stone-500">{item.label}</span><span className="font-medium">{item.value}</span></div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );

      // ========== DEEP ANALYSIS ==========
      const AnalysisPage = () => {
        const [analysisTab, setAnalysisTab] = useState('parlay');
        const totalSamples = 93;
        const n = Math.floor(totalSamples / 50);
        
        const openConfDetail = (range) => {
          setModalData({
            title: `Conf ${range} Â· å†å²æ•°æ®`,
            content: (
              <table className="w-full text-sm">
                <thead><tr className="border-b border-stone-200 text-left text-stone-500"><th className="py-2">æ—¥æœŸ</th><th className="py-2">æ¯”èµ›</th><th className="py-2">Conf</th><th className="py-2">AJR</th><th className="py-2">ç»“æœ</th><th className="py-2">ç›ˆäº</th></tr></thead>
                <tbody>
                  {[{ date: '02-01', match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', conf: '0.72', ajr: '0.75', result: 'âœ“', pnl: '+Â¥170' },{ date: '01-28', match: 'é˜¿æ£®çº³ vs å¸ƒè±é¡¿', conf: '0.68', ajr: '0.70', result: 'âœ“', pnl: '+Â¥145' },{ date: '01-25', match: 'åˆ‡å°”è¥¿ vs ç‹¼é˜Ÿ', conf: '0.65', ajr: '0.62', result: 'âœ—', pnl: '-Â¥120' }].map((r, i) => (
                    <tr key={i} className="border-b border-stone-100"><td className="py-2">{r.date}</td><td className="py-2">{r.match}</td><td className="py-2">{r.conf}</td><td className="py-2">{r.ajr}</td><td className={r.result === 'âœ“' ? 'text-emerald-600' : 'text-rose-500'}>{r.result}</td><td className={r.pnl.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}>{r.pnl}</td></tr>
                  ))}
                </tbody>
              </table>
            )
          });
        };
        
        return (
          <div className="p-8">
            <div className="mb-6">
              <h2 className="text-2xl font-semibold text-stone-800 font-display">æ·±åº¦åˆ†æ</h2>
              <p className="text-stone-400 text-sm mt-1">å¤šç»´åº¦å†å²è¡¨ç°åˆ†æä¸ç­–ç•¥ä¼˜åŒ–</p>
            </div>

            <div className="flex gap-2 mb-6">
              {[{ id: 'parlay', label: 'ç»„åˆç­–ç•¥åˆ†æ' },{ id: 'mode', label: 'Mode è¡¨ç°åˆ†æ' },{ id: 'conf', label: 'Conf åŒºé—´åˆ†æ' },{ id: 'time', label: 'æ—¶é—´è¿‘å› æƒé‡' }].map(tab => (
                <button key={tab.id} onClick={() => setAnalysisTab(tab.id)} className={`px-4 py-2 rounded-xl text-sm btn-hover ${analysisTab === tab.id ? 'bg-amber-100 text-amber-700 font-medium' : 'bg-stone-100 text-stone-500'}`}>{tab.label}</button>
              ))}
            </div>

            {analysisTab === 'parlay' && (
              <div className="grid grid-cols-2 gap-6">
                <div className="glow-card bg-white rounded-2xl p-6 border border-stone-100">
                  <h3 className="font-medium text-stone-700 mb-4">ä¸åŒç»„åˆç­–ç•¥è¡¨ç°</h3>
                  <div className="space-y-3">
                    {[{ parlay: 'Single Match', samples: 52, roi: '+15.2%', hitrate: '71%', partial: null, best: true },
                      { parlay: 'Double Matches Combo', samples: 28, roi: '+8.4%', hitrate: '54%', partial: '2/2ä¸­: 15/28, 1/2ä¸­: 18/28' },
                      { parlay: 'Triple Matches Combo', samples: 10, roi: '-12.3%', hitrate: '30%', partial: '3/3ä¸­: 3/10, 2/3ä¸­: 6/10' },
                      { parlay: 'Quad Matches Combo', samples: 3, roi: '-45.0%', hitrate: '0%', partial: '4/4ä¸­: 0/3, 3/4ä¸­: 2/3' }
                    ].map((item, i) => (
                      <div key={i} className={`p-4 rounded-xl border ${item.best ? 'border-emerald-200 bg-emerald-50/50' : 'border-stone-100 bg-stone-50'}`}>
                        <div className="flex items-center justify-between">
                          <div className="flex items-center gap-2">
                            <span className="font-medium text-stone-700">{item.parlay}</span>
                            {item.best && <span className="text-[10px] px-2 py-0.5 bg-emerald-200 text-emerald-700 rounded-full">æœ€ä¼˜</span>}
                          </div>
                          <span className={`font-semibold ${item.roi.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{item.roi}</span>
                        </div>
                        <div className="flex gap-4 mt-2 text-xs text-stone-500">
                          <span>{item.samples} æ ·æœ¬</span>
                          <span>å‘½ä¸­ç‡ {item.hitrate}</span>
                        </div>
                        {item.partial && <p className="text-xs text-stone-400 mt-1">{item.partial}</p>}
                      </div>
                    ))}
                  </div>
                </div>
                <div className="glow-card bg-white rounded-2xl p-6 border border-stone-100">
                  <h3 className="font-medium text-stone-700 mb-4">æœ€ä¼˜ç»„åˆå‘ç°</h3>
                  <div className="space-y-3">
                    {[{ combo: 'Single + å¸¸è§„æ¨¡å¼ + Conf 0.6+', roi: '+28.4%', samples: 24 },{ combo: 'Single + ä¿é™©äº§å“ + Conf 0.7+', roi: '+22.1%', samples: 12 }].map((item, i) => (
                      <div key={i} className="p-4 rounded-xl bg-stone-50 hover:bg-amber-50 transition-all cursor-pointer lift-card">
                        <div className="flex items-center justify-between mb-1"><span className="text-sm font-medium">{item.combo}</span><span className="font-semibold text-emerald-600">{item.roi}</span></div>
                        <span className="text-xs text-stone-400">{item.samples} æ ·æœ¬</span>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            )}

            {analysisTab === 'mode' && (
              <div className="glow-card bg-white rounded-2xl p-6 border border-stone-100">
                <h3 className="font-medium text-stone-700 mb-4">å„ Mode å†å²è¡¨ç°</h3>
                <table className="w-full text-sm">
                  <thead><tr className="border-b border-stone-200 text-left text-stone-500"><th className="py-2">Mode</th><th className="py-2">æ ·æœ¬</th><th className="py-2">ROI</th><th className="py-2">å‘½ä¸­ç‡</th><th className="py-2">Avg(AJR-Conf)</th><th className="py-2">Avg Odds</th><th className="py-2">å»ºè®® Kelly</th></tr></thead>
                  <tbody>
                    {[{ mode: 'å¸¸è§„', samples: 45, roi: '+12.4%', hit: '68%', diff: '+0.03', odds: '2.1', kelly: '4.0' },{ mode: 'å¸¸è§„-ç¨³', samples: 18, roi: '+8.2%', hit: '75%', diff: '+0.05', odds: '1.7', kelly: '3.5' },{ mode: 'ä¿é™©äº§å“', samples: 15, roi: '+18.5%', hit: '82%', diff: '+0.08', odds: '1.5', kelly: '3.0' },{ mode: 'åŠå½©ç¥¨åŠä¿é™©', samples: 10, roi: '-5.2%', hit: '45%', diff: '-0.12', odds: '2.8', kelly: '5.0' },{ mode: 'èµŒä¸€æŠŠ', samples: 5, roi: '-32.0%', hit: '20%', diff: '-0.25', odds: '4.2', kelly: '6.0' }].map((r, i) => (
                      <tr key={i} className="border-b border-stone-100"><td className="py-3 font-medium">{r.mode}</td><td className="py-3">{r.samples}</td><td className={`py-3 font-medium ${r.roi.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.roi}</td><td className="py-3">{r.hit}</td><td className={`py-3 ${r.diff.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.diff}</td><td className="py-3">{r.odds}</td><td className="py-3 text-amber-600 font-medium">{r.kelly}</td></tr>
                    ))}
                  </tbody>
                </table>
                <p className="text-xs text-stone-400 mt-4">ğŸ’¡ æ­¤è¡¨ Kelly å»ºè®®å·²åŒæ­¥è‡³å‚æ•°åå°</p>
              </div>
            )}

            {analysisTab === 'conf' && (
              <div className="glow-card bg-white rounded-2xl p-6 border border-stone-100">
                <h3 className="font-medium text-stone-700 mb-4">Conf åŒºé—´åˆ†æ <span className="text-xs text-stone-400 font-normal">ï¼ˆç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…å†å²æ•°æ®ï¼‰</span></h3>
                <div className="grid grid-cols-5 gap-4">
                  {[{ range: '0.8+', expected: '0.80', actual: '0.76', diff: '-0.04', samples: 8 },{ range: '0.7~0.8', expected: '0.75', actual: '0.72', diff: '-0.03', samples: 15 },{ range: '0.6~0.7', expected: '0.65', actual: '0.67', diff: '+0.02', samples: 22 },{ range: '0.5~0.6', expected: '0.55', actual: '0.52', diff: '-0.03', samples: 28 },{ range: '0.4~0.5', expected: '0.45', actual: '0.48', diff: '+0.03', samples: 15 }].map((item, i) => (
                    <div key={i} onClick={() => openConfDetail(item.range)} className="p-4 rounded-xl bg-stone-50 text-center cursor-pointer hover:bg-amber-50 transition-all lift-card">
                      <span className="text-lg font-semibold text-stone-700">{item.range}</span>
                      <div className="mt-3 space-y-1 text-sm">
                        <div className="flex justify-between"><span className="text-stone-400">é¢„æœŸ</span><span>{item.expected}</span></div>
                        <div className="flex justify-between"><span className="text-stone-400">å®é™…</span><span>{item.actual}</span></div>
                        <div className="flex justify-between"><span className="text-stone-400">åå·®</span><span className={item.diff.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}>{item.diff}</span></div>
                      </div>
                      <p className="text-xs text-stone-400 mt-2">{item.samples} æ ·æœ¬</p>
                    </div>
                  ))}
                </div>
              </div>
            )}

            {analysisTab === 'time' && (
              <div className="glow-card bg-white rounded-2xl p-6 border border-stone-100">
                <div className="flex items-center gap-2 mb-4">
                  <h3 className="font-medium text-stone-700">æ—¶é—´è¿‘å› æœºåˆ¶</h3>
                  <span className="text-[10px] px-2 py-0.5 bg-stone-100 text-stone-500 rounded">S10</span>
                </div>
                <p className="text-sm text-stone-500 mb-2">n = floor(æ€»æ ·æœ¬é‡/50) = floor({totalSamples}/50) = <span className="font-semibold text-amber-600">{n}</span></p>
                <p className="text-sm text-stone-500 mb-6">Confã€FSE ç­‰å‚æ•°åº”ç”¨æ—¶é—´è¡°å‡æƒé‡ï¼Œè¿‘æœŸè¡¨ç°å½±å“æ›´å¤§</p>
                <div className="grid grid-cols-3 gap-6">
                  {[{ period: `æœ€è¿‘ ${6*n} åœº`, weight: '1.4Ã—', color: 'amber' },{ period: `ç¬¬ ${7*n}~${11*n} åœº`, weight: '1.15Ã—', color: 'stone' },{ period: `ç¬¬ ${12*n}+ åœº`, weight: '1.0Ã—', color: 'stone' }].map((item, i) => (
                    <div key={i} className={`p-6 rounded-xl text-center ${item.color === 'amber' ? 'bg-amber-50 border border-amber-200' : 'bg-stone-50'}`}>
                      <span className={`text-3xl font-bold ${item.color === 'amber' ? 'text-amber-600' : 'text-stone-400'}`}>{item.weight}</span>
                      <p className="text-sm text-stone-600 mt-2">{item.period}</p>
                    </div>
                  ))}
                </div>
              </div>
            )}
            
            {modalData && <Modal data={modalData} onClose={() => setModalData(null)} />}
          </div>
        );
      };

      // ========== NEW INVESTMENT ==========
      const NewInvestmentPage = () => {
        const [parlaySize, setParlaySize] = useState(1);
        const [matches, setMatches] = useState([{
          homeTeam: '', awayTeam: '', homeInfo: null, awayInfo: null,
          entries: [{ name: '', odds: '' }],
          conf: 65, mode: 'å¸¸è§„',
          tys_home: 'M', tys_away: 'L', fid: '0.4',
          fse_home: 70, fse_away: 55,
          note: ''
        }]);

        const teamData = {
          'ARS': { name: 'é˜¿æ£®çº³', samples: 18, rep: 0.42 },
          'CHE': { name: 'åˆ‡å°”è¥¿', samples: 15, rep: 0.38 },
          'LIV': { name: 'åˆ©ç‰©æµ¦', samples: 22, rep: 0.45 },
          'MCI': { name: 'æ›¼åŸ', samples: 20, rep: 0.52 },
          'TOT': { name: 'çƒ­åˆº', samples: 12, rep: 0.35 },
          'MUN': { name: 'æ›¼è”', samples: 16, rep: 0.40 },
        };

        const handleParlayChange = (size) => {
          setParlaySize(size);
          const newMatches = [...matches];
          while (newMatches.length < size) newMatches.push({ homeTeam: '', awayTeam: '', homeInfo: null, awayInfo: null, entries: [{ name: '', odds: '' }], conf: 50, mode: 'å¸¸è§„', tys_home: 'M', tys_away: 'M', fid: '0.4', fse_home: 50, fse_away: 50, note: '' });
          newMatches.splice(size);
          setMatches(newMatches);
        };

        const updateMatch = (idx, field, value) => {
          const newMatches = [...matches];
          newMatches[idx][field] = value;
          if (field === 'homeTeam') newMatches[idx].homeInfo = teamData[value.toUpperCase()] || null;
          if (field === 'awayTeam') newMatches[idx].awayInfo = teamData[value.toUpperCase()] || null;
          setMatches(newMatches);
        };

        const addEntry = (idx) => { const newMatches = [...matches]; newMatches[idx].entries.push({ name: '', odds: '' }); setMatches(newMatches); };
        const updateEntry = (midx, eidx, field, value) => { const newMatches = [...matches]; newMatches[midx].entries[eidx][field] = value; setMatches(newMatches); };
        const removeEntry = (midx, eidx) => { const newMatches = [...matches]; if (newMatches[midx].entries.length > 1) { newMatches[midx].entries.splice(eidx, 1); setMatches(newMatches); } };

        const calcHarmonicMean = (entries) => {
          const valid = entries.filter(e => e.odds && parseFloat(e.odds) > 0).map(e => parseFloat(e.odds));
          if (valid.length <= 1) return null;
          return (valid.length / valid.reduce((acc, o) => acc + (1 / o), 0)).toFixed(2);
        };

        return (
          <div className="p-8 max-w-5xl">
            <div className="mb-6">
              <h2 className="text-2xl font-semibold text-stone-800 font-display">æ–°å»ºæŠ•èµ„</h2>
              <p className="text-stone-400 text-sm mt-1">å½•å…¥æ¯”èµ›ä¿¡æ¯ä¸é¢„æµ‹å‚æ•°</p>
            </div>

            <div className="glow-card bg-white rounded-2xl border border-stone-100 shadow-sm overflow-hidden">
              {/* Parlay Selector */}
              <div className="px-6 py-4 border-b border-stone-100 bg-stone-50/50">
                <div className="flex items-center gap-4">
                  <span className="text-sm text-stone-600">ç»„åˆæ•°</span>
                  <div className="flex gap-2">
                    {[1, 2, 3, 4, 5].map(n => (
                      <button key={n} onClick={() => handleParlayChange(n)} className={`w-10 h-10 rounded-xl text-sm font-medium btn-hover ${n === parlaySize ? 'bg-gradient-to-br from-amber-400 to-orange-400 text-white shadow-lg' : 'bg-white border border-stone-200 text-stone-500'}`}>{n}</button>
                    ))}
                  </div>
                  <span className="text-xs text-stone-400">ï¼ˆ{parlaySize === 1 ? 'Single Match' : `${parlaySize} Matches Combo`}ï¼‰</span>
                </div>
              </div>

              {/* Match Cards */}
              <div className="p-6 space-y-6">
                {matches.map((match, idx) => (
                  <div key={idx} className={`${idx > 0 ? 'pt-6 border-t border-stone-200' : ''}`}>
                    <div className="flex items-center gap-3 mb-4">
                      <div className="w-6 h-6 rounded-lg bg-amber-100 flex items-center justify-center"><span className="text-amber-600 text-xs font-bold">{idx + 1}</span></div>
                      <span className="text-sm font-medium text-stone-700">{parlaySize > 1 ? `ç¬¬ ${idx + 1} å…³` : 'æ¯”èµ›ä¿¡æ¯'}</span>
                    </div>

                    {/* Teams - with inline info display */}
                    <div className="grid grid-cols-11 gap-3 items-start mb-4">
                      <div className="col-span-5">
                        <label className="text-xs text-stone-400 mb-1.5 block">ä¸»é˜Ÿ</label>
                        <div className="relative">
                          <input type="text" placeholder="è¾“å…¥çƒé˜Ÿåæˆ–ç¼©å†™..." value={match.homeTeam} onChange={(e) => updateMatch(idx, 'homeTeam', e.target.value)}
                            className="input-glow w-full px-4 py-3 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400" />
                          {match.homeInfo && (
                            <div className="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-stone-400">
                              {match.homeInfo.name} Â· {match.homeInfo.samples}åœº Â· REP {match.homeInfo.rep}
                            </div>
                          )}
                        </div>
                      </div>
                      <div className="col-span-1 text-center text-stone-300 text-lg pt-8">vs</div>
                      <div className="col-span-5">
                        <label className="text-xs text-stone-400 mb-1.5 block">å®¢é˜Ÿ</label>
                        <div className="relative">
                          <input type="text" placeholder="è¾“å…¥çƒé˜Ÿåæˆ–ç¼©å†™..." value={match.awayTeam} onChange={(e) => updateMatch(idx, 'awayTeam', e.target.value)}
                            className="input-glow w-full px-4 py-3 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400" />
                          {match.awayInfo && (
                            <div className="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-stone-400">
                              {match.awayInfo.name} Â· {match.awayInfo.samples}åœº Â· REP {match.awayInfo.rep}
                            </div>
                          )}
                        </div>
                      </div>
                    </div>

                    {/* Entries - Compact layout */}
                    <div className="mb-4">
                      <div className="flex items-center gap-4 mb-2">
                        <label className="text-xs text-stone-400">Entries é¢„æµ‹ç»“æœ</label>
                        <button onClick={() => addEntry(idx)} className="text-xs text-amber-500 hover:text-amber-600">+ æ·»åŠ  Entry</button>
                      </div>
                      <div className="flex flex-wrap gap-2">
                        {match.entries.map((entry, eIdx) => (
                          <div key={eIdx} className="flex items-center gap-1">
                            <input type="text" placeholder="ä¸»èƒœ / å¹³ / å¤§2.5..." value={entry.name} onChange={(e) => updateEntry(idx, eIdx, 'name', e.target.value)}
                              className="input-glow w-28 px-3 py-2 rounded-lg border border-stone-200 text-sm focus:outline-none focus:border-amber-400" />
                            <input type="number" step="0.01" placeholder="Odds" value={entry.odds} onChange={(e) => updateEntry(idx, eIdx, 'odds', e.target.value)}
                              className="input-glow w-16 px-2 py-2 rounded-lg border border-stone-200 text-sm focus:outline-none focus:border-amber-400" />
                            {match.entries.length > 1 && <button onClick={() => removeEntry(idx, eIdx)} className="text-stone-400 hover:text-rose-500 text-sm">Ã—</button>}
                          </div>
                        ))}
                      </div>
                      {match.entries.length > 1 && calcHarmonicMean(match.entries) && (
                        <p className="text-xs text-stone-500 mt-2">Overall Oddsï¼ˆè°ƒå’Œå¹³å‡ï¼‰: <span className="font-semibold text-amber-600">{calcHarmonicMean(match.entries)}</span></p>
                      )}
                    </div>

                    {/* Mode + Conf - with quick select */}
                    <div className="grid grid-cols-3 gap-4 mb-4">
                      <div>
                        <label className="text-xs text-stone-400 mb-1.5 block">Mode æ¨¡å¼</label>
                        <select value={match.mode} onChange={(e) => updateMatch(idx, 'mode', e.target.value)}
                          className="input-glow w-full px-3 py-3 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400 bg-white">
                          <option>å¸¸è§„</option><option>å¸¸è§„-ç¨³</option><option>å¸¸è§„-æ æ†</option><option>åŠå½©ç¥¨åŠä¿é™©</option><option>ä¿é™©äº§å“</option><option>èµŒä¸€æŠŠ</option>
                        </select>
                      </div>
                      <div className="col-span-2">
                        <label className="text-xs text-stone-400 mb-1.5 block">Conf. ä¸»è§‚ç½®ä¿¡åº¦</label>
                        <div className="flex items-center gap-3">
                          <input type="range" min="0" max="100" value={match.conf} onChange={(e) => updateMatch(idx, 'conf', e.target.value)} className="flex-1" />
                          <span className={`text-sm font-medium w-10 ${getConfColor(match.conf / 100)}`}>{(match.conf / 100).toFixed(2)}</span>
                        </div>
                        <div className="flex gap-2 mt-2">
                          {[0.2, 0.4, 0.6, 0.8].map(v => (
                            <button key={v} onClick={() => updateMatch(idx, 'conf', v * 100)} className={`px-3 py-1 text-xs rounded-lg btn-hover ${match.conf == v * 100 ? 'bg-amber-100 text-amber-700 border border-amber-200' : 'bg-stone-100 text-stone-500 hover:bg-stone-200'}`}>{v}</button>
                          ))}
                        </div>
                      </div>
                    </div>

                    {/* Calibration Params - Default Open */}
                    <details className="group" open>
                      <summary className="flex items-center gap-2 cursor-pointer text-sm text-stone-500 hover:text-stone-700 mb-3">
                        <span className="text-xs group-open:rotate-90 transition-transform">â–¶</span>
                        <span>æ ¡å‡†å‚æ•°ï¼ˆTYS / FID / FSEï¼‰</span>
                      </summary>
                      <div className="pl-4 border-l-2 border-amber-100">
                        <div className="grid grid-cols-4 gap-4 mb-3">
                          <div>
                            <label className="text-xs text-stone-400 mb-1.5 block">TYS-base (ä¸»)</label>
                            <div className="flex gap-1">{['S', 'M', 'L', 'H'].map(v => (<button key={v} onClick={() => updateMatch(idx, 'tys_home', v)} className={`flex-1 py-2 rounded-lg text-xs font-medium btn-hover ${v === match.tys_home ? 'bg-amber-100 text-amber-700 border border-amber-200' : 'bg-stone-50 text-stone-500 border border-stone-100'}`}>{v}</button>))}</div>
                          </div>
                          <div>
                            <label className="text-xs text-stone-400 mb-1.5 block">TYS-base (å®¢)</label>
                            <div className="flex gap-1">{['S', 'M', 'L', 'H'].map(v => (<button key={v} onClick={() => updateMatch(idx, 'tys_away', v)} className={`flex-1 py-2 rounded-lg text-xs font-medium btn-hover ${v === match.tys_away ? 'bg-amber-100 text-amber-700 border border-amber-200' : 'bg-stone-50 text-stone-500 border border-stone-100'}`}>{v}</button>))}</div>
                          </div>
                          <div className="col-span-2">
                            <label className="text-xs text-stone-400 mb-1.5 block">FID ä¿¡æ¯æ·±åº¦</label>
                            <div className="flex gap-1">{['0', '0.25', '0.4', '0.6', '0.75'].map(v => (<button key={v} onClick={() => updateMatch(idx, 'fid', v)} className={`flex-1 py-2 rounded-lg text-xs font-medium btn-hover ${v === match.fid ? 'bg-amber-100 text-amber-700 border border-amber-200' : 'bg-stone-50 text-stone-500 border border-stone-100'}`}>{v}</button>))}</div>
                          </div>
                        </div>
                        <div className="grid grid-cols-2 gap-4">
                          <div>
                            <label className="text-xs text-stone-400 mb-1.5 block">FSE (ä¸») Feature Sensor Beta</label>
                            <div className="flex items-center gap-2">
                              <input type="range" min="0" max="100" value={match.fse_home} onChange={(e) => updateMatch(idx, 'fse_home', e.target.value)} className="flex-1" />
                              <span className="text-sm font-medium text-stone-600 w-10">{(match.fse_home / 100).toFixed(2)}</span>
                            </div>
                            <div className="flex gap-1 mt-1">{[0.25, 0.5, 0.75].map(v => (<button key={v} onClick={() => updateMatch(idx, 'fse_home', v * 100)} className={`px-2 py-0.5 text-[10px] rounded btn-hover ${match.fse_home == v * 100 ? 'bg-amber-100 text-amber-700' : 'bg-stone-100 text-stone-400'}`}>{v}</button>))}</div>
                          </div>
                          <div>
                            <label className="text-xs text-stone-400 mb-1.5 block">FSE (å®¢) Feature Sensor Beta</label>
                            <div className="flex items-center gap-2">
                              <input type="range" min="0" max="100" value={match.fse_away} onChange={(e) => updateMatch(idx, 'fse_away', e.target.value)} className="flex-1" />
                              <span className="text-sm font-medium text-stone-600 w-10">{(match.fse_away / 100).toFixed(2)}</span>
                            </div>
                            <div className="flex gap-1 mt-1">{[0.25, 0.5, 0.75].map(v => (<button key={v} onClick={() => updateMatch(idx, 'fse_away', v * 100)} className={`px-2 py-0.5 text-[10px] rounded btn-hover ${match.fse_away == v * 100 ? 'bg-amber-100 text-amber-700' : 'bg-stone-100 text-stone-400'}`}>{v}</button>))}</div>
                          </div>
                        </div>
                      </div>
                    </details>

                    <div className="mt-4">
                      <label className="text-xs text-stone-400 mb-1.5 block">èµ›å‰å¤‡æ³¨</label>
                      <input type="text" placeholder="é€‰å¡«ï¼Œè®°å½•é¢„åˆ¤ä¾æ®..." value={match.note} onChange={(e) => updateMatch(idx, 'note', e.target.value)}
                        className="input-glow w-full px-4 py-2.5 rounded-xl border border-stone-200 text-sm focus:outline-none focus:border-amber-400" />
                    </div>
                  </div>
                ))}
              </div>

              {/* Result Panel */}
              <div className="px-6 py-5 bg-gradient-to-r from-stone-50 to-orange-50/30 border-t border-stone-100">
                <div className="flex items-center justify-between">
                  <div className="flex items-center gap-6">
                    <div><span className="text-xs text-stone-400 block">ç»¼åˆ Odds</span><span className="text-xl font-semibold text-stone-800">{parlaySize > 1 ? '4.32' : '2.15'}</span></div>
                    <div className="w-px h-10 bg-stone-200" />
                    <div><span className="text-xs text-stone-400 block">Expected Rating</span><span className="text-xl font-semibold text-stone-800">0.62</span></div>
                    <div className="w-px h-10 bg-stone-200" />
                    <div><span className="text-xs text-stone-400 block">Recom. Invest</span><span className="text-xl font-semibold text-amber-600">{parlaySize > 1 ? '85' : '185'} rmb</span></div>
                    <div className="w-px h-10 bg-stone-200" />
                    <div><span className="text-xs text-stone-400 block">é£æ§ä¸Šé™</span><span className="text-sm text-stone-500">341 rmb (12%)</span></div>
                  </div>
                  <div className="flex items-center gap-3">
                    <div>
                      <label className="text-xs text-stone-400 mb-1 block">Inputs å®é™…æŠ•èµ„</label>
                      <input type="number" defaultValue={parlaySize > 1 ? 80 : 180} className="input-glow w-28 px-3 py-2 rounded-xl border border-stone-200 text-sm font-medium focus:outline-none focus:border-amber-400" />
                    </div>
                    <div className="flex flex-col gap-2">
                      <button className="px-5 py-2.5 bg-gradient-to-r from-amber-400 to-orange-400 text-white rounded-xl text-sm font-medium shadow-lg shadow-orange-200/40 btn-hover">ç¡®è®¤æŠ•èµ„</button>
                      <button onClick={() => setActivePage('combo')} className="px-5 py-2 border border-stone-300 text-stone-600 rounded-xl text-xs font-medium hover:bg-stone-50 hover:border-amber-300 btn-hover">+ åŠ å…¥ä»Šæ—¥å¤‡é€‰</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      };

      // ========== HISTORY ==========
      const HistoryPage = () => (
        <div className="p-8">
          <div className="flex items-center justify-between mb-6">
            <div><h2 className="text-2xl font-semibold text-stone-800 font-display">å†å²è®°å½•</h2><p className="text-stone-400 text-sm mt-1">å…± 93 æ¡æŠ•èµ„è®°å½•</p></div>
            <div className="flex items-center gap-3">
              <input type="text" placeholder="æœç´¢çƒé˜Ÿã€æ—¥æœŸ..." className="input-glow px-4 py-2 rounded-xl border border-stone-200 text-sm w-64 focus:outline-none focus:border-amber-400" />
              <button className="px-4 py-2 rounded-xl border border-stone-200 text-sm text-stone-600 hover:bg-stone-50">ç­›é€‰</button>
            </div>
          </div>

          <div className="flex gap-2 mb-4">
            {['å…¨éƒ¨', 'å¾…ç»“ç®—', 'å·²ä¸­', 'æœªä¸­', 'Single', 'Combo'].map((tag, i) => (
              <button key={tag} className={`px-4 py-1.5 rounded-full text-sm btn-hover ${i === 0 ? 'bg-amber-100 text-amber-700' : 'bg-stone-100 text-stone-500 hover:bg-stone-200'}`}>{tag}</button>
            ))}
          </div>

          <div className="glow-card bg-white rounded-2xl border border-stone-100 overflow-hidden">
            <div className="overflow-x-auto">
              <table className="w-full">
                <thead>
                  <tr className="bg-stone-50 text-[11px] text-stone-500">
                    <th className="px-2 py-3 text-left font-medium">æ—¥æœŸ</th>
                    <th className="px-2 py-3 text-left font-medium">æ¯”èµ›</th>
                    <th className="px-2 py-3 text-left font-medium">Entries</th>
                    <th className="px-2 py-3 text-left font-medium">Results</th>
                    <th className="px-2 py-3 text-left font-medium">Odds</th>
                    <th className="px-2 py-3 text-left font-medium">Conf</th>
                    <th className="px-2 py-3 text-left font-medium">AJR</th>
                    <th className="px-2 py-3 text-left font-medium">Inputs</th>
                    <th className="px-2 py-3 text-left font-medium">çŠ¶æ€</th>
                    <th className="px-2 py-3 text-left font-medium">ç›ˆäº</th>
                    <th className="px-2 py-3 text-left font-medium">èµ›å‰å¤‡æ³¨</th>
                    <th className="px-2 py-3 text-left font-medium">èµ›åå¤‡æ³¨</th>
                  </tr>
                </thead>
                <tbody>
                  {[
                    { date: '02-02', match: 'é˜¿æ£®çº³ vs åˆ‡å°”è¥¿', entries: 'ä¸»èƒœ', results: '-', odds: 2.15, conf: 0.65, ajr: '-', inputs: 180, status: 'pending', profit: '-', preNote: 'ä¸»åœºå¼ºåŠ¿', postNote: '-' },
                    { date: '02-01', match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', entries: 'å¤§2.5', results: '3-2', odds: 1.85, conf: 0.72, ajr: 0.75, inputs: 200, status: 'win', profit: '+170', preNote: 'è¿›æ”»ç«åŠ›å¼º', postNote: 'é¢„åˆ¤å‡†ç¡®' },
                    { date: '01-31', match: 'çƒ­åˆº vs æ›¼è”', entries: 'å¹³å±€', results: '2-1', odds: 3.40, conf: 0.42, ajr: 0.38, inputs: 120, status: 'lose', profit: '-120', preNote: 'çŠ¶æ€ä¸€èˆ¬', postNote: 'çƒ­åˆºæ„å¤–çˆ†å‘' },
                    { date: '01-30', match: 'çº½å¡ vs ç»´æ‹‰', entries: 'å®¢èƒœ', results: '1-2', odds: 2.60, conf: 0.55, ajr: 0.58, inputs: 150, status: 'win', profit: '+240', preNote: 'å®¢é˜ŸçŠ¶æ€å¥½', postNote: 'å¦‚æœŸè€Œè‡³' },
                  ].map((row, i) => (
                    <tr key={i} className="border-t border-stone-100 hover:bg-amber-50/30 cursor-pointer transition-colors text-[11px]">
                      <td className="px-2 py-2.5 text-stone-500">{row.date}</td>
                      <td className="px-2 py-2.5 font-medium text-stone-700">{row.match}</td>
                      <td className="px-2 py-2.5 text-stone-600">{row.entries}</td>
                      <td className="px-2 py-2.5"><span className="font-semibold text-stone-700">{row.results}</span></td>
                      <td className="px-2 py-2.5"><span className="font-bold italic text-violet-600">{row.odds}</span></td>
                      <td className="px-2 py-2.5"><span className={`font-semibold ${getConfColor(row.conf)}`}>{row.conf}</span></td>
                      <td className="px-2 py-2.5 text-stone-600">{row.ajr}</td>
                      <td className="px-2 py-2.5"><span className="font-semibold text-amber-600">{row.inputs} rmb</span></td>
                      <td className="px-2 py-2.5">
                        <span className={`px-1.5 py-0.5 rounded-full text-[10px] ${row.status === 'pending' ? 'bg-amber-100 text-amber-700' : row.status === 'win' ? 'bg-emerald-100 text-emerald-700' : 'bg-rose-100 text-rose-700'}`}>
                          {row.status === 'pending' ? 'å¾…ç»“ç®—' : row.status === 'win' ? 'å·²ä¸­' : 'æœªä¸­'}
                        </span>
                      </td>
                      <td className={`px-2 py-2.5 font-semibold ${row.profit === '-' ? 'text-stone-400' : row.profit.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{row.profit}</td>
                      <td className="px-2 py-2.5 text-stone-400 max-w-16 truncate" title={row.preNote}>{row.preNote}</td>
                      <td className="px-2 py-2.5 text-stone-300 max-w-16 truncate" title={row.postNote}>{row.postNote}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      );

      // ========== TEAMS ==========
      const TeamsPage = () => {
        const [selectedTeam, setSelectedTeam] = useState(null);
        const [searchQuery, setSearchQuery] = useState('');
        const teams = [
          { name: 'é˜¿æ£®çº³', abbr: 'ARS', league: 'è‹±è¶…', samples: 18, roi: '+12.4%', avgRep: 0.42, ratingDiff: '+0.03' },
          { name: 'åˆ‡å°”è¥¿', abbr: 'CHE', league: 'è‹±è¶…', samples: 15, roi: '+8.2%', avgRep: 0.38, ratingDiff: '-0.02' },
          { name: 'åˆ©ç‰©æµ¦', abbr: 'LIV', league: 'è‹±è¶…', samples: 22, roi: '+18.7%', avgRep: 0.45, ratingDiff: '+0.05' },
          { name: 'æ›¼åŸ', abbr: 'MCI', league: 'è‹±è¶…', samples: 20, roi: '-3.2%', avgRep: 0.52, ratingDiff: '-0.08' },
        ];
        const filteredTeams = teams.filter(team => team.name.includes(searchQuery) || team.abbr.toLowerCase().includes(searchQuery.toLowerCase()));

        return (
          <div className="p-8">
            <div className="mb-6"><h2 className="text-2xl font-semibold text-stone-800 font-display">çƒé˜Ÿæ¡£æ¡ˆé¦†</h2><p className="text-stone-400 text-sm mt-1">æ¯æ”¯çƒé˜Ÿçš„å†å²è¡¨ç°è¿½è¸ªä¸åˆ†æ</p></div>
            
            <div className="glow-card bg-white rounded-2xl p-4 border border-stone-100 mb-6">
              <input type="text" placeholder="ğŸ” æœç´¢çƒé˜Ÿ..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} className="input-glow w-full px-4 py-2.5 rounded-xl border border-stone-200 text-sm" />
            </div>

            <div className="grid grid-cols-4 gap-4 mb-6">
              {filteredTeams.map(team => (
                <div key={team.abbr} onClick={() => setSelectedTeam(team)} className={`glow-card bg-white rounded-2xl p-4 border cursor-pointer lift-card ${selectedTeam?.abbr === team.abbr ? 'border-amber-300 bg-amber-50/30' : 'border-stone-100'}`}>
                  <div className="flex items-center gap-3 mb-3">
                    <div className="w-10 h-10 rounded-xl bg-gradient-to-br from-stone-100 to-stone-200 flex items-center justify-center"><span className="font-bold text-stone-600 text-sm">{team.abbr}</span></div>
                    <div><p className="font-medium text-stone-800">{team.name}</p><p className="text-xs text-stone-400">{team.league} Â· {team.samples}åœº</p></div>
                  </div>
                  <div className="flex justify-between text-sm">
                    <span className="text-stone-500">ROI</span>
                    <span className={team.roi.startsWith('+') ? 'text-emerald-600 font-medium' : 'text-rose-500 font-medium'}>{team.roi}</span>
                  </div>
                </div>
              ))}
            </div>

            {selectedTeam && (
              <div className="glow-card bg-white rounded-2xl p-6 border border-stone-100">
                <h3 className="font-semibold text-stone-800 mb-4">{selectedTeam.name} Â· è¯¦ç»†åˆ†æ</h3>
                <div className="grid grid-cols-2 gap-6">
                  {/* Conf vs AJR Chart */}
                  <div>
                    <h4 className="text-sm font-medium text-stone-700 mb-3">Conf vs AJR èµ°åŠ¿</h4>
                    <div className="h-40 bg-stone-50 rounded-xl flex items-center justify-center relative">
                      <svg className="w-full h-full p-4" viewBox="0 0 200 100">
                        <polyline fill="none" stroke="#fbbf24" strokeWidth="2" points="10,70 40,60 70,55 100,50 130,45 160,40 190,35" />
                        <polyline fill="none" stroke="#3b82f6" strokeWidth="2" strokeDasharray="4" points="10,65 40,58 70,52 100,48 130,50 160,42 190,38" />
                      </svg>
                      <div className="absolute bottom-2 right-4 flex gap-4 text-xs">
                        <span className="flex items-center gap-1"><span className="w-3 h-0.5 bg-amber-500"></span> Conf</span>
                        <span className="flex items-center gap-1"><span className="w-3 h-0.5 bg-blue-500 opacity-50"></span> AJR</span>
                      </div>
                    </div>
                  </div>
                  {/* ROI Chart */}
                  <div>
                    <h4 className="text-sm font-medium text-stone-700 mb-3">ROI èµ°åŠ¿</h4>
                    <div className="h-40 bg-stone-50 rounded-xl flex items-center justify-center">
                      <svg className="w-full h-full p-4" viewBox="0 0 200 100">
                        <polyline fill="none" stroke="#10b981" strokeWidth="2.5" points="10,80 40,70 70,65 100,55 130,50 160,45 190,35" />
                        {[10,40,70,100,130,160,190].map((x, i) => <circle key={i} cx={x} cy={[80,70,65,55,50,45,35][i]} r="3" fill="#10b981" />)}
                      </svg>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      };

      // ========== SETTLEMENT ==========
      const SettlePage = () => {
        const [expandedCombo, setExpandedCombo] = useState(0);
        const [hitStates, setHitStates] = useState({});
        
        const combos = [
          { id: 1, totalOdds: 4.21, totalInputs: 80, matches: [
            { match: 'é˜¿æ£®çº³ vs åˆ‡å°”è¥¿', entry: 'ä¸»èƒœ', odds: 2.15, preNote: 'ä¸»åœºå¼ºåŠ¿' },
            { match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', entry: 'å¤§2.5', odds: 1.96, preNote: 'è¿›æ”»ç«åŠ›å¼º' }
          ]},
          { id: 2, totalOdds: 2.15, totalInputs: 180, matches: [
            { match: 'çƒ­åˆº vs æ›¼è”', entry: 'å¹³å±€', odds: 2.15, preNote: 'ä¸¤é˜ŸçŠ¶æ€ä¸€èˆ¬' }
          ]},
          { id: 3, totalOdds: 3.85, totalInputs: 60, matches: [
            { match: 'çº½å¡ vs ç»´æ‹‰', entry: 'å®¢èƒœ', odds: 2.20, preNote: '' },
            { match: 'å¸ƒè±é¡¿ vs ç‹¼é˜Ÿ', entry: 'ä¸»èƒœ', odds: 1.75, preNote: '' }
          ]},
        ];

        const toggleHit = (comboId, matchIdx, value) => {
          setHitStates(prev => ({ ...prev, [`${comboId}-${matchIdx}`]: value }));
        };

        return (
          <div className="p-8 max-w-5xl">
            <div className="mb-6">
              <h2 className="text-2xl font-semibold text-stone-800 font-display">å¾…ç»“ç®—</h2>
              <p className="text-stone-400 text-sm mt-1">{combos.length} ä»½æŠ•èµ„å¾…å½•å…¥ç»“æœï¼Œå…± {combos.reduce((acc, c) => acc + c.matches.length, 0)} åœºæ¯”èµ›</p>
            </div>

            <div className="space-y-4">
              {combos.map((combo, cIdx) => (
                <div key={combo.id} className="glow-card bg-white rounded-2xl border border-stone-100 overflow-hidden">
                  {/* Combo Header */}
                  <div className="px-6 py-4 bg-stone-50/50 border-b border-stone-100 cursor-pointer" onClick={() => setExpandedCombo(expandedCombo === cIdx ? -1 : cIdx)}>
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-4">
                        <span className={`text-xs transition-transform ${expandedCombo === cIdx ? 'rotate-90' : ''}`}>â–¶</span>
                        <div>
                          <p className="font-semibold text-stone-800">{combo.matches.length === 1 ? 'Single Match' : `${combo.matches.length} Matches Combo`}</p>
                          <p className="text-sm text-stone-500">
                            ç»¼åˆ Odds <span className="font-bold italic text-violet-600">{combo.totalOdds}</span> Â· 
                            æŠ•èµ„ <span className="font-bold text-amber-600">{combo.totalInputs} rmb</span>
                          </p>
                        </div>
                      </div>
                      <span className="px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-xs font-medium">å¾…ç»“ç®—</span>
                    </div>
                  </div>

                  {/* Expanded Content */}
                  {expandedCombo === cIdx && (
                    <div className="p-6 space-y-6">
                      {combo.matches.map((m, mIdx) => (
                        <div key={mIdx} className={`${mIdx > 0 ? 'pt-6 border-t border-stone-100' : ''}`}>
                          <div className="flex items-center justify-between mb-3">
                            <p className="font-semibold text-stone-800">{m.match}</p>
                            <span className="text-xs text-stone-400">Odds <span className="font-bold italic text-violet-600">{m.odds}</span></span>
                          </div>
                          
                          {/* My Entry */}
                          <div className="mb-4 p-3 bg-amber-50 rounded-xl border border-amber-100">
                            <div className="flex items-center justify-between">
                              <div className="flex items-center gap-3">
                                <span className="text-xs text-amber-600 font-medium">æˆ‘çš„é¢„æµ‹</span>
                                <span className="text-sm font-semibold text-stone-800">{m.entry}</span>
                              </div>
                              {m.preNote && <span className="text-xs text-stone-400">èµ›å‰å¤‡æ³¨: {m.preNote}</span>}
                            </div>
                          </div>

                          <div className="grid grid-cols-4 gap-4">
                            <div>
                              <label className="text-xs text-stone-400 mb-1.5 block">Results å®é™…ç»“æœ</label>
                              <input type="text" placeholder="æ¯”åˆ†æˆ–ç»“æœ..." className="input-glow w-full px-3 py-2.5 rounded-xl border border-stone-200 text-sm" />
                            </div>
                            <div>
                              <label className="text-xs text-stone-400 mb-1.5 block">æ˜¯å¦å‘½ä¸­</label>
                              <div className="flex gap-2">
                                <button onClick={() => toggleHit(combo.id, mIdx, true)} className={`flex-1 py-2.5 rounded-lg text-xs font-medium btn-hover ${hitStates[`${combo.id}-${mIdx}`] === true ? 'bg-emerald-500 text-white' : 'bg-emerald-100 text-emerald-700 border border-emerald-200 hover:bg-emerald-200'}`}>âœ“ ä¸­</button>
                                <button onClick={() => toggleHit(combo.id, mIdx, false)} className={`flex-1 py-2.5 rounded-lg text-xs font-medium btn-hover ${hitStates[`${combo.id}-${mIdx}`] === false ? 'bg-rose-500 text-white' : 'bg-stone-100 text-stone-500 border border-stone-200 hover:bg-stone-200'}`}>âœ— æœªä¸­</button>
                              </div>
                            </div>
                            <div>
                              <label className="text-xs text-stone-400 mb-1.5 block">Actual Judgmental Rating</label>
                              <input type="number" step="0.01" placeholder="0~1" className="input-glow w-full px-3 py-2.5 rounded-xl border border-stone-200 text-sm" />
                            </div>
                            <div>
                              <label className="text-xs text-stone-400 mb-1.5 block">REP éšæœºäº‹ä»¶</label>
                              <input type="number" step="0.1" placeholder="0~1.8" className="input-glow w-full px-3 py-2.5 rounded-xl border border-stone-200 text-sm" />
                            </div>
                          </div>
                          
                          <div className="mt-3">
                            <label className="text-xs text-stone-400 mb-1.5 block">èµ›åå¤‡æ³¨ï¼ˆå¤ç›˜å¿ƒå¾—ï¼‰</label>
                            <input type="text" placeholder="é€‰å¡«..." className="input-glow w-full px-3 py-2.5 rounded-xl border border-stone-200 text-sm" />
                          </div>
                        </div>
                      ))}

                      {/* Revenue Input */}
                      <div className="pt-4 border-t border-stone-200">
                        <div className="flex items-center justify-between">
                          <div>
                            <label className="text-xs text-stone-400 mb-1.5 block">Revenue å®é™…æ”¶ç›Š</label>
                            <div className="flex items-center gap-2">
                              <input type="number" defaultValue="0" className="input-glow w-32 px-3 py-2.5 rounded-xl border border-stone-200 text-sm font-medium" />
                              <span className="text-sm text-stone-500">rmb</span>
                              <span className="text-xs text-stone-400 ml-2">ï¼ˆæŒ‰èµ”ç‡æ¯”ä¾‹åˆ†æ‘Šè‡³å„åœºï¼‰</span>
                            </div>
                          </div>
                          <button className="px-6 py-2.5 bg-gradient-to-r from-amber-400 to-orange-400 text-white rounded-xl text-sm font-medium shadow-lg shadow-orange-200/40 btn-hover">ç¡®è®¤ç»“ç®—</button>
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              ))}
            </div>
          </div>
        );
      };

      // ========== COMBO ==========
      const ComboPage = () => {
        const [checkedMatches, setCheckedMatches] = useState([true, true, true]);
        const toggleCheck = (idx) => { const newChecked = [...checkedMatches]; newChecked[idx] = !newChecked[idx]; setCheckedMatches(newChecked); };

        return (
          <div className="p-8">
            <div className="mb-6">
              <h2 className="text-2xl font-semibold text-stone-800 font-display">æ™ºèƒ½ç»„åˆå»ºè®®</h2>
              <p className="text-stone-400 text-sm mt-1">åŸºäº Portfolio Optimization çš„æœ€ä¼˜ä¸‹æ³¨æ–¹æ¡ˆ</p>
            </div>

            <div className="grid grid-cols-2 gap-6 mb-6">
              <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="font-medium text-stone-700">ä»Šæ—¥å¤‡é€‰æ¯”èµ›</h3>
                  <button onClick={() => setActivePage('new')} className="text-xs text-amber-500 hover:text-amber-600">+ æ·»åŠ æ¯”èµ›</button>
                </div>
                <div className="space-y-3">
                  {[{ match: 'é˜¿æ£®çº³ vs åˆ‡å°”è¥¿', conf: 0.65, odds: 2.15, ev: '+8.2%' },{ match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', conf: 0.58, odds: 1.95, ev: '+5.1%' },{ match: 'å·´å¡ç½—é‚£ vs çš‡é©¬', conf: 0.45, odds: 2.80, ev: '+3.6%' }].map((item, i) => (
                    <div key={i} className="flex items-center justify-between p-4 rounded-xl bg-stone-50 border border-stone-100 hover:border-amber-200 hover:bg-amber-50/50 transition-all cursor-pointer lift-card">
                      <div className="flex items-center gap-3">
                        <div onClick={() => toggleCheck(i)} className={`custom-checkbox ${checkedMatches[i] ? 'checked' : ''}`}></div>
                        <div>
                          <p className="text-sm font-medium text-stone-700">{item.match}</p>
                          <p className="text-xs text-stone-400">
                            Conf <span className={`font-semibold ${getConfColor(item.conf)}`}>{item.conf}</span> Â· 
                            Odds <span className="font-bold italic text-violet-600">{item.odds}</span>
                          </p>
                        </div>
                      </div>
                      <span className="text-sm font-medium text-emerald-600">é¢„æœŸæ”¶ç›Š {item.ev}</span>
                    </div>
                  ))}
                </div>

                <div className="mt-6 pt-6 border-t border-stone-100">
                  <label className="text-sm text-stone-600 mb-3 block">Risk Preference</label>
                  <div className="flex items-center gap-4"><span className="text-xs text-stone-400">ä¿å®ˆ</span><input type="range" min="0" max="100" defaultValue="50" className="flex-1" /><span className="text-xs text-stone-400">æ¿€è¿›</span></div>
                </div>

                <div className="flex gap-3 mt-6">
                  <button className="flex-1 py-3 bg-gradient-to-r from-amber-400 to-orange-400 text-white rounded-xl text-sm font-medium shadow-lg shadow-orange-200/40 btn-hover">ç”Ÿæˆæœ€ä¼˜ç»„åˆ</button>
                  <button className="flex-1 py-3 border border-amber-300 text-amber-600 rounded-xl text-sm font-medium hover:bg-amber-50 btn-hover">ç¡®è®¤æŠ•èµ„å·²å‹¾é€‰</button>
                </div>
              </div>

              <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
                <h3 className="font-medium text-stone-700 mb-4">æ¨èæ–¹æ¡ˆ</h3>
                <div className="space-y-3">
                  {[{ tier: 'T1 ä¸»æ¨', combo: 'é˜¿æ£®çº³ä¸»èƒœ Ã— åˆ©ç‰©æµ¦å¤§2.5', allocation: '280 rmb', ev: '+12.4%', winRate: '58%', sharpe: '1.82' },{ tier: 'T2 æ¬¡æ¨', combo: 'é˜¿æ£®çº³ä¸»èƒœ Single', allocation: '180 rmb', ev: '+8.2%', winRate: '65%', sharpe: '1.45' },{ tier: 'T3 åšå†·', combo: 'Triple Combo', allocation: '60 rmb', ev: '+18.7%', winRate: '22%', sharpe: '0.92' }].map((item, i) => (
                    <div key={i} className={`p-4 rounded-xl border transition-all cursor-pointer lift-card ${i === 0 ? 'border-amber-200 bg-amber-50/50' : 'border-stone-100 bg-stone-50'}`}>
                      <div className="flex items-center justify-between mb-2">
                        <span className={`text-xs font-medium ${i === 0 ? 'text-amber-600' : 'text-stone-500'}`}>{item.tier}</span>
                        <span className="text-sm font-semibold text-stone-800">{item.allocation}</span>
                      </div>
                      <p className="text-sm text-stone-700 mb-2">{item.combo}</p>
                      <div className="flex gap-4 text-xs text-stone-500">
                        <span>é¢„æœŸæ”¶ç›Š: <span className="text-emerald-600 font-medium">{item.ev}</span></span>
                        <span>Win Rate: <span className="stat-value text-sky-600">{item.winRate}</span></span>
                        <span>Sharpe: <span className="stat-value text-violet-600">{item.sharpe}</span></span>
                      </div>
                    </div>
                  ))}
                </div>

                <div className="mt-4 p-4 rounded-xl bg-stone-50 border border-stone-100">
                  <div className="flex justify-between text-sm"><span className="text-stone-500">æ€»æŠ•èµ„</span><span className="font-semibold">520 rmb</span></div>
                  <div className="flex justify-between text-sm mt-2"><span className="text-stone-500">ç»„åˆé¢„æœŸæ”¶ç›Š</span><span className="font-medium text-emerald-600">+11.2%</span></div>
                </div>

                <button className="w-full mt-4 py-3 border border-amber-300 text-amber-600 rounded-xl text-sm font-medium hover:bg-amber-50 btn-hover">ä¸€é”®é‡‡çº³æ–¹æ¡ˆ</button>
              </div>
            </div>

            {/* Algorithm Explanation */}
            <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
              <h3 className="font-medium text-stone-700 mb-4">Portfolio Optimization ç®—æ³•è¯´æ˜</h3>
              <div className="text-sm text-stone-600 space-y-3">
                <p><strong>1. è¾“å…¥å¤„ç†</strong>ï¼šå½•å…¥ä»Šæ—¥ n åœºæ¯”èµ›å‚æ•°ï¼Œç³»ç»Ÿæ„å»ºå€™é€‰ç»„åˆæ± ï¼ˆ2â¿-1 ç§ç»„åˆï¼‰</p>
                <p><strong>2. Calibration æ ¡å‡†å±‚</strong>ï¼šå¯¹æ¯åœºçš„ Conf è¿›è¡Œå†å²åå·®ä¿®æ­£ï¼Œå¾—åˆ°æ ¡å‡†åèƒœç‡ï¼ˆå‚è§å‚æ•°åå°çš„åŠ¨æ€æ ¡å‡†ç³»æ•°ï¼‰</p>
                <p><strong>3. é¢„æœŸæ”¶ç›Šè®¡ç®—</strong>ï¼šæ¯ä¸ªç»„åˆçš„ Î¼ = æ ¡å‡†èƒœç‡ Ã— ç»¼åˆèµ”ç‡ - 1</p>
                <p><strong>4. é£é™©è¯„ä¼°</strong>ï¼šÏƒ é€šè¿‡èƒœç‡è®¡ç®—æ³¢åŠ¨æ€§ï¼ˆèƒœç‡è¶Šæ¥è¿‘ 50% æ³¢åŠ¨è¶Šå¤§ï¼‰ï¼›Ï é€šè¿‡å…±äº«æ¯”èµ›è®¡ç®—ç»„åˆé—´ç›¸å…³æ€§</p>
                <p><strong>5. Risk Preference åŠ æƒ</strong>ï¼šç›®æ ‡å‡½æ•° = Î± Ã— é¢„æœŸæ”¶ç›Š - (1-Î±) Ã— é£é™©ï¼ŒÎ± ç”±æ»‘æ†æ§åˆ¶ï¼ˆè¶Šå³è¶Šæ¿€è¿›ï¼‰</p>
                <p><strong>6. ä»“ä½ä¼˜åŒ–</strong>ï¼šé‡‡ç”¨ Kelly å¤šèµ„äº§å…¬å¼æˆ– Markowitz Mean-Variance æ±‚è§£æœ€ä¼˜æƒé‡åˆ†é…</p>
                <p><strong>7. åˆ†å±‚è¾“å‡º</strong>ï¼šT1 ä¸»æ¨ï¼ˆç¨³å¥å‹ï¼ŒSharpe æœ€é«˜ï¼‰ã€T2 æ¬¡æ¨ï¼ˆå¹³è¡¡å‹ï¼‰ã€T3 åšå†·ï¼ˆé«˜é£é™©é«˜æ”¶ç›Šï¼‰</p>
              </div>
            </div>
          </div>
        );
      };

      // ========== PARAMS ==========
      const ParamsPage = () => {
        const [showKellyModal, setShowKellyModal] = useState(false);
        const [showRatingModal, setShowRatingModal] = useState(false);
        const [expandedFactor, setExpandedFactor] = useState(null);
        
        const factorsData = [
          { label: 'Conf', value: '1.08', trend: 'â†‘', data: [1.02, 1.05, 1.08, 1.06, 1.08] },
          { label: 'Mode', value: '0.95', trend: 'â†’', data: [0.92, 0.94, 0.96, 0.95, 0.95] },
          { label: 'TYS', value: '1.02', trend: 'â†‘', data: [1.00, 1.01, 1.03, 1.02, 1.02] },
          { label: 'FID', value: '1.12', trend: 'â†‘', data: [1.08, 1.10, 1.11, 1.12, 1.12] },
          { label: 'Odds', value: '0.98', trend: 'â†“', data: [1.00, 0.99, 0.98, 0.97, 0.98] },
          { label: 'FSE', value: '1.05', trend: 'â†‘', data: [1.02, 1.03, 1.04, 1.05, 1.05] },
        ];

        const MiniLineChart = ({ data }) => {
          const min = Math.min(...data) - 0.02;
          const max = Math.max(...data) + 0.02;
          const range = max - min;
          const points = data.map((v, i) => `${10 + (i / (data.length - 1)) * 80},${40 - ((v - min) / range) * 30}`).join(' ');
          return (<svg viewBox="0 0 100 50" className="w-full h-10"><polyline fill="none" stroke="url(#factorLine)" strokeWidth="2" points={points} />{data.map((v, i) => <circle key={i} cx={10 + (i / (data.length - 1)) * 80} cy={40 - ((v - min) / range) * 30} r="2" fill="#f59e0b" />)}<defs><linearGradient id="factorLine" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stopColor="#fbbf24" /><stop offset="100%" stopColor="#f97316" /></linearGradient></defs></svg>);
        };

        const kellyModalContent = (
          <div>
            <p className="text-sm text-stone-500 mb-4">åŸºäºæ·±åº¦åˆ†æä¸­å„ Mode çš„å†å²è¡¨ç°ï¼ŒåŠ¨æ€è®¡ç®—å»ºè®® Kelly åˆ†æ¯</p>
            <table className="w-full text-sm">
              <thead><tr className="border-b border-stone-200 text-left text-stone-500"><th className="py-2">Mode</th><th className="py-2">æ ·æœ¬</th><th className="py-2">ROI</th><th className="py-2">å»ºè®® Kelly</th></tr></thead>
              <tbody>
                {[{ mode: 'å¸¸è§„', samples: 45, roi: '+12.4%', kelly: '4.0' },{ mode: 'å¸¸è§„-ç¨³', samples: 18, roi: '+8.2%', kelly: '3.5' },{ mode: 'ä¿é™©äº§å“', samples: 15, roi: '+18.5%', kelly: '3.0' },{ mode: 'åŠå½©ç¥¨åŠä¿é™©', samples: 10, roi: '-5.2%', kelly: '5.0' },{ mode: 'èµŒä¸€æŠŠ', samples: 5, roi: '-32.0%', kelly: '6.0' }].map((r, i) => (
                  <tr key={i} className="border-b border-stone-100"><td className="py-2 font-medium">{r.mode}</td><td className="py-2">{r.samples}</td><td className={r.roi.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}>{r.roi}</td><td className="py-2 font-semibold text-amber-600">{r.kelly}</td></tr>
                ))}
              </tbody>
            </table>
          </div>
        );

        const ratingModalContent = (
          <div>
            <p className="text-sm text-stone-500 mb-4">Expected vs Actual Judgmental Rating å†å²è®°å½•</p>
            <table className="w-full text-sm">
              <thead><tr className="border-b border-stone-200 text-left text-stone-500"><th className="py-2">æ—¥æœŸ</th><th className="py-2">æ¯”èµ›</th><th className="py-2">Expected</th><th className="py-2">Actual</th><th className="py-2">åå·®</th></tr></thead>
              <tbody>
                {[{ date: '02-01', match: 'åˆ©ç‰©æµ¦ vs æ›¼åŸ', exp: '0.68', act: '0.72', diff: '+0.04' },{ date: '01-31', match: 'çƒ­åˆº vs æ›¼è”', exp: '0.45', act: '0.42', diff: '-0.03' },{ date: '01-30', match: 'çº½å¡ vs ç»´æ‹‰', exp: '0.55', act: '0.58', diff: '+0.03' }].map((r, i) => (
                  <tr key={i} className="border-b border-stone-100"><td className="py-2">{r.date}</td><td className="py-2">{r.match}</td><td className="py-2">{r.exp}</td><td className="py-2">{r.act}</td><td className={`py-2 font-medium ${r.diff.startsWith('+') ? 'text-emerald-600' : 'text-rose-500'}`}>{r.diff}</td></tr>
                ))}
              </tbody>
            </table>
          </div>
        );

        return (
          <div className="p-8 max-w-4xl">
            <div className="mb-6"><h2 className="text-2xl font-semibold text-stone-800 font-display">å‚æ•°åå°</h2><p className="text-stone-400 text-sm mt-1">ç³»ç»Ÿæ ¸å¿ƒå‚æ•°ä¸æ ¡å‡†ç³»æ•°é…ç½®</p></div>

            {/* Core Metric - Clickable */}
            <div onClick={() => setShowRatingModal(true)} className="glow-card bg-gradient-to-br from-amber-50 via-orange-50 to-rose-50 rounded-2xl p-6 border border-amber-200 mb-6 cursor-pointer hover:shadow-lg transition-all">
              <div className="flex items-start justify-between">
                <div>
                  <div className="flex items-center gap-2 mb-2"><span className="text-amber-600 text-lg">â–</span><span className="text-xs text-amber-600 font-medium uppercase">Core Metric</span></div>
                  <h3 className="text-xl font-semibold text-stone-800">Expected vs Actual Judgmental Rating</h3>
                  <p className="text-sm text-stone-500 mt-1">è¡¡é‡ç³»ç»Ÿé¢„æœŸæ¨¡å‹çš„æ‹Ÿåˆç¨‹åº¦ Â· ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</p>
                </div>
                <div className="text-right"><div className="text-4xl font-bold text-amber-600">0.92</div><p className="text-sm text-emerald-600 mt-1">â†‘ æ ¡å‡†è‰¯å¥½ Â· åå·® -8%</p></div>
              </div>
            </div>

            {/* Two Column */}
            <div className="grid grid-cols-2 gap-6 mb-6">
              <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
                <h3 className="font-medium text-stone-700 mb-4 flex items-center gap-2"><span className="text-amber-500">â—</span> èµ„é‡‘ä¸é£æ§</h3>
                <div className="space-y-4">
                  {[{ label: 'åˆå§‹æœ¬é‡‘', sub: 'åŸºå‡†èµ„é‡‘æ± ', value: 600, prefix: 'Â¥' },{ label: 'é£æ§æ¯”ä¾‹ä¸Šé™', sub: 'å•ç¬”æœ€å¤§å æ¯”', value: 12, suffix: '%' },{ label: 'é»˜è®¤èµ”ç‡', sub: 'æœªå¡«å†™æ—¶å‡è®¾å€¼', value: 2.5 }].map((item, i) => (
                    <div key={i} className="flex items-center justify-between p-3 bg-stone-50 rounded-xl">
                      <div><span className="text-sm text-stone-700">{item.label}</span><p className="text-xs text-stone-400">{item.sub}</p></div>
                      <div className="flex items-center gap-1">{item.prefix && <span className="text-stone-400">{item.prefix}</span>}<input type="number" defaultValue={item.value} className="input-glow w-20 px-2 py-1.5 text-right text-sm font-medium rounded-lg border border-stone-200" />{item.suffix && <span className="text-stone-400">{item.suffix}</span>}</div>
                    </div>
                  ))}
                </div>
              </div>

              <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
                <h3 className="font-medium text-stone-700 mb-4 flex items-center gap-2"><span className="text-amber-500">â—ˆ</span> Kelly å‚æ•°</h3>
                <div onClick={() => setShowKellyModal(true)} className="p-4 bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl border border-amber-200 cursor-pointer hover:shadow-md transition-all">
                  <div className="flex items-center justify-between mb-2"><span className="text-sm text-stone-700">å¹³å‡ Kelly åˆ†æ¯</span><span className="text-2xl font-bold text-amber-600">3.8</span></div>
                  <p className="text-xs text-stone-500">åŸºäºå„ Mode å†å²è¡¨ç°åŠ æƒè®¡ç®—</p>
                  <p className="text-xs text-amber-600 mt-2">ç‚¹å‡»æŸ¥çœ‹å„ Mode å»ºè®® â†’</p>
                </div>
                <div className="mt-4 p-3 bg-stone-50 rounded-xl">
                  <div className="flex items-center justify-between">
                    <div><span className="text-sm text-stone-700">æ‰‹åŠ¨è¦†ç›–</span><p className="text-xs text-stone-400">å¼ºåˆ¶ä½¿ç”¨å›ºå®šåˆ†æ¯</p></div>
                    <div className="flex items-center gap-2"><input type="checkbox" className="accent-amber-500" /><input type="number" step="0.5" defaultValue="4" className="input-glow w-16 px-2 py-1.5 text-right text-sm rounded-lg border border-stone-200" /></div>
                  </div>
                </div>
              </div>
            </div>

            {/* Calibration Factors with mini line charts and trends */}
            <div className="glow-card bg-white rounded-2xl border border-stone-100 p-6">
              <div className="flex items-center justify-between mb-4">
                <h3 className="font-medium text-stone-700 flex items-center gap-2"><span className="text-amber-500">â—‡</span> åŠ¨æ€æ ¡å‡†ç³»æ•°</h3>
                <span className="text-xs text-stone-400 px-2 py-1 bg-stone-100 rounded">å›å½’åˆ†æè‡ªåŠ¨æ›´æ–° Â· åªè¯» Â· ç‚¹å‡»å±•å¼€è¶‹åŠ¿</span>
              </div>
              <div className="grid grid-cols-6 gap-3">
                {factorsData.map((item, i) => (
                  <div key={i} onClick={() => setExpandedFactor(expandedFactor === item.label ? null : item.label)}
                    className={`p-3 rounded-xl text-center cursor-pointer transition-all ${expandedFactor === item.label ? 'bg-amber-50 border border-amber-200' : 'bg-stone-50 hover:bg-amber-50/50'}`}>
                    <span className="text-xs text-stone-400 block">{item.label}</span>
                    <div className="flex items-center justify-center gap-1">
                      <span className="text-lg font-semibold text-stone-700">{item.value}</span>
                      <span className={`text-xs ${item.trend === 'â†‘' ? 'text-emerald-500' : item.trend === 'â†“' ? 'text-rose-500' : 'text-stone-400'}`}>{item.trend}</span>
                    </div>
                    {expandedFactor === item.label && (
                      <div className="mt-2 pt-2 border-t border-amber-200">
                        <div className="text-[10px] text-stone-400 mb-1">è¿‘5å‘¨è¶‹åŠ¿</div>
                        <MiniLineChart data={item.data} />
                      </div>
                    )}
                  </div>
                ))}
              </div>
              <p className="text-xs text-stone-400 mt-4 text-center">ç³»æ•° &gt;1 è¡¨ç¤ºè¯¥å› å­æ­£å‘å½±å“é¢„æµ‹å‡†ç¡®åº¦</p>
            </div>

            {showKellyModal && <Modal data={{ title: 'Kelly åˆ†æ¯ Â· å„ Mode å»ºè®®', content: kellyModalContent }} onClose={() => setShowKellyModal(false)} />}
            {showRatingModal && <Modal data={{ title: 'Expected vs Actual Judgmental Rating Â· å†å²è®°å½•', content: ratingModalContent }} onClose={() => setShowRatingModal(false)} />}
          </div>
        );
      };

      const renderPage = () => {
        if (activeSubPage === 'analysis') return <AnalysisPage />;
        if (activeSubPage === 'metrics') return <MetricsPage />;
        if (activeSubPage === 'teams') return <TeamsPage />;
        switch(activePage) {
          case 'dashboard': return <DashboardPage />;
          case 'new': return <NewInvestmentPage />;
          case 'history': return <HistoryPage />;
          case 'settle': return <SettlePage />;
          case 'combo': return <ComboPage />;
          case 'params': return <ParamsPage />;
          default: return <DashboardPage />;
        }
      };

      return (
        <div className="flex h-screen bg-stone-100/50">
          <Sidebar />
          <main className="flex-1 overflow-auto">{renderPage()}</main>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<DugouDesign />);
  </script>
</body>
</html>
